
/*
 * Title: IceLink for JavaScript
 * Version: 2.9.1
 * Copyright Frozen Mountain Software 2011+
 */

!function(e,t,n){if("function"==typeof define&&define.amd)define(e,t,n);else if("object"==typeof exports){for(var s=0;s<t.length;s++)require("./"+t[s]);module.exports=n()}else this[e]=n()}("fm.icelink",["fm"],function(){if("undefined"==typeof global||global.window||(global.window=global,global.document={cookie:""}),!window.fm)throw new Error("fm must be loaded before fm.icelink.");window.fm.icelink||(window.fm.icelink={}),fm.icelink.getVersion=function(){return"2.9.1"},fm.icelink.util=function(){function e(){}return e.hasWebRTC=function(){return"undefined"!=typeof RTCPeerConnection},e.hasORTC=function(){return"undefined"!=typeof RTCIceTransport},e}(),fm.icelink.cipherSuite={Aes128Sha:1,DhRsaAes128Sha:2,EcdhRsaAes128Sha:3,DheRsaAes128Sha:4,EcdheRsaAes128Sha:5,EcdheEcdsaAes128Sha:6},fm.icelink.protocolVersion={Dtls10:1,Dtls12:2},fm.icelink.direction={SendReceive:1,SendOnly:2,ReceiveOnly:3,Inactive:4,Default:1},fm.icelink.streamProtocol={Rtp:1,Sctp:2},fm.icelink.candidateMode={Early:1,Late:2,Default:2},fm.icelink.candidateType={Private:1,Public:2,Relay:4,Relayed:4},fm.icelink.streamType={Audio:1,Video:2,Text:3,Application:4,Message:5};var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.baseLinkArgs=function(n){function s(){this.setLink=e(this.setLink,this),this.setConference=e(this.setConference,this),this.getPeerState=e(this.getPeerState,this),this.getPeerId=e(this.getPeerId,this),this.getLink=e(this.getLink,this),this.getConference=e(this.getConference,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._conference=null,s.prototype._link=null,s.prototype.getConference=function(){return this._conference},s.prototype.getLink=function(){return this._link},s.prototype.getPeerId=function(){return this.getLink().getPeerId()},s.prototype.getPeerState=function(){return this.getLink().getPeerState()},s.prototype.setConference=function(){var e;return e=arguments[0],this._conference=e},s.prototype.setLink=function(){var e;return e=arguments[0],this._link=e},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.closeCompleteArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setReason=e(this.setReason,this),this.setLink=e(this.setLink,this),this.setException=e(this.setException,this),this.getReason=e(this.getReason,this),this.getLink=e(this.getLink,this),this.getException=e(this.getException,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._exception=null,s.prototype._link=null,s.prototype._reason=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeCloseCompleteArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeCloseCompleteArgs(e)},s.prototype.getException=function(){return this._exception},s.prototype.getLink=function(){return this._link},s.prototype.getReason=function(){return this._reason},s.prototype.setException=function(){var e;return e=arguments[0],this._exception=e},s.prototype.setLink=function(){var e;return e=arguments[0],this._link=e},s.prototype.setReason=function(){var e;return e=arguments[0],this._reason=e},s.prototype.toJson=function(){return fm.icelink.closeCompleteArgs.toJson(this)},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.closeArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setReason=e(this.setReason,this),this.setOnComplete=e(this.setOnComplete,this),this.getReason=e(this.getReason,this),this.getOnComplete=e(this.getOnComplete,this);var t,n;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(s.call(this,null),fm.util.attachProperties(this,arguments[0]),t):1===arguments.length?(n=arguments[0],t=s.__super__.constructor.call(this),this.setReason(n),t):0===arguments.length?(s.call(this,null),t):void 0}return t(s,n),s.prototype._onComplete=null,s.prototype._reason=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeCloseArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeCloseArgs(e)},s.prototype.getOnComplete=function(){return this._onComplete},s.prototype.getReason=function(){return this._reason},s.prototype.setOnComplete=function(){var e;return e=arguments[0],this._onComplete=e},s.prototype.setReason=function(){var e;return e=arguments[0],this._reason=e},s.prototype.toJson=function(){return fm.icelink.closeArgs.toJson(this)},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.linkLocalAddressesArgs=function(n){function s(){this.swapLocalAddresses=e(this.swapLocalAddresses,this),this.setLocalAddresses=e(this.setLocalAddresses,this),this.removeLocalAddress=e(this.removeLocalAddress,this),this.getLocalAddresses=e(this.getLocalAddresses,this),this.findLocalAddressIndex=e(this.findLocalAddressIndex,this);var t,n;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),this.__localAddresses=[],fm.util.attachProperties(this,arguments[0]),t):1===arguments.length?(n=arguments[0],s.call(this),this.setLocalAddresses(n),t):0===arguments.length?(t=s.__super__.constructor.call(this),this.__localAddresses=[],t):void 0}return t(s,n),s.prototype.__localAddresses=null,s.prototype.findLocalAddressIndex=function(){var e,t;for(t=arguments[0],e=0;e<fm.arrayExtensions.getCount(this.__localAddresses);)try{if(fm.global.equals(this.__localAddresses[e],t))return e}finally{e++}return-1},s.prototype.getLocalAddresses=function(){return fm.arrayExtensions.toArray(this.__localAddresses)},s.prototype.removeLocalAddress=function(){var e;return e=arguments[0],0>e||e>=fm.arrayExtensions.getCount(this.__localAddresses)?!1:(this.__localAddresses.removeAt(e),!0)},s.prototype.setLocalAddresses=function(){var e,t;return t=arguments[0],e=[],fm.arrayExtensions.addRange(e,t),this.__localAddresses=e},s.prototype.swapLocalAddresses=function(){var e,t,n;return e=arguments[0],t=arguments[1],0>e||e>=fm.arrayExtensions.getCount(this.__localAddresses)||0>t||t>=fm.arrayExtensions.getCount(this.__localAddresses)?!1:(n=this.__localAddresses[e],this.__localAddresses[e]=this.__localAddresses[t],this.__localAddresses[t]=n,!0)},s}(fm.icelink.baseLinkArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.linkCandidateArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setCandidate=e(this.setCandidate,this),this.getCandidate=e(this.getCandidate,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._candidate=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeLinkCandidateArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeLinkCandidateArgs(e)},s.prototype.getCandidate=function(){return this._candidate},s.prototype.setCandidate=function(){var e;return e=arguments[0],this._candidate=e},s.prototype.toJson=function(){return fm.icelink.linkCandidateArgs.toJson(this)},s}(fm.icelink.baseLinkArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.linkReceiveRTCPArgs=function(n){function s(){this.setStreamIndex=e(this.setStreamIndex,this),this.setStream=e(this.setStream,this),this.setPackets=e(this.setPackets,this),this.setNegotiatedStream=e(this.setNegotiatedStream,this),this.setMediaIndex=e(this.setMediaIndex,this),this.getStreamIndex=e(this.getStreamIndex,this),this.getStream=e(this.getStream,this),this.getPackets=e(this.getPackets,this),this.getNegotiatedStream=e(this.getNegotiatedStream,this),this.getMediaIndex=e(this.getMediaIndex,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._mediaIndex=0,s.prototype._negotiatedStream=null,s.prototype._packets=null,s.prototype._stream=null,s.prototype._streamIndex=0,s.prototype.getMediaIndex=function(){return this._mediaIndex},s.prototype.getNegotiatedStream=function(){return this._negotiatedStream},s.prototype.getPackets=function(){return this._packets},s.prototype.getStream=function(){return this._stream},s.prototype.getStreamIndex=function(){return this._streamIndex},s.prototype.setMediaIndex=function(){var e;return e=arguments[0],this._mediaIndex=e},s.prototype.setNegotiatedStream=function(){var e;return e=arguments[0],this._negotiatedStream=e},s.prototype.setPackets=function(){var e;return e=arguments[0],this._packets=e},s.prototype.setStream=function(){var e;return e=arguments[0],this._stream=e},s.prototype.setStreamIndex=function(){var e;return e=arguments[0],this._streamIndex=e},s}(fm.icelink.baseLinkArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.linkReceiveRTPArgs=function(n){function s(){this.setStreamIndex=e(this.setStreamIndex,this),this.setStreamFormat=e(this.setStreamFormat,this),this.setStream=e(this.setStream,this),this.setPacket=e(this.setPacket,this),this.setNegotiatedStream=e(this.setNegotiatedStream,this),this.setMediaIndex=e(this.setMediaIndex,this),this.getStreamIndex=e(this.getStreamIndex,this),this.getStreamFormat=e(this.getStreamFormat,this),this.getStream=e(this.getStream,this),this.getPacket=e(this.getPacket,this),this.getNegotiatedStream=e(this.getNegotiatedStream,this),this.getMediaIndex=e(this.getMediaIndex,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._mediaIndex=0,s.prototype._negotiatedStream=null,s.prototype._packet=null,s.prototype._stream=null,s.prototype._streamFormat=null,s.prototype._streamIndex=0,s.prototype.getMediaIndex=function(){return this._mediaIndex},s.prototype.getNegotiatedStream=function(){return this._negotiatedStream},s.prototype.getPacket=function(){return this._packet},s.prototype.getStream=function(){return this._stream},s.prototype.getStreamFormat=function(){return this._streamFormat},s.prototype.getStreamIndex=function(){return this._streamIndex},s.prototype.setMediaIndex=function(){var e;return e=arguments[0],this._mediaIndex=e},s.prototype.setNegotiatedStream=function(){var e;return e=arguments[0],this._negotiatedStream=e},s.prototype.setPacket=function(){var e;return e=arguments[0],this._packet=e},s.prototype.setStream=function(){var e;return e=arguments[0],this._stream=e},s.prototype.setStreamFormat=function(){var e;return e=arguments[0],this._streamFormat=e},s.prototype.setStreamIndex=function(){var e;return e=arguments[0],this._streamIndex=e},s}(fm.icelink.baseLinkArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.linkReceiveSCTPArgs=function(n){function s(){this.setStreamIndex=e(this.setStreamIndex,this),this.setStream=e(this.setStream,this),this.setNegotiatedStream=e(this.setNegotiatedStream,this),this.setMessage=e(this.setMessage,this),this.setMediaIndex=e(this.setMediaIndex,this),this.setChannelIndex=e(this.setChannelIndex,this),this.getStreamIndex=e(this.getStreamIndex,this),this.getStream=e(this.getStream,this),this.getNegotiatedStream=e(this.getNegotiatedStream,this),this.getMessage=e(this.getMessage,this),this.getMediaIndex=e(this.getMediaIndex,this),this.getChannelIndex=e(this.getChannelIndex,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._channelIndex=0,s.prototype._mediaIndex=0,s.prototype._message=null,s.prototype._negotiatedStream=null,s.prototype._stream=null,s.prototype._streamIndex=0,s.prototype.getChannelIndex=function(){return this._channelIndex},s.prototype.getMediaIndex=function(){return this._mediaIndex},s.prototype.getMessage=function(){return this._message},s.prototype.getNegotiatedStream=function(){return this._negotiatedStream},s.prototype.getStream=function(){return this._stream},s.prototype.getStreamIndex=function(){return this._streamIndex},s.prototype.setChannelIndex=function(){var e;return e=arguments[0],this._channelIndex=e},s.prototype.setMediaIndex=function(){var e;return e=arguments[0],this._mediaIndex=e},s.prototype.setMessage=function(){var e;return e=arguments[0],this._message=e},s.prototype.setNegotiatedStream=function(){var e;return e=arguments[0],this._negotiatedStream=e},s.prototype.setStream=function(){var e;return e=arguments[0],this._stream=e},s.prototype.setStreamIndex=function(){var e;return e=arguments[0],this._streamIndex=e},s}(fm.icelink.baseLinkArgs);var t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.streamLinkReceiveSCTPArgs=function(e){function n(){var e;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(e=n.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),e):e=n.__super__.constructor.call(this)}return t(n,e),n}(fm.icelink.linkReceiveSCTPArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.unhandledExceptionArgs=function(n){function s(){this.setHandled=e(this.setHandled,this),this.setException=e(this.setException,this),this.getHandled=e(this.getHandled,this),this.getException=e(this.getException,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._exception=null,s.prototype._handled=!1,s.prototype.getException=function(){return this._exception},s.prototype.getHandled=function(){return this._handled},s.prototype.setException=function(){var e;return e=arguments[0],this._exception=e},s.prototype.setHandled=function(){var e;return e=arguments[0],this._handled=e},s}(fm.object);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.baseConference=function(n){function s(){this.setVirtualAdapters=e(this.setVirtualAdapters,this),this.setSuppressRelayCandidates=e(this.setSuppressRelayCandidates,this),this.setSuppressPublicCandidates=e(this.setSuppressPublicCandidates,this),this.setSuppressPrivateCandidates=e(this.setSuppressPrivateCandidates,this),this.setStreams=e(this.setStreams,this),this.setServerPort=e(this.setServerPort,this),this.setServerIPAddress=e(this.setServerIPAddress,this),this.setServerAddresses=e(this.setServerAddresses,this),this.setServerAddress=e(this.setServerAddress,this),this.setSctpPortMin=e(this.setSctpPortMin,this),this.setSctpPortMax=e(this.setSctpPortMax,this),this.setRtpPortMin=e(this.setRtpPortMin,this),this.setRtpPortMax=e(this.setRtpPortMax,this),this.setRelayUsernames=e(this.setRelayUsernames,this),this.setRelayUsername=e(this.setRelayUsername,this),this.setRelayRealms=e(this.setRelayRealms,this),this.setRelayRealm=e(this.setRelayRealm,this),this.setRelayPasswords=e(this.setRelayPasswords,this),this.setRelayPassword=e(this.setRelayPassword,this),this.setPublicIPAddress=e(this.setPublicIPAddress,this),this.setKeepAliveInterval=e(this.setKeepAliveInterval,this),this.setId=e(this.setId,this),this.setIceUsernameFragment=e(this.setIceUsernameFragment,this),this.setIcePassword=e(this.setIcePassword,this),this.setEarlyCandidatesTimeout=e(this.setEarlyCandidatesTimeout,this),this.setDtlsServerMinVersion=e(this.setDtlsServerMinVersion,this),this.setDtlsServerMaxVersion=e(this.setDtlsServerMaxVersion,this),this.setDtlsClientVersion=e(this.setDtlsClientVersion,this),this.setDtlsCipherSuites=e(this.setDtlsCipherSuites,this),this.setDtlsCertificate=e(this.setDtlsCertificate,this),this.setDisableAutomaticReports=e(this.setDisableAutomaticReports,this),this.setDeadStreamTimeout=e(this.setDeadStreamTimeout,this),this.setCname=e(this.setCname,this),this.setCandidateMode=e(this.setCandidateMode,this),this.getVirtualAdapters=e(this.getVirtualAdapters,this),this.getSuppressRelayCandidates=e(this.getSuppressRelayCandidates,this),this.getSuppressPublicCandidates=e(this.getSuppressPublicCandidates,this),this.getSuppressPrivateCandidates=e(this.getSuppressPrivateCandidates,this),this.getStreams=e(this.getStreams,this),this.getServerPort=e(this.getServerPort,this),this.getServerIPAddress=e(this.getServerIPAddress,this),this.getServerAddresses=e(this.getServerAddresses,this),this.getServerAddress=e(this.getServerAddress,this),this.getSctpPortMin=e(this.getSctpPortMin,this),this.getSctpPortMax=e(this.getSctpPortMax,this),this.getRtpPortMin=e(this.getRtpPortMin,this),this.getRtpPortMax=e(this.getRtpPortMax,this),this.getRelayUsernames=e(this.getRelayUsernames,this),this.getRelayUsername=e(this.getRelayUsername,this),this.getRelayRealms=e(this.getRelayRealms,this),this.getRelayRealm=e(this.getRelayRealm,this),this.getRelayPasswords=e(this.getRelayPasswords,this),this.getRelayPassword=e(this.getRelayPassword,this),this.getPublicIPAddress=e(this.getPublicIPAddress,this),this.getKeepAliveInterval=e(this.getKeepAliveInterval,this),this.getId=e(this.getId,this),this.getIceUsernameFragment=e(this.getIceUsernameFragment,this),this.getIcePassword=e(this.getIcePassword,this),this.getEarlyCandidatesTimeout=e(this.getEarlyCandidatesTimeout,this),this.getDtlsServerMinVersion=e(this.getDtlsServerMinVersion,this),this.getDtlsServerMaxVersion=e(this.getDtlsServerMaxVersion,this),this.getDtlsClientVersion=e(this.getDtlsClientVersion,this),this.getDtlsCipherSuites=e(this.getDtlsCipherSuites,this),this.getDtlsCertificate=e(this.getDtlsCertificate,this),this.getDisableAutomaticReports=e(this.getDisableAutomaticReports,this),this.getDeadStreamTimeout=e(this.getDeadStreamTimeout,this),this.getCname=e(this.getCname,this),this.getCanSend=e(this.getCanSend,this),this.getCanReceive=e(this.getCanReceive,this),this.getCandidateMode=e(this.getCandidateMode,this),this.copyFrom=e(this.copyFrom,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),this.__keepAliveInterval=1e3,this.__deadStreamTimeout=15e3,this.__dtlsCipherSuites=[fm.icelink.cipherSuite.Aes128Sha,fm.icelink.cipherSuite.DhRsaAes128Sha,fm.icelink.cipherSuite.EcdhRsaAes128Sha,fm.icelink.cipherSuite.DheRsaAes128Sha,fm.icelink.cipherSuite.EcdheRsaAes128Sha,fm.icelink.cipherSuite.EcdheEcdsaAes128Sha],this.__dtlsServerMinVersion=fm.icelink.protocolVersion.Dtls10,this.__dtlsServerMaxVersion=fm.icelink.protocolVersion.Dtls12,this.__dtlsClientVersion=fm.icelink.protocolVersion.Dtls10,this.__rtpPortMin=1024,this.__sctpPortMin=1024,this.__rtpPortMax=65534,this.__sctpPortMax=65534,this.__candidateMode=fm.icelink.candidateMode.Late,this.__earlyCandidatesTimeout=500,fm.util.attachProperties(this,arguments[0]),t):(t=s.__super__.constructor.call(this),this.__keepAliveInterval=1e3,this.__deadStreamTimeout=15e3,this.__dtlsCipherSuites=[fm.icelink.cipherSuite.Aes128Sha,fm.icelink.cipherSuite.DhRsaAes128Sha,fm.icelink.cipherSuite.EcdhRsaAes128Sha,fm.icelink.cipherSuite.DheRsaAes128Sha,fm.icelink.cipherSuite.EcdheRsaAes128Sha,fm.icelink.cipherSuite.EcdheEcdsaAes128Sha],this.__dtlsServerMinVersion=fm.icelink.protocolVersion.Dtls10,this.__dtlsServerMaxVersion=fm.icelink.protocolVersion.Dtls12,this.__dtlsClientVersion=fm.icelink.protocolVersion.Dtls10,this.__rtpPortMin=1024,this.__sctpPortMin=1024,this.__rtpPortMax=65534,this.__sctpPortMax=65534,this.__candidateMode=fm.icelink.candidateMode.Late,this.__earlyCandidatesTimeout=500,t)}return t(s,n),s.prototype.__candidateMode=null,s.prototype.__deadStreamTimeout=0,s.prototype.__dtlsCipherSuites=null,s.prototype.__dtlsClientVersion=null,s.prototype.__dtlsServerMaxVersion=null,s.prototype.__dtlsServerMinVersion=null,s.prototype.__earlyCandidatesTimeout=0,s.prototype.__keepAliveInterval=0,s.prototype.__rtpPortMax=0,s.prototype.__rtpPortMin=0,s.prototype.__sctpPortMax=0,s.prototype.__sctpPortMin=0,s.prototype.__streams=null,s.prototype._cname=null,s.prototype._disableAutomaticReports=!1,s.prototype._dtlsCertificate=null,s.prototype._icePassword=null,s.prototype._iceUsernameFragment=null,s.prototype._id=null,s.prototype._publicIPAddress=null,s.prototype._relayPasswords=null,s.prototype._relayRealms=null,s.prototype._relayUsernames=null,s.prototype._serverAddresses=null,s.prototype._suppressPrivateCandidates=!1,s.prototype._suppressPublicCandidates=!1,s.prototype._suppressRelayCandidates=!1,s.prototype._virtualAdapters=null,s.parseAddress=function(){var e,t,n,s;return e=arguments[0],t=arguments[1],n=arguments[2],t.setValue(null),n.setValue(3478),fm.global.equals(e,null)?!1:(s=fm.stringExtensions.split(e,[":"]),s.length>0&&t.setValue(s[0]),s.length>1&&n.setValue(fm.icelink.baseConference.parseServerPort(s[1])),!0)},s.parseServerPort=function(){var e,t,n,s;return s=arguments[0],n=0,e=new fm.holder(n),t=fm.parseAssistant.tryParseIntegerValue(s,e),n=e.getValue(),t?n:3478},s.prototype.copyFrom=function(){var e;return e=arguments[0],this.setSuppressPrivateCandidates(e.getSuppressPrivateCandidates()),this.setSuppressPublicCandidates(e.getSuppressPublicCandidates()),this.setSuppressRelayCandidates(e.getSuppressRelayCandidates()),this.setDisableAutomaticReports(e.getDisableAutomaticReports()),this.setKeepAliveInterval(e.getKeepAliveInterval()),this.setDeadStreamTimeout(e.getDeadStreamTimeout()),this.setDtlsCertificate(e.getDtlsCertificate()),this.setDtlsCipherSuites(e.getDtlsCipherSuites()),this.setDtlsServerMinVersion(e.getDtlsServerMinVersion()),this.setDtlsServerMaxVersion(e.getDtlsServerMaxVersion()),this.setDtlsClientVersion(e.getDtlsClientVersion()),this.setIceUsernameFragment(e.getIceUsernameFragment()),this.setIcePassword(e.getIcePassword()),this.setCname(e.getCname()),this.setRtpPortMin(e.getRtpPortMin()),this.setRtpPortMax(e.getRtpPortMax()),this.setSctpPortMin(e.getSctpPortMin()),this.setSctpPortMax(e.getSctpPortMax()),this.setCandidateMode(e.getCandidateMode()),this.setEarlyCandidatesTimeout(e.getEarlyCandidatesTimeout()),this.setPublicIPAddress(e.getPublicIPAddress()),this.setVirtualAdapters(e.getVirtualAdapters())},s.prototype.getCandidateMode=function(){return this.__candidateMode},s.prototype.getCanReceive=function(){var e,t,n,s,r;for(t=!1,e=this.getStreams(),n=0,s=e.length;s>n;n++)r=e[n],t=t||fm.global.equals(r.getDirection(),fm.icelink.direction.SendReceive)||fm.global.equals(r.getDirection(),fm.icelink.direction.ReceiveOnly);return t},s.prototype.getCanSend=function(){var e,t,n,s,r;for(t=!1,e=this.getStreams(),n=0,s=e.length;s>n;n++)r=e[n],t=t||fm.global.equals(r.getDirection(),fm.icelink.direction.SendReceive)||fm.global.equals(r.getDirection(),fm.icelink.direction.SendOnly);return t},s.prototype.getCname=function(){return this._cname},s.prototype.getDeadStreamTimeout=function(){return this.__deadStreamTimeout},s.prototype.getDisableAutomaticReports=function(){return this._disableAutomaticReports},s.prototype.getDtlsCertificate=function(){return this._dtlsCertificate},s.prototype.getDtlsCipherSuites=function(){return this.__dtlsCipherSuites},s.prototype.getDtlsClientVersion=function(){return this.__dtlsClientVersion},s.prototype.getDtlsServerMaxVersion=function(){return this.__dtlsServerMaxVersion},s.prototype.getDtlsServerMinVersion=function(){return this.__dtlsServerMinVersion},s.prototype.getEarlyCandidatesTimeout=function(){return this.__earlyCandidatesTimeout},s.prototype.getIcePassword=function(){return this._icePassword},s.prototype.getIceUsernameFragment=function(){return this._iceUsernameFragment},s.prototype.getId=function(){return this._id},s.prototype.getKeepAliveInterval=function(){return this.__keepAliveInterval},s.prototype.getPublicIPAddress=function(){return this._publicIPAddress},s.prototype.getRelayPassword=function(){var e;return e=this.getRelayPasswords(),!fm.global.equals(e,null)&&e.length>0?e[0]:null},s.prototype.getRelayPasswords=function(){return this._relayPasswords},s.prototype.getRelayRealm=function(){var e;return e=this.getRelayRealms(),!fm.global.equals(e,null)&&e.length>0?e[0]:null},s.prototype.getRelayRealms=function(){return this._relayRealms},s.prototype.getRelayUsername=function(){var e;return e=this.getRelayUsernames(),!fm.global.equals(e,null)&&e.length>0?e[0]:null},s.prototype.getRelayUsernames=function(){return this._relayUsernames},s.prototype.getRtpPortMax=function(){return this.__rtpPortMax},s.prototype.getRtpPortMin=function(){return this.__rtpPortMin},s.prototype.getSctpPortMax=function(){return this.__sctpPortMax},s.prototype.getSctpPortMin=function(){return this.__sctpPortMin},s.prototype.getServerAddress=function(){var e;return e=this.getServerAddresses(),!fm.global.equals(e,null)&&e.length>0?e[0]:null},s.prototype.getServerAddresses=function(){return this._serverAddresses},s.prototype.getServerIPAddress=function(){return this.getServerAddress()},s.prototype.getServerPort=function(){var e,t,n,s,r,i;return i=this.getServerAddress(),!fm.global.equals(i,null)&&(s=null,r=0,e=new fm.holder(s),t=new fm.holder(r),n=fm.icelink.baseConference.parseAddress(i,e,t),s=e.getValue(),r=t.getValue(),n)?r:3478},s.prototype.getStreams=function(){return this.__streams},s.prototype.getSuppressPrivateCandidates=function(){return this._suppressPrivateCandidates},s.prototype.getSuppressPublicCandidates=function(){return this._suppressPublicCandidates},s.prototype.getSuppressRelayCandidates=function(){return this._suppressRelayCandidates},s.prototype.getVirtualAdapters=function(){return this._virtualAdapters},s.prototype.setCandidateMode=function(){var e;return e=arguments[0],this.__candidateMode=e},s.prototype.setCname=function(){var e;return e=arguments[0],this._cname=e},s.prototype.setDeadStreamTimeout=function(){var e;return e=arguments[0],this.__deadStreamTimeout=e},s.prototype.setDisableAutomaticReports=function(){var e;return e=arguments[0],this._disableAutomaticReports=e},s.prototype.setDtlsCertificate=function(){var e;return e=arguments[0],this._dtlsCertificate=e},s.prototype.setDtlsCipherSuites=function(){var e;return e=arguments[0],this.__dtlsCipherSuites=e},s.prototype.setDtlsClientVersion=function(){var e;return e=arguments[0],this.__dtlsClientVersion=e},s.prototype.setDtlsServerMaxVersion=function(){var e;return e=arguments[0],this.__dtlsServerMaxVersion=e},s.prototype.setDtlsServerMinVersion=function(){var e;return e=arguments[0],this.__dtlsServerMinVersion=e},s.prototype.setEarlyCandidatesTimeout=function(){var e;return e=arguments[0],this.__earlyCandidatesTimeout=e},s.prototype.setIcePassword=function(){var e;return e=arguments[0],this._icePassword=e},s.prototype.setIceUsernameFragment=function(){var e;return e=arguments[0],this._iceUsernameFragment=e},s.prototype.setId=function(){var e;return e=arguments[0],this._id=e},s.prototype.setKeepAliveInterval=function(){var e;return e=arguments[0],this.__keepAliveInterval=e},s.prototype.setPublicIPAddress=function(){var e;return e=arguments[0],this._publicIPAddress=e},s.prototype.setRelayPassword=function(){var e;return e=arguments[0],fm.global.equals(e,null)?this.setRelayPasswords(null):this.setRelayPasswords([e])},s.prototype.setRelayPasswords=function(){var e;return e=arguments[0],this._relayPasswords=e},s.prototype.setRelayRealm=function(){var e;return e=arguments[0],fm.global.equals(e,null)?this.setRelayRealms(null):this.setRelayRealms([e])},s.prototype.setRelayRealms=function(){var e;return e=arguments[0],this._relayRealms=e},s.prototype.setRelayUsername=function(){var e;return e=arguments[0],fm.global.equals(e,null)?this.setRelayUsernames(null):this.setRelayUsernames([e])},s.prototype.setRelayUsernames=function(){var e;return e=arguments[0],this._relayUsernames=e},s.prototype.setRtpPortMax=function(){var e;if(e=arguments[0],fm.global.equals(e%2,1))throw new Error("RTP port numbers must be even.");if(1024>e||e>65534)throw new Error("Value must be greater than or equal to 1024 and less than or equal to 65,534.");return this.__rtpPortMax=e},s.prototype.setRtpPortMin=function(){var e;if(e=arguments[0],fm.global.equals(e%2,1))throw new Error("RTP port numbers must be even.");if(1024>e||e>65534)throw new Error("Value must be greater than or equal to 1024 and less than or equal to 65,534.");return this.__rtpPortMin=e},s.prototype.setSctpPortMax=function(){var e;if(e=arguments[0],1024>e||e>65534)throw new Error("Value must be greater than or equal to 1024 and less than or equal to 65,534.");return this.__sctpPortMax=e},s.prototype.setSctpPortMin=function(){var e;if(e=arguments[0],1024>e||e>65534)throw new Error("Value must be greater than or equal to 1024 and less than or equal to 65,534.");return this.__sctpPortMin=e},s.prototype.setServerAddress=function(){var e;return e=arguments[0],fm.global.equals(e,null)?this.setServerAddresses(null):this.setServerAddresses([e])},s.prototype.setServerAddresses=function(){var e;return e=arguments[0],this._serverAddresses=e},s.prototype.setServerIPAddress=function(){var e;return e=arguments[0],this.setServerAddress(e)},s.prototype.setServerPort=function(){var e,t,n,s,r,i,o;return o=arguments[0],s=null,i=this.getServerAddress(),fm.global.equals(i,null)||(r=0,e=new fm.holder(s),t=new fm.holder(r),n=fm.icelink.baseConference.parseAddress(i,e,t),s=e.getValue(),r=t.getValue(),n||fm.log.error("Could not parse existing server address.")),fm.global.equals(s,null)&&(s="127.0.0.1"),this.setServerAddress(fm.stringExtensions.format("{0}:{1}",s,fm.intExtensions.toString(o)))},s.prototype.setStreams=function(){var e,t,n,s,r,i,o,a,u,l,c,h,p;if(p=arguments[0],fm.global.equals(p,null))throw new Error("Streams cannot be null.");for(l=[],e=[fm.icelink.streamType.Audio,fm.icelink.streamType.Video],s=0,o=e.length;o>s;s++)for(h=e[s],
t=p,r=0,a=t.length;a>r;r++)c=t[r],fm.global.equals(c.getType(),h)&&fm.arrayExtensions.add(l,c);for(n=p,i=0,u=n.length;u>i;i++)c=n[i],fm.global.equals(c.getType(),fm.icelink.streamType.Audio)||fm.global.equals(c.getType(),fm.icelink.streamType.Video)||fm.arrayExtensions.add(l,c);return this.__streams=fm.arrayExtensions.toArray(l)},s.prototype.setSuppressPrivateCandidates=function(){var e;return e=arguments[0],this._suppressPrivateCandidates=e},s.prototype.setSuppressPublicCandidates=function(){var e;return e=arguments[0],this._suppressPublicCandidates=e},s.prototype.setSuppressRelayCandidates=function(){var e;return e=arguments[0],this._suppressRelayCandidates=e},s.prototype.setVirtualAdapters=function(){var e;return e=arguments[0],this._virtualAdapters=e},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.baseLink=function(n){function s(){this.setPeerState=e(this.setPeerState,this),this.setPeerId=e(this.setPeerId,this),this.setConference=e(this.setConference,this),this.sendSCTPInternal=e(this.sendSCTPInternal,this),this.sendRTPInternal=e(this.sendRTPInternal,this),this.sendRTCPInternal=e(this.sendRTCPInternal,this),this.removeOnUp=e(this.removeOnUp,this),this.removeOnUnhandledException=e(this.removeOnUnhandledException,this),this.removeOnReceiveSCTP=e(this.removeOnReceiveSCTP,this),this.removeOnReceiveRTP=e(this.removeOnReceiveRTP,this),this.removeOnReceiveRTCP=e(this.removeOnReceiveRTCP,this),this.removeOnOfferAnswer=e(this.removeOnOfferAnswer,this),this.removeOnLocalAddresses=e(this.removeOnLocalAddresses,this),this.removeOnInit=e(this.removeOnInit,this),this.removeOnDown=e(this.removeOnDown,this),this.removeOnCandidate=e(this.removeOnCandidate,this),this.raiseUp=e(this.raiseUp,this),this.raiseUnhandledException=e(this.raiseUnhandledException,this),this.raiseReceiveSCTP=e(this.raiseReceiveSCTP,this),this.raiseReceiveRTP=e(this.raiseReceiveRTP,this),this.raiseReceiveRTCP=e(this.raiseReceiveRTCP,this),this.raiseOfferAnswer=e(this.raiseOfferAnswer,this),this.raiseLocalAddresses=e(this.raiseLocalAddresses,this),this.raiseInit=e(this.raiseInit,this),this.raiseDown=e(this.raiseDown,this),this.raiseCreateSuccess=e(this.raiseCreateSuccess,this),this.raiseCreateFailure=e(this.raiseCreateFailure,this),this.raiseCreateComplete=e(this.raiseCreateComplete,this),this.raiseCloseComplete=e(this.raiseCloseComplete,this),this.raiseCandidate=e(this.raiseCandidate,this),this.raiseAcceptSuccess=e(this.raiseAcceptSuccess,this),this.raiseAcceptFailure=e(this.raiseAcceptFailure,this),this.raiseAcceptComplete=e(this.raiseAcceptComplete,this),this.onSendSCTPSuccess=e(this.onSendSCTPSuccess,this),this.onSendSCTPFailure=e(this.onSendSCTPFailure,this),this.onCreateSuccess=e(this.onCreateSuccess,this),this.onCreateFailure=e(this.onCreateFailure,this),this.onCloseComplete=e(this.onCloseComplete,this),this.onAcceptSuccess=e(this.onAcceptSuccess,this),this.onAcceptFailure=e(this.onAcceptFailure,this),this.logOfferAnswer=e(this.logOfferAnswer,this),this.logCandidate=e(this.logCandidate,this),this.initializeInternal=e(this.initializeInternal,this),this.initializeComplete=e(this.initializeComplete,this),this.initialize=e(this.initialize,this),this.getWasUp=e(this.getWasUp,this),this.getTieBreaker=e(this.getTieBreaker,this),this.getRemoteOfferAnswer=e(this.getRemoteOfferAnswer,this),this.getReachedServer=e(this.getReachedServer,this),this.getReachedPeer=e(this.getReachedPeer,this),this.getPeerState=e(this.getPeerState,this),this.getPeerId=e(this.getPeerId,this),this.getNegotiatedStreams=e(this.getNegotiatedStreams,this),this.getLocalOfferAnswer=e(this.getLocalOfferAnswer,this),this.getIsOpening=e(this.getIsOpening,this),this.getIsOpened=e(this.getIsOpened,this),this.getIsCreating=e(this.getIsCreating,this),this.getIsClosing=e(this.getIsClosing,this),this.getIsAccepting=e(this.getIsAccepting,this),this.getHasOpened=e(this.getHasOpened,this),this.getHasCreated=e(this.getHasCreated,this),this.getHasClosed=e(this.getHasClosed,this),this.getHasAccepted=e(this.getHasAccepted,this),this.getControlling=e(this.getControlling,this),this.getConference=e(this.getConference,this),this.getAllRemoteCandidateTypes=e(this.getAllRemoteCandidateTypes,this),this.getAllRemoteCandidates=e(this.getAllRemoteCandidates,this),this.getAllLocalCandidateTypes=e(this.getAllLocalCandidateTypes,this),this.getAllLocalCandidates=e(this.getAllLocalCandidates,this),this.createOffer=e(this.createOffer,this),this.createInternal=e(this.createInternal,this),this.createAnswer=e(this.createAnswer,this),this.create=e(this.create,this),this.closeInternal=e(this.closeInternal,this),this.close=e(this.close,this),this.cacheRemoteCandidate=e(this.cacheRemoteCandidate,this),this.cacheLocalCandidate=e(this.cacheLocalCandidate,this),this.addRemoteCandidateInternal=e(this.addRemoteCandidateInternal,this),this.addRemoteCandidate=e(this.addRemoteCandidate,this),this.addOnUp=e(this.addOnUp,this),this.addOnUnhandledException=e(this.addOnUnhandledException,this),this.addOnReceiveSCTP=e(this.addOnReceiveSCTP,this),this.addOnReceiveRTP=e(this.addOnReceiveRTP,this),this.addOnReceiveRTCP=e(this.addOnReceiveRTCP,this),this.addOnOfferAnswer=e(this.addOnOfferAnswer,this),this.addOnLocalAddresses=e(this.addOnLocalAddresses,this),this.addOnInit=e(this.addOnInit,this),this.addOnDown=e(this.addOnDown,this),this.addOnCandidate=e(this.addOnCandidate,this),this.acceptInternal=e(this.acceptInternal,this),this.accept=e(this.accept,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),this.__tieBreaker=fm.guid.newGuid().toString(),this.__isCreating=!1,this.__hasCreated=!1,this.__isAccepting=!1,this.__hasAccepted=!1,this.__isClosing=!1,this.__hasClosed=!1,this.__isOpening=!1,this.__hasOpened=!1,this.__isOpened=!1,this.__negotiatedStreams=null,this.__allLocalCandidates=[],this.__allLocalCandidatesLock=new fm.object,this.__allRemoteCandidates=[],this.__allRemoteCandidatesLock=new fm.object,this._initialized=!1,this._createArgs=null,this._acceptArgs=null,this._closeArgs=null,this._earlyCandidates=[],this._stateLock=new fm.object,this._initializeCallback=null,this._raisedInit=!1,this._raisedUp=!1,this._raisedDown=!1,this._raisedLock=new fm.object,fm.util.attachProperties(this,arguments[0]),t):(t=s.__super__.constructor.call(this),this.__tieBreaker=fm.guid.newGuid().toString(),this.__isCreating=!1,this.__hasCreated=!1,this.__isAccepting=!1,this.__hasAccepted=!1,this.__isClosing=!1,this.__hasClosed=!1,this.__isOpening=!1,this.__hasOpened=!1,this.__isOpened=!1,this.__negotiatedStreams=null,this.__allLocalCandidates=[],this.__allLocalCandidatesLock=new fm.object,this.__allRemoteCandidates=[],this.__allRemoteCandidatesLock=new fm.object,this._initialized=!1,this._createArgs=null,this._acceptArgs=null,this._closeArgs=null,this._earlyCandidates=[],this._stateLock=new fm.object,this._initializeCallback=null,this._raisedInit=!1,this._raisedUp=!1,this._raisedDown=!1,this._raisedLock=new fm.object,t)}return t(s,n),s.prototype.__allLocalCandidates=null,s.prototype.__allLocalCandidatesLock=null,s.prototype.__allRemoteCandidates=null,s.prototype.__allRemoteCandidatesLock=null,s.prototype.__controlling=!1,s.prototype.__hasAccepted=!1,s.prototype.__hasClosed=!1,s.prototype.__hasCreated=!1,s.prototype.__hasOpened=!1,s.prototype.__isAccepting=!1,s.prototype.__isClosing=!1,s.prototype.__isCreating=!1,s.prototype.__isOpened=!1,s.prototype.__isOpening=!1,s.prototype.__localOfferAnswer=null,s.prototype.__negotiatedStreams=null,s.prototype.__reachedPeer=!1,s.prototype.__reachedServer=!1,s.prototype.__remoteOfferAnswer=null,s.prototype.__tieBreaker=null,s.prototype.__wasUp=!1,s.prototype._acceptArgs=null,s.prototype._closeArgs=null,s.prototype._conference=null,s.prototype._createArgs=null,s.prototype._earlyCandidates=null,s.prototype._initializeCallback=null,s.prototype._initialized=!1,s.prototype._onCandidate=null,s.prototype._onDown=null,s.prototype._onInit=null,s.prototype._onLocalAddresses=null,s.prototype._onOfferAnswer=null,s.prototype._onReceiveRTCP=null,s.prototype._onReceiveRTP=null,s.prototype._onReceiveSCTP=null,s.prototype._onUnhandledException=null,s.prototype._onUp=null,s.prototype._peerId=null,s.prototype._peerState=null,s.prototype._raisedDown=!1,s.prototype._raisedInit=!1,s.prototype._raisedLock=null,s.prototype._raisedUp=!1,s.prototype._stateLock=null,s.prototype.accept=function(){var e,t,n;if(e=arguments[0],fm.global.equals(e,null))throw new Error("acceptArgs cannot be null.");if(this.getRtpPortMin()>this.getRtpPortMax())throw new Error("RTPPortMin cannot be greater than RTPPortMax.");if(this.getSctpPortMin()>this.getSctpPortMax())throw new Error("SCTPPortMin cannot be greater than SCTPPortMax.");if(!this._initialized)throw new Error("Link must be initialized before an offer/answer can be accepted.");try{return this.getIsAccepting()||this.getHasAccepted()?void fm.log.warn("Accept can only be invoked once."):(this._acceptArgs=e,this.__isAccepting=!0,this.__hasAccepted=!1,this.__reachedPeer=!0,this.__remoteOfferAnswer=e.getOfferAnswer(),fm.log.getIsDebugEnabled()&&this.logOfferAnswer(e.getOfferAnswer(),!1),this.acceptInternal(e,this.onAcceptSuccess,this.onAcceptFailure))}catch(t){return n=t,fm.log.error("Could not accept offer/answer.",n),this.raiseAcceptFailure(e,n),this.raiseAcceptComplete(e)}finally{}},s.prototype.acceptInternal=function(){var e,t,n;return e=arguments[0],n=arguments[1],t=arguments[2]},s.prototype.addOnCandidate=function(){var e;return e=arguments[0],this._onCandidate=fm.delegate.combine(this._onCandidate,e)},s.prototype.addOnDown=function(){var e;return e=arguments[0],this._onDown=fm.delegate.combine(this._onDown,e)},s.prototype.addOnInit=function(){var e;return e=arguments[0],this._onInit=fm.delegate.combine(this._onInit,e)},s.prototype.addOnLocalAddresses=function(){var e;return e=arguments[0],this._onLocalAddresses=fm.delegate.combine(this._onLocalAddresses,e)},s.prototype.addOnOfferAnswer=function(){var e;return e=arguments[0],this._onOfferAnswer=fm.delegate.combine(this._onOfferAnswer,e)},s.prototype.addOnReceiveRTCP=function(){var e;return e=arguments[0],this._onReceiveRTCP=fm.delegate.combine(this._onReceiveRTCP,e)},s.prototype.addOnReceiveRTP=function(){var e;return e=arguments[0],this._onReceiveRTP=fm.delegate.combine(this._onReceiveRTP,e)},s.prototype.addOnReceiveSCTP=function(){var e;return e=arguments[0],this._onReceiveSCTP=fm.delegate.combine(this._onReceiveSCTP,e)},s.prototype.addOnUnhandledException=function(){var e;return e=arguments[0],this._onUnhandledException=fm.delegate.combine(this._onUnhandledException,e)},s.prototype.addOnUp=function(){var e;return e=arguments[0],this._onUp=fm.delegate.combine(this._onUp,e)},s.prototype.addRemoteCandidate=function(){var e;if(e=arguments[0],fm.global.equals(e,null))throw new Error("candidate cannot be null.");return this.cacheRemoteCandidate(e),fm.log.getIsDebugEnabled()&&this.logCandidate(e,!1),this.getHasCreated()&&this.getHasAccepted()?this.addRemoteCandidateInternal(e):void fm.arrayExtensions.add(this._earlyCandidates,e)},s.prototype.addRemoteCandidateInternal=function(){var e;return e=arguments[0]},s.prototype.cacheLocalCandidate=function(){var e;return e=arguments[0],fm.arrayExtensions.add(this.__allLocalCandidates,e)},s.prototype.cacheRemoteCandidate=function(){var e;return e=arguments[0],fm.arrayExtensions.add(this.__allRemoteCandidates,e)},s.prototype.close=function(){var e,t,n;if(0===arguments.length)return void this.close(new fm.icelink.closeArgs);if(1===arguments.length){if(e=arguments[0],fm.global.equals(e,null))throw new Error("closeArgs cannot be null.");try{if(this.getIsClosing()||this.getHasClosed())throw new Error("Close can only be invoked once.");this._closeArgs=e,this.__isClosing=!0,this.closeInternal(e,this.onCloseComplete)}catch(t){n=t,this.raiseCloseComplete(e,n)}finally{}}},s.prototype.closeInternal=function(){var e,t;return e=arguments[0],t=arguments[1]},s.prototype.create=function(){var e,t,n,s;if(t=arguments[0],e=arguments[1],fm.global.equals(t,null))throw new Error("createArgs cannot be null.");if(this.getRtpPortMin()>this.getRtpPortMax())throw new Error("RTPPortMin cannot be greater than RTPPortMax.");if(this.getSctpPortMin()>this.getSctpPortMax())throw new Error("SCTPPortMin cannot be greater than SCTPPortMax.");if(!this._initialized)throw new Error("Link must be initialized before an offer/answer can be created.");try{return this.getIsCreating()||this.getHasCreated()?void fm.log.warn("Create can only be invoked once."):(this.__controlling=e,this._createArgs=t,this.__isCreating=!0,this.__hasCreated=!1,this.createInternal(t,this.onCreateSuccess,this.onCreateFailure))}catch(n){return s=n,fm.log.error("Could not create offer/answer.",s),this.raiseCreateFailure(t,s),this.raiseCreateComplete(t)}finally{}},s.prototype.createAnswer=function(){var e;return e=arguments[0],this.create(e,!1)},s.prototype.createInternal=function(){var e,t,n;return e=arguments[0],n=arguments[1],t=arguments[2]},s.prototype.createOffer=function(){var e;return e=arguments[0],this.create(e,!0)},s.prototype.getAllLocalCandidates=function(){return fm.arrayExtensions.toArray(this.__allLocalCandidates)},s.prototype.getAllLocalCandidateTypes=function(){var e,t,n,s,r;for(r=[],e=this.getAllLocalCandidates(),n=0,s=e.length;s>n;n++)t=e[n],fm.arrayExtensions.add(r,t.getType());return fm.arrayExtensions.toArray(r)},s.prototype.getAllRemoteCandidates=function(){return fm.arrayExtensions.toArray(this.__allRemoteCandidates)},s.prototype.getAllRemoteCandidateTypes=function(){var e,t,n,s,r;for(r=[],e=this.getAllRemoteCandidates(),n=0,s=e.length;s>n;n++)t=e[n],fm.arrayExtensions.add(r,t.getType());return fm.arrayExtensions.toArray(r)},s.prototype.getConference=function(){return this._conference},s.prototype.getControlling=function(){return this.__controlling},s.prototype.getHasAccepted=function(){return this.__hasAccepted},s.prototype.getHasClosed=function(){return this.__hasClosed},s.prototype.getHasCreated=function(){return this.__hasCreated},s.prototype.getHasOpened=function(){return this.__hasOpened},s.prototype.getIsAccepting=function(){return this.__isAccepting},s.prototype.getIsClosing=function(){return this.__isClosing},s.prototype.getIsCreating=function(){return this.__isCreating},s.prototype.getIsOpened=function(){return this.__isOpened},s.prototype.getIsOpening=function(){return this.__isOpening},s.prototype.getLocalOfferAnswer=function(){return this.__localOfferAnswer},s.prototype.getNegotiatedStreams=function(){return this.__negotiatedStreams},s.prototype.getPeerId=function(){return this._peerId},s.prototype.getPeerState=function(){return this._peerState},s.prototype.getReachedPeer=function(){return this.__reachedPeer},s.prototype.getReachedServer=function(){return this.__reachedServer},s.prototype.getRemoteOfferAnswer=function(){return this.__remoteOfferAnswer},s.prototype.getTieBreaker=function(){return this.__tieBreaker},s.prototype.getWasUp=function(){return this.__wasUp},s.prototype.initialize=function(){var e,t,n,s,r,i,o,a,u;if(o=arguments[0],i=arguments[1],s=arguments[2],r=arguments[3],u=arguments[4],e=arguments[5],!fm.global.equals(o,null))for(t=0;t<o.length;)try{a=o[t],n=fm.stringExtensions.indexOf(a,"?"),n>-1&&(o[t]=fm.stringExtensions.substring(a,0,n))}finally{t++}return this.setServerAddresses(o),this.setRelayUsernames(i),this.setRelayPasswords(s),this.setRelayRealms(r),this.setStreams(u),this._initializeCallback=e,this.initializeInternal(this.initializeComplete)},s.prototype.initializeComplete=function(){var e,t;return t=arguments[0],e=this._initializeCallback,this._initialized=!0,fm.global.equals(e,null)?void 0:e(t)},s.prototype.initializeInternal=function(){var e;return e=arguments[0]},s.prototype.logCandidate=function(){var e,t,n,s,r;for(e=arguments[0],t=arguments[1],s="",s=fm.global.equals(e.getType(),fm.icelink.candidateType.Private)?" (private)":fm.global.equals(e.getType(),fm.icelink.candidateType.Relay)?" (relay)":" (public)",r="",null!==e.getSdpMediaIndex()&&(r=fm.stringExtensions.concat(" ",fm.intExtensions.toString(e.getSdpMediaIndex()))),n=e.getSdpCandidateAttribute();fm.stringExtensions.endsWith(n,"\n");)n=fm.stringExtensions.substring(n,0,n.length-1);return fm.log.debugFormat("{0} SDP candidate{1} for stream{2}: {3}",[t?"Local":"Remote",s,r,n])},s.prototype.logOfferAnswer=function(){var e,t,n;for(t=arguments[0],e=arguments[1],n=t.getSdpMessage();fm.stringExtensions.endsWith(n,"\n");)n=fm.stringExtensions.substring(n,0,n.length-1);return fm.log.debugFormat("{0} SDP {1}:{2}{3}",[e?"Local":"Remote",t.getIsOffer()?"offer":"answer","\n",n])},s.prototype.onAcceptFailure=function(){var e,t;return t=arguments[0],e=this._acceptArgs,this.__isAccepting=!1,this.__hasAccepted=!1,fm.global.equals(e,null)?void 0:(this.raiseAcceptFailure(e,t),this.raiseAcceptComplete(e))},s.prototype.onAcceptSuccess=function(){var e,t,n,s,r,i,o;if(t=this._acceptArgs,this.__isAccepting=!1,this.__hasAccepted=!0,this.getHasCreated())for(e=this._earlyCandidates,i=0,o=e.length;o>i;i++){n=e[i];try{this.addRemoteCandidateInternal(n)}catch(s){r=s,fm.log.error("Could not add early remote candidate.",r)}finally{}}return fm.global.equals(t,null)?void 0:(this.raiseAcceptSuccess(t),this.raiseAcceptComplete(t))},s.prototype.onCloseComplete=function(){var e,t;return t=arguments[0],e=this._closeArgs,this.__isClosing=!1,this.__hasClosed=!0,fm.global.equals(e,null)?void 0:this.raiseCloseComplete(e,t)},s.prototype.onCreateFailure=function(){var e,t;return t=arguments[0],e=this._createArgs,this.__isCreating=!1,this.__hasCreated=!1,fm.global.equals(e,null)?void 0:(this.raiseCreateFailure(e,t),this.raiseCreateComplete(e))},s.prototype.onCreateSuccess=function(){var e,t,n,s,r,i;if(i=arguments[0],n=this._createArgs,this.__isCreating=!1,this.__hasCreated=!0,this.getHasAccepted())for(e=this._earlyCandidates,s=0,r=e.length;r>s;s++)t=e[s],this.addRemoteCandidateInternal(t);return i.setIsOffer(this.getControlling()),i.setTieBreaker(this.getTieBreaker()),this.raiseOfferAnswer(i),fm.global.equals(n,null)?void 0:(this.raiseCreateSuccess(n,i),this.raiseCreateComplete(n))},s.prototype.onSendSCTPFailure=function(){var e;return e=arguments[0],fm.global.tryCast(e.getDynamicValue("fm.icelink.baselink.sendSCTPArgs"),fm.icelink.sendSCTPArgs).raiseFailure(this.getConference(),this,e.getException())},s.prototype.onSendSCTPSuccess=function(){var e;return e=arguments[0],fm.global.tryCast(e.getDynamicValue("fm.icelink.baselink.sendSCTPArgs"),fm.icelink.sendSCTPArgs).raiseSuccess(this.getConference(),this)},s.prototype.raiseAcceptComplete=function(){var e,t;return e=arguments[0],fm.global.equals(e.getOnComplete(),null)?void 0:(t=new fm.icelink.acceptCompleteArgs,t.setLink(this),t.setOfferAnswer(e.getOfferAnswer()),t.setDynamicProperties(e.getDynamicProperties()),e.getOnComplete()(t))},s.prototype.raiseAcceptFailure=function(){var e,t,n;return e=arguments[0],t=arguments[1],fm.global.equals(e.getOnFailure(),null)?void 0:(n=new fm.icelink.acceptFailureArgs,n.setLink(this),n.setOfferAnswer(e.getOfferAnswer()),n.setDynamicProperties(e.getDynamicProperties()),n.setException(t),e.getOnFailure()(n))},s.prototype.raiseAcceptSuccess=function(){var e,t;return e=arguments[0],fm.global.equals(e.getOnSuccess(),null)?void 0:(t=new fm.icelink.acceptSuccessArgs,t.setLink(this),t.setOfferAnswer(e.getOfferAnswer()),t.setDynamicProperties(e.getDynamicProperties()),e.getOnSuccess()(t))},s.prototype.raiseCandidate=function(){var e,t,n,s,r,i,o,a,u,l;if(t=arguments[0],l=t.getType(),r=fm.global.equals(l,fm.icelink.candidateType.Private),i=fm.global.equals(l,fm.icelink.candidateType.Public),o=fm.global.equals(l,fm.icelink.candidateType.Relay),this.__reachedServer=this.__reachedServer||i||o,(r&&!this.getSuppressPrivateCandidates()||i&&!this.getSuppressPublicCandidates()||o&&!this.getSuppressRelayCandidates())&&(e=new fm.icelink.linkCandidateArgs,e.setLink(this),e.setConference(this.getConference()),e.setCandidate(t),e.setDynamicProperties(this.getDynamicProperties()),u=e,a=this._onCandidate,!fm.global.equals(a,null))){this.cacheLocalCandidate(t),fm.log.getIsDebugEnabled()&&this.logCandidate(t,!0);try{return a(u)}catch(n){if(s=n,!this.raiseUnhandledException(s))return fm.asyncException.asyncThrow(s,"Link -> OnCandidate")}finally{}}},s.prototype.raiseCloseComplete=function(){var e,t,n;return e=arguments[0],t=arguments[1],fm.global.equals(e.getOnComplete(),null)?void 0:(n=new fm.icelink.closeCompleteArgs,n.setLink(this),n.setDynamicProperties(e.getDynamicProperties()),n.setReason(e.getReason()),n.setException(t),e.getOnComplete()(n))},s.prototype.raiseCreateComplete=function(){var e,t;return e=arguments[0],fm.global.equals(e.getOnComplete(),null)?void 0:(t=new fm.icelink.createCompleteArgs,t.setLink(this),t.setDynamicProperties(e.getDynamicProperties()),e.getOnComplete()(t))},s.prototype.raiseCreateFailure=function(){var e,t,n;return e=arguments[0],t=arguments[1],fm.global.equals(e.getOnFailure(),null)?void 0:(n=new fm.icelink.createFailureArgs,n.setLink(this),n.setDynamicProperties(e.getDynamicProperties()),n.setException(t),e.getOnFailure()(n))},s.prototype.raiseCreateSuccess=function(){var e,t,n;return e=arguments[0],t=arguments[1],fm.global.equals(e.getOnSuccess(),null)?void 0:(n=new fm.icelink.createSuccessArgs,n.setLink(this),n.setDynamicProperties(e.getDynamicProperties()),n.setOfferAnswer(t),e.getOnSuccess()(n))},s.prototype.raiseDown=function(){var e,t,n,s,r,i,o,a,u,l,c,h,p,g,m,f,d,y,_,b,v,C,w;if(i=arguments[0],y=arguments[1],w=arguments[2],C=arguments[3],n=arguments[4],_=arguments[5],c=arguments[6],this._raisedDown)return!1;if(this._raisedDown=!0,!this._raisedInit)return!1;for(this.__isOpening=!1,this.__isOpened=!1,t=new fm.icelink.linkDownArgs,t.setLink(this),t.setConference(this.getConference()),t.setException(i),t.setReason(y),t.setTimedOut(w),t.setIsSwitchingRoles(C),t.setDeadStreamDetected(n),t.setRelayFailureDetected(_),t.setNewOfferReceived(c),t.setDynamicProperties(this.getDynamicProperties()),s=t,l=0,h=0,p=0,g=0,m=0,f=0,e=this.getStreams(),a=0,u=e.length;u>a;a++){switch(b=e[a],v=0,b.getType()){case fm.icelink.streamType.Audio:v=p++;break;case fm.icelink.streamType.Video:v=f++;break;case fm.icelink.streamType.Text:v=m++;break;case fm.icelink.streamType.Application:v=h++;break;case fm.icelink.streamType.Message:v=g++}b.raiseDown(s,v,l),l++}if(d=this._onDown,!fm.global.equals(d,null))try{d(s)}catch(r){o=r,this.raiseUnhandledException(o)||fm.asyncException.asyncThrow(o,"Link -> OnDown")}finally{}return!0},s.prototype.raiseInit=function(){var e,t,n,s,r,i,o,a,u,l,c,h,p,g,m,f,d;if(i=arguments[0],this._raisedInit)return!1;if(this._raisedInit=!0,this._raisedDown)return!1;for(this.__isOpening=!0,t=new fm.icelink.linkInitArgs,t.setLink(this),t.setConference(this.getConference()),t.setInitiator(i),t.setDynamicProperties(this.getDynamicProperties()),n=t,u=0,l=0,c=0,h=0,p=0,g=0,e=this.getStreams(),o=0,a=e.length;a>o;o++){switch(f=e[o],d=0,f.getType()){case fm.icelink.streamType.Audio:d=c++;break;case fm.icelink.streamType.Video:d=g++;break;case fm.icelink.streamType.Text:d=p++;break;case fm.icelink.streamType.Application:d=l++;break;case fm.icelink.streamType.Message:d=h++}f.raiseInit(n,d,u),u++}if(m=this._onInit,!fm.global.equals(m,null))try{m(n)}catch(s){r=s,this.raiseUnhandledException(r)||fm.asyncException.asyncThrow(r,"Link -> OnInit")}finally{}return!0},s.prototype.raiseLocalAddresses=function(){var e,t,n,s,r,i;if(s=arguments[0],e=new fm.icelink.linkLocalAddressesArgs(s),e.setLink(this),e.setConference(this.getConference()),e.setDynamicProperties(this.getDynamicProperties()),i=e,r=this._onLocalAddresses,!fm.global.equals(r,null))try{r(i)}catch(t){n=t,this.raiseUnhandledException(n)||fm.asyncException.asyncThrow(n,"Link -> OnLocalAddresses")}finally{}return i.getLocalAddresses()},s.prototype.raiseOfferAnswer=function(){var e,t,n,s,r,i,o,a,u,l,c,h,p,g,m,f,d;if(p=arguments[0],this.__localOfferAnswer=p,r=fm.stringExtensions.indexOf(p.getSdpMessage(),"typ srflx")>-1,i=fm.stringExtensions.indexOf(p.getSdpMessage(),"typ relay")>-1,this.__reachedServer=this.__reachedServer||r||i,this.getSuppressPrivateCandidates()||this.getSuppressPublicCandidates()||this.getSuppressRelayCandidates()){for(d=fm.stringExtensions.split(p.getSdpMessage(),["\n"]),h=[],e=d,l=0,c=e.length;c>l;l++)f=e[l],fm.stringExtensions.startsWith(f,"a=candidate")?(o=fm.stringExtensions.indexOf(f,"typ host")>-1,a=fm.stringExtensions.indexOf(f,"typ srflx")>-1,u=fm.stringExtensions.indexOf(f,"typ relay")>-1,(o&&!this.getSuppressPrivateCandidates()||a&&!this.getSuppressPublicCandidates()||u&&!this.getSuppressRelayCandidates())&&fm.arrayExtensions.add(h,f)):fm.arrayExtensions.add(h,f);p.setSdpMessage(fm.stringExtensions.join("\n",fm.arrayExtensions.toArray(h)))}if(t=new fm.icelink.linkOfferAnswerArgs,t.setLink(this),t.setConference(this.getConference()),t.setOfferAnswer(p),t.setDynamicProperties(this.getDynamicProperties()),m=t,g=this._onOfferAnswer,!fm.global.equals(g,null))try{g(m)}catch(n){s=n,this.raiseUnhandledException(s)||fm.asyncException.asyncThrow(s,"Link -> OnOfferAnswer")}finally{}return fm.log.getIsDebugEnabled()?this.logOfferAnswer(p,!0):void 0},s.prototype.raiseReceiveRTCP=function(){var e,t,n,s,r,i,o,a,u,l;if(a=arguments[0],u=arguments[1],l=arguments[2],s=arguments[3],r=arguments[4],e=new fm.icelink.linkReceiveRTCPArgs,e.setLink(this),e.setConference(this.getConference()),e.setPackets(a),e.setStream(u),e.setStreamIndex(l),e.setMediaIndex(s),e.setNegotiatedStream(r),e.setDynamicProperties(this.getDynamicProperties()),o=e,i=this._onReceiveRTCP,!fm.global.equals(i,null))try{return i(o)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Link -> OnReceiveRTCP")}finally{}},s.prototype.raiseReceiveRTP=function(){var e,t,n,s,r,i,o,a,u,l,c;if(a=arguments[0],u=arguments[1],c=arguments[2],s=arguments[3],r=arguments[4],l=arguments[5],e=new fm.icelink.linkReceiveRTPArgs,e.setLink(this),e.setConference(this.getConference()),e.setPacket(a),e.setStream(u),e.setStreamIndex(c),e.setMediaIndex(s),e.setNegotiatedStream(r),e.setStreamFormat(l),e.setDynamicProperties(this.getDynamicProperties()),o=e,i=this._onReceiveRTP,!fm.global.equals(i,null))try{return i(o)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Link -> OnReceiveRTP")}finally{}},s.prototype.raiseReceiveSCTP=function(){var e,t,n,s,r,i,o,a,u,l,c;if(i=arguments[0],t=arguments[1],l=arguments[2],c=arguments[3],r=arguments[4],o=arguments[5],e=new fm.icelink.linkReceiveSCTPArgs,e.setLink(this),e.setConference(this.getConference()),e.setMessage(i),e.setChannelIndex(t),e.setStream(l),e.setStreamIndex(c),e.setMediaIndex(r),e.setNegotiatedStream(o),e.setDynamicProperties(this.getDynamicProperties()),u=e,a=this._onReceiveSCTP,!fm.global.equals(a,null))try{return a(u)}catch(n){if(s=n,!this.raiseUnhandledException(s))return fm.asyncException.asyncThrow(s,"Link -> OnReceiveSCTP")}finally{}},s.prototype.raiseUnhandledException=function(){var e,t,n,s,r,i;if(n=arguments[0],r=this._onUnhandledException,!fm.global.equals(r,null)){e=new fm.icelink.unhandledExceptionArgs,e.setException(n),i=e;try{r(i)}catch(t){s=t,fm.asyncException.asyncThrow(s,"Link -> OnUnhandledException")}finally{}return i.getHandled()}return!1},s.prototype.raiseUp=function(){var e,t,n,s,r,i,o,a,u,l,c,h,p,g,m,f;if(this._raisedUp)return!1;for(this._raisedUp=!0,this.__isOpening=!1,this.__isOpened=!0,this.__hasOpened=!0,t=new fm.icelink.linkUpArgs,t.setLink(this),t.setConference(this.getConference()),t.setNegotiatedStreams(this.getNegotiatedStreams()),t.setDynamicProperties(this.getDynamicProperties()),n=t,this.__wasUp=!0,a=0,u=0,l=0,c=0,h=0,p=0,e=this.getStreams(),i=0,o=e.length;o>i;i++){switch(m=e[i],f=0,m.getType()){case fm.icelink.streamType.Audio:f=l++;break;case fm.icelink.streamType.Video:f=p++;break;case fm.icelink.streamType.Text:f=h++;break;case fm.icelink.streamType.Application:f=u++;break;case fm.icelink.streamType.Message:f=c++}m.raiseUp(n,f,a),a++}if(g=this._onUp,!fm.global.equals(g,null))try{g(n)}catch(s){r=s,this.raiseUnhandledException(r)||fm.asyncException.asyncThrow(r,"Link -> OnUp")}finally{}return!0},s.prototype.removeOnCandidate=function(){var e;return e=arguments[0],this._onCandidate=fm.delegate.remove(this._onCandidate,e)},s.prototype.removeOnDown=function(){var e;return e=arguments[0],this._onDown=fm.delegate.remove(this._onDown,e)},s.prototype.removeOnInit=function(){var e;return e=arguments[0],this._onInit=fm.delegate.remove(this._onInit,e)},s.prototype.removeOnLocalAddresses=function(){var e;return e=arguments[0],this._onLocalAddresses=fm.delegate.remove(this._onLocalAddresses,e)},s.prototype.removeOnOfferAnswer=function(){var e;return e=arguments[0],this._onOfferAnswer=fm.delegate.remove(this._onOfferAnswer,e)},s.prototype.removeOnReceiveRTCP=function(){var e;return e=arguments[0],this._onReceiveRTCP=fm.delegate.remove(this._onReceiveRTCP,e)},s.prototype.removeOnReceiveRTP=function(){var e;return e=arguments[0],this._onReceiveRTP=fm.delegate.remove(this._onReceiveRTP,e)},s.prototype.removeOnReceiveSCTP=function(){var e;return e=arguments[0],this._onReceiveSCTP=fm.delegate.remove(this._onReceiveSCTP,e)},s.prototype.removeOnUnhandledException=function(){var e;return e=arguments[0],this._onUnhandledException=fm.delegate.remove(this._onUnhandledException,e)},s.prototype.removeOnUp=function(){var e;return e=arguments[0],this._onUp=fm.delegate.remove(this._onUp,e)},s.prototype.sendRTCPInternal=function(){var e,t;return t=arguments[0],e=arguments[1]},s.prototype.sendRTPInternal=function(){var e,t,n;return t=arguments[0],n=arguments[1],e=arguments[2]},s.prototype.sendSCTPInternal=function(){var e,t;return t=arguments[0],e=arguments[1]},s.prototype.setConference=function(){var e;return e=arguments[0],this._conference=e},s.prototype.setPeerId=function(){var e;return e=arguments[0],this._peerId=e},s.prototype.setPeerState=function(){var e;return e=arguments[0],this._peerState=e},s}(fm.icelink.baseConference);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.baseStream=function(n){function s(){this.setType=e(this.setType,this),this.setProtocol=e(this.setProtocol,this),this.setOfferDtls=e(this.setOfferDtls,this),this.setMultiplexRtpRtcp=e(this.setMultiplexRtpRtcp,this),this.setDirection=e(this.setDirection,this),this.removeOnUnhandledException=e(this.removeOnUnhandledException,this),this.removeOnLinkUp=e(this.removeOnLinkUp,this),this.removeOnLinkReceiveSCTP=e(this.removeOnLinkReceiveSCTP,this),this.removeOnLinkReceiveRTP=e(this.removeOnLinkReceiveRTP,this),this.removeOnLinkReceiveRTCP=e(this.removeOnLinkReceiveRTCP,this),this.removeOnLinkInit=e(this.removeOnLinkInit,this),this.removeOnLinkDown=e(this.removeOnLinkDown,this),this.raiseUp=e(this.raiseUp,this),this.raiseUnhandledException=e(this.raiseUnhandledException,this),this.raiseReceiveSCTP=e(this.raiseReceiveSCTP,this),this.raiseReceiveRTP=e(this.raiseReceiveRTP,this),this.raiseReceiveRTCP=e(this.raiseReceiveRTCP,this),this.raiseInit=e(this.raiseInit,this),this.raiseDown=e(this.raiseDown,this),this.getType=e(this.getType,this),this.getProtocol=e(this.getProtocol,this),this.getOfferDtls=e(this.getOfferDtls,this),this.getMultiplexRtpRtcp=e(this.getMultiplexRtpRtcp,this),this.getDirection=e(this.getDirection,this),this.addOnUnhandledException=e(this.addOnUnhandledException,this),this.addOnLinkUp=e(this.addOnLinkUp,this),this.addOnLinkReceiveSCTP=e(this.addOnLinkReceiveSCTP,this),this.addOnLinkReceiveRTP=e(this.addOnLinkReceiveRTP,this),this.addOnLinkReceiveRTCP=e(this.addOnLinkReceiveRTCP,this),this.addOnLinkInit=e(this.addOnLinkInit,this),
this.addOnLinkDown=e(this.addOnLinkDown,this);var t,n,r;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):(r=arguments[0],n=arguments[1],t=s.__super__.constructor.call(this),this.setType(r),this.setProtocol(n),t)}return t(s,n),s.prototype._direction=null,s.prototype._multiplexRtpRtcp=!1,s.prototype._offerDtls=!1,s.prototype._onLinkDown=null,s.prototype._onLinkInit=null,s.prototype._onLinkReceiveRTCP=null,s.prototype._onLinkReceiveRTP=null,s.prototype._onLinkReceiveSCTP=null,s.prototype._onLinkUp=null,s.prototype._onUnhandledException=null,s.prototype._protocol=null,s.prototype._type=null,s.prototype.addOnLinkDown=function(){var e;return e=arguments[0],this._onLinkDown=fm.delegate.combine(this._onLinkDown,e)},s.prototype.addOnLinkInit=function(){var e;return e=arguments[0],this._onLinkInit=fm.delegate.combine(this._onLinkInit,e)},s.prototype.addOnLinkReceiveRTCP=function(){var e;return e=arguments[0],this._onLinkReceiveRTCP=fm.delegate.combine(this._onLinkReceiveRTCP,e)},s.prototype.addOnLinkReceiveRTP=function(){var e;return e=arguments[0],this._onLinkReceiveRTP=fm.delegate.combine(this._onLinkReceiveRTP,e)},s.prototype.addOnLinkReceiveSCTP=function(){var e;return e=arguments[0],this._onLinkReceiveSCTP=fm.delegate.combine(this._onLinkReceiveSCTP,e)},s.prototype.addOnLinkUp=function(){var e;return e=arguments[0],this._onLinkUp=fm.delegate.combine(this._onLinkUp,e)},s.prototype.addOnUnhandledException=function(){var e;return e=arguments[0],this._onUnhandledException=fm.delegate.combine(this._onUnhandledException,e)},s.prototype.getDirection=function(){return this._direction},s.prototype.getMultiplexRtpRtcp=function(){return this._multiplexRtpRtcp},s.prototype.getOfferDtls=function(){return this._offerDtls},s.prototype.getProtocol=function(){return this._protocol},s.prototype.getType=function(){return this._type},s.prototype.raiseDown=function(){var e,t,n,s,r,i,o;if(e=arguments[0],o=arguments[1],s=arguments[2],r=this._onLinkDown,!fm.global.equals(r,null))try{return i=new fm.icelink.streamLinkDownArgs,i.setStream(this),i.setStreamIndex(o),i.setConference(e.getConference()),i.setLink(e.getLink()),i.setTimedOut(e.getTimedOut()),i.setIsSwitchingRoles(e.getIsSwitchingRoles()),i.setDeadStreamDetected(e.getDeadStreamDetected()),i.setRelayFailureDetected(e.getRelayFailureDetected()),i.setNewOfferReceived(e.getNewOfferReceived()),i.setDynamicProperties(this.getDynamicProperties()),i.setException(e.getException()),r(i)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Stream -> OnLinkDown")}finally{}},s.prototype.raiseInit=function(){var e,t,n,s,r,i,o;if(e=arguments[0],o=arguments[1],s=arguments[2],r=this._onLinkInit,!fm.global.equals(r,null))try{return i=new fm.icelink.streamLinkInitArgs,i.setStream(this),i.setStreamIndex(o),i.setConference(e.getConference()),i.setLink(e.getLink()),i.setDynamicProperties(this.getDynamicProperties()),i.setInitiator(e.getInitiator()),r(i)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Stream -> OnLinkInit")}finally{}},s.prototype.raiseReceiveRTCP=function(){var e,t,n,s;if(e=arguments[0],s=this._onLinkReceiveRTCP,!fm.global.equals(s,null))try{return s(e)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Stream -> OnLinkReceiveRTCP")}finally{}},s.prototype.raiseReceiveRTP=function(){var e,t,n,s;if(e=arguments[0],s=this._onLinkReceiveRTP,!fm.global.equals(s,null))try{return s(e)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Stream -> OnLinkReceiveRTP")}finally{}},s.prototype.raiseReceiveSCTP=function(){var e,t,n,s;if(e=arguments[0],s=this._onLinkReceiveSCTP,!fm.global.equals(s,null))try{return s(e)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Stream -> OnLinkReceiveSCTP")}finally{}},s.prototype.raiseUnhandledException=function(){var e,t,n,s,r,i;if(n=arguments[0],r=this._onUnhandledException,!fm.global.equals(r,null)){e=new fm.icelink.unhandledExceptionArgs,e.setException(n),i=e;try{r(i)}catch(t){s=t,fm.asyncException.asyncThrow(s,"Stream -> OnUnhandledException")}finally{}return i.getHandled()}return!1},s.prototype.raiseUp=function(){var e,t,n,s,r,i,o,a;if(e=arguments[0],a=arguments[1],s=arguments[2],i=this._onLinkUp,!fm.global.equals(i,null))try{return r=e.getNegotiatedStreams(),o=new fm.icelink.streamLinkUpArgs,o.setStream(this),o.setStreamIndex(a),o.setConference(e.getConference()),o.setLink(e.getLink()),o.setDynamicProperties(this.getDynamicProperties()),o.setNegotiatedStreams(r),o.setNegotiatedStream(!fm.global.equals(r,null)&&s<r.length?r[s]:null),i(o)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Stream -> OnLinkUp")}finally{}},s.prototype.removeOnLinkDown=function(){var e;return e=arguments[0],this._onLinkDown=fm.delegate.remove(this._onLinkDown,e)},s.prototype.removeOnLinkInit=function(){var e;return e=arguments[0],this._onLinkInit=fm.delegate.remove(this._onLinkInit,e)},s.prototype.removeOnLinkReceiveRTCP=function(){var e;return e=arguments[0],this._onLinkReceiveRTCP=fm.delegate.remove(this._onLinkReceiveRTCP,e)},s.prototype.removeOnLinkReceiveRTP=function(){var e;return e=arguments[0],this._onLinkReceiveRTP=fm.delegate.remove(this._onLinkReceiveRTP,e)},s.prototype.removeOnLinkReceiveSCTP=function(){var e;return e=arguments[0],this._onLinkReceiveSCTP=fm.delegate.remove(this._onLinkReceiveSCTP,e)},s.prototype.removeOnLinkUp=function(){var e;return e=arguments[0],this._onLinkUp=fm.delegate.remove(this._onLinkUp,e)},s.prototype.removeOnUnhandledException=function(){var e;return e=arguments[0],this._onUnhandledException=fm.delegate.remove(this._onUnhandledException,e)},s.prototype.setDirection=function(){var e;return e=arguments[0],this._direction=e},s.prototype.setMultiplexRtpRtcp=function(){var e;return e=arguments[0],this._multiplexRtpRtcp=e},s.prototype.setOfferDtls=function(){var e;return e=arguments[0],this._offerDtls=e},s.prototype.setProtocol=function(){var e;return e=arguments[0],this._protocol=e},s.prototype.setType=function(){var e;return e=arguments[0],this._type=e},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.startSuccessArgs=function(n){function s(){this.setSignalProvider=e(this.setSignalProvider,this),this.getSignalProvider=e(this.getSignalProvider,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._signalProvider=null,s.prototype.getSignalProvider=function(){return this._signalProvider},s.prototype.setSignalProvider=function(){var e;return e=arguments[0],this._signalProvider=e},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.startFailureArgs=function(n){function s(){this.setSignalProvider=e(this.setSignalProvider,this),this.setException=e(this.setException,this),this.getSignalProvider=e(this.getSignalProvider,this),this.getException=e(this.getException,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._exception=null,s.prototype._signalProvider=null,s.prototype.getException=function(){return this._exception},s.prototype.getSignalProvider=function(){return this._signalProvider},s.prototype.setException=function(){var e;return e=arguments[0],this._exception=e},s.prototype.setSignalProvider=function(){var e;return e=arguments[0],this._signalProvider=e},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.startCompleteArgs=function(n){function s(){this.setSignalProvider=e(this.setSignalProvider,this),this.getSignalProvider=e(this.getSignalProvider,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._signalProvider=null,s.prototype.getSignalProvider=function(){return this._signalProvider},s.prototype.setSignalProvider=function(){var e;return e=arguments[0],this._signalProvider=e},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.startArgs=function(n){function s(){this.setOnSuccess=e(this.setOnSuccess,this),this.setOnFailure=e(this.setOnFailure,this),this.setOnComplete=e(this.setOnComplete,this),this.getOnSuccess=e(this.getOnSuccess,this),this.getOnFailure=e(this.getOnFailure,this),this.getOnComplete=e(this.getOnComplete,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._onComplete=null,s.prototype._onFailure=null,s.prototype._onSuccess=null,s.prototype.getOnComplete=function(){return this._onComplete},s.prototype.getOnFailure=function(){return this._onFailure},s.prototype.getOnSuccess=function(){return this._onSuccess},s.prototype.setOnComplete=function(){var e;return e=arguments[0],this._onComplete=e},s.prototype.setOnFailure=function(){var e;return e=arguments[0],this._onFailure=e},s.prototype.setOnSuccess=function(){var e;return e=arguments[0],this._onSuccess=e},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.stopSuccessArgs=function(n){function s(){this.setSignalProvider=e(this.setSignalProvider,this),this.getSignalProvider=e(this.getSignalProvider,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._signalProvider=null,s.prototype.getSignalProvider=function(){return this._signalProvider},s.prototype.setSignalProvider=function(){var e;return e=arguments[0],this._signalProvider=e},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.stopFailureArgs=function(n){function s(){this.setSignalProvider=e(this.setSignalProvider,this),this.setException=e(this.setException,this),this.getSignalProvider=e(this.getSignalProvider,this),this.getException=e(this.getException,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._exception=null,s.prototype._signalProvider=null,s.prototype.getException=function(){return this._exception},s.prototype.getSignalProvider=function(){return this._signalProvider},s.prototype.setException=function(){var e;return e=arguments[0],this._exception=e},s.prototype.setSignalProvider=function(){var e;return e=arguments[0],this._signalProvider=e},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.stopCompleteArgs=function(n){function s(){this.setSignalProvider=e(this.setSignalProvider,this),this.getSignalProvider=e(this.getSignalProvider,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._signalProvider=null,s.prototype.getSignalProvider=function(){return this._signalProvider},s.prototype.setSignalProvider=function(){var e;return e=arguments[0],this._signalProvider=e},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.stopArgs=function(n){function s(){this.setOnSuccess=e(this.setOnSuccess,this),this.setOnFailure=e(this.setOnFailure,this),this.setOnComplete=e(this.setOnComplete,this),this.getOnSuccess=e(this.getOnSuccess,this),this.getOnFailure=e(this.getOnFailure,this),this.getOnComplete=e(this.getOnComplete,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._onComplete=null,s.prototype._onFailure=null,s.prototype._onSuccess=null,s.prototype.getOnComplete=function(){return this._onComplete},s.prototype.getOnFailure=function(){return this._onFailure},s.prototype.getOnSuccess=function(){return this._onSuccess},s.prototype.setOnComplete=function(){var e;return e=arguments[0],this._onComplete=e},s.prototype.setOnFailure=function(){var e;return e=arguments[0],this._onFailure=e},s.prototype.setOnSuccess=function(){var e;return e=arguments[0],this._onSuccess=e},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.sendOfferAnswerArgs=function(n){function s(){this.setPeerState=e(this.setPeerState,this),this.setPeerId=e(this.setPeerId,this),this.setOfferAnswer=e(this.setOfferAnswer,this),this.getPeerState=e(this.getPeerState,this),this.getPeerId=e(this.getPeerId,this),this.getOfferAnswer=e(this.getOfferAnswer,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._offerAnswer=null,s.prototype._peerId=null,s.prototype._peerState=null,s.prototype.getOfferAnswer=function(){return this._offerAnswer},s.prototype.getPeerId=function(){return this._peerId},s.prototype.getPeerState=function(){return this._peerState},s.prototype.setOfferAnswer=function(){var e;return e=arguments[0],this._offerAnswer=e},s.prototype.setPeerId=function(){var e;return e=arguments[0],this._peerId=e},s.prototype.setPeerState=function(){var e;return e=arguments[0],this._peerState=e},s}(fm.object);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.sendCandidateArgs=function(n){function s(){this.setPeerState=e(this.setPeerState,this),this.setPeerId=e(this.setPeerId,this),this.setCandidate=e(this.setCandidate,this),this.getPeerState=e(this.getPeerState,this),this.getPeerId=e(this.getPeerId,this),this.getCandidate=e(this.getCandidate,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._candidate=null,s.prototype._peerId=null,s.prototype._peerState=null,s.prototype.getCandidate=function(){return this._candidate},s.prototype.getPeerId=function(){return this._peerId},s.prototype.getPeerState=function(){return this._peerState},s.prototype.setCandidate=function(){var e;return e=arguments[0],this._candidate=e},s.prototype.setPeerId=function(){var e;return e=arguments[0],this._peerId=e},s.prototype.setPeerState=function(){var e;return e=arguments[0],this._peerState=e},s}(fm.object);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.receiveOfferAnswerArgs=function(n){function s(){this.setPeerState=e(this.setPeerState,this),this.setPeerId=e(this.setPeerId,this),this.setOfferAnswer=e(this.setOfferAnswer,this),this.getPeerState=e(this.getPeerState,this),this.getPeerId=e(this.getPeerId,this),this.getOfferAnswer=e(this.getOfferAnswer,this);var t,n,r,i;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):2===arguments.length?(n=arguments[0],r=arguments[1],s.call(this,n,r,null),t):3===arguments.length?(n=arguments[0],r=arguments[1],i=arguments[2],t=s.__super__.constructor.call(this),this.setOfferAnswer(n),this.setPeerId(r),this.setPeerState(i),t):void 0}return t(s,n),s.prototype._offerAnswer=null,s.prototype._peerId=null,s.prototype._peerState=null,s.prototype.getOfferAnswer=function(){return this._offerAnswer},s.prototype.getPeerId=function(){return this._peerId},s.prototype.getPeerState=function(){return this._peerState},s.prototype.setOfferAnswer=function(){var e;return e=arguments[0],this._offerAnswer=e},s.prototype.setPeerId=function(){var e;return e=arguments[0],this._peerId=e},s.prototype.setPeerState=function(){var e;return e=arguments[0],this._peerState=e},s}(fm.object);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.receiveCandidateArgs=function(n){function s(){this.setPeerId=e(this.setPeerId,this),this.setCandidate=e(this.setCandidate,this),this.getPeerId=e(this.getPeerId,this),this.getCandidate=e(this.getCandidate,this);var t,n,r;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(n=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),n):(t=arguments[0],r=arguments[1],n=s.__super__.constructor.call(this),this.setCandidate(t),this.setPeerId(r),n)}return t(s,n),s.prototype._candidate=null,s.prototype._peerId=null,s.prototype.getCandidate=function(){return this._candidate},s.prototype.getPeerId=function(){return this._peerId},s.prototype.setCandidate=function(){var e;return e=arguments[0],this._candidate=e},s.prototype.setPeerId=function(){var e;return e=arguments[0],this._peerId=e},s}(fm.object);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.signalProvider=function(n){function s(){this.stop=e(this.stop,this),this.start=e(this.start,this),this.setConferenceId=e(this.setConferenceId,this),this.sendOfferAnswer=e(this.sendOfferAnswer,this),this.sendCandidate=e(this.sendCandidate,this),this.removeReceivedOfferAnswer=e(this.removeReceivedOfferAnswer,this),this.removeReceivedCandidate=e(this.removeReceivedCandidate,this),this.raiseOfferAnswer=e(this.raiseOfferAnswer,this),this.raiseCandidate=e(this.raiseCandidate,this),this.getConferenceId=e(this.getConferenceId,this),this.addReceivedOfferAnswer=e(this.addReceivedOfferAnswer,this),this.addReceivedCandidate=e(this.addReceivedCandidate,this);var t,n;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(n=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),n):(t=arguments[0],n=s.__super__.constructor.call(this),this.setConferenceId(t),n)}return t(s,n),s.prototype._conferenceId=null,s.prototype._receivedCandidate=null,s.prototype._receivedOfferAnswer=null,s.prototype.addReceivedCandidate=function(){var e;return e=arguments[0],this._receivedCandidate=fm.delegate.combine(this._receivedCandidate,e)},s.prototype.addReceivedOfferAnswer=function(){var e;return e=arguments[0],this._receivedOfferAnswer=fm.delegate.combine(this._receivedOfferAnswer,e)},s.prototype.getConferenceId=function(){return this._conferenceId},s.prototype.raiseCandidate=function(){var e,t;return e=arguments[0],t=this._receivedCandidate,fm.global.equals(t,null)?void 0:t(e)},s.prototype.raiseOfferAnswer=function(){var e,t;return e=arguments[0],t=this._receivedOfferAnswer,fm.global.equals(t,null)?void 0:t(e)},s.prototype.removeReceivedCandidate=function(){var e;return e=arguments[0],this._receivedCandidate=fm.delegate.remove(this._receivedCandidate,e)},s.prototype.removeReceivedOfferAnswer=function(){var e;return e=arguments[0],this._receivedOfferAnswer=fm.delegate.remove(this._receivedOfferAnswer,e)},s.prototype.sendCandidate=function(){var e;return e=arguments[0]},s.prototype.sendOfferAnswer=function(){var e;return e=arguments[0]},s.prototype.setConferenceId=function(){var e;return e=arguments[0],this._conferenceId=e},s.prototype.start=function(){var e;return e=arguments[0]},s.prototype.stop=function(){var e;return e=arguments[0]},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.linkDownArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setTimedOut=e(this.setTimedOut,this),this.setRelayFailureDetected=e(this.setRelayFailureDetected,this),this.setReason=e(this.setReason,this),this.setNewOfferReceived=e(this.setNewOfferReceived,this),this.setIsSwitchingRoles=e(this.setIsSwitchingRoles,this),this.setException=e(this.setException,this),this.setDeadStreamDetected=e(this.setDeadStreamDetected,this),this.getTimedOut=e(this.getTimedOut,this),this.getRelayFailureDetected=e(this.getRelayFailureDetected,this),this.getReason=e(this.getReason,this),this.getNewOfferReceived=e(this.getNewOfferReceived,this),this.getIsSwitchingRoles=e(this.getIsSwitchingRoles,this),this.getException=e(this.getException,this),this.getDeadStreamDetected=e(this.getDeadStreamDetected,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._deadStreamDetected=!1,s.prototype._exception=null,s.prototype._isSwitchingRoles=!1,s.prototype._newOfferReceived=!1,s.prototype._reason=null,s.prototype._relayFailureDetected=!1,s.prototype._timedOut=!1,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeLinkDownArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeLinkDownArgs(e)},s.prototype.getDeadStreamDetected=function(){return this._deadStreamDetected},s.prototype.getException=function(){return this._exception},s.prototype.getIsSwitchingRoles=function(){return this._isSwitchingRoles},s.prototype.getNewOfferReceived=function(){return this._newOfferReceived},s.prototype.getReason=function(){return this._reason},s.prototype.getRelayFailureDetected=function(){return this._relayFailureDetected},s.prototype.getTimedOut=function(){return this._timedOut},s.prototype.setDeadStreamDetected=function(){var e;return e=arguments[0],this._deadStreamDetected=e},s.prototype.setException=function(){var e;return e=arguments[0],this._exception=e},s.prototype.setIsSwitchingRoles=function(){var e;return e=arguments[0],this._isSwitchingRoles=e},s.prototype.setNewOfferReceived=function(){var e;return e=arguments[0],this._newOfferReceived=e},s.prototype.setReason=function(){var e;return e=arguments[0],this._reason=e},s.prototype.setRelayFailureDetected=function(){var e;return e=arguments[0],this._relayFailureDetected=e},s.prototype.setTimedOut=function(){var e;return e=arguments[0],this._timedOut=e},s.prototype.toJson=function(){return fm.icelink.linkDownArgs.toJson(this)},s}(fm.icelink.baseLinkArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.streamLinkDownArgs=function(n){function s(){this.setStreamIndex=e(this.setStreamIndex,this),this.setStream=e(this.setStream,this),this.getStreamIndex=e(this.getStreamIndex,this),this.getStream=e(this.getStream,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._stream=null,s.prototype._streamIndex=0,s.prototype.getStream=function(){return this._stream},s.prototype.getStreamIndex=function(){return this._streamIndex},s.prototype.setStream=function(){var e;return e=arguments[0],this._stream=e},s.prototype.setStreamIndex=function(){var e;return e=arguments[0],this._streamIndex=e},s}(fm.icelink.linkDownArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.linkInitArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setInitiator=e(this.setInitiator,this),this.getInitiator=e(this.getInitiator,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._initiator=!1,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeLinkInitArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeLinkInitArgs(e)},s.prototype.getInitiator=function(){return this._initiator},s.prototype.setInitiator=function(){var e;return e=arguments[0],this._initiator=e},s.prototype.toJson=function(){return fm.icelink.linkInitArgs.toJson(this)},s}(fm.icelink.baseLinkArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.streamLinkInitArgs=function(n){function s(){this.setStreamIndex=e(this.setStreamIndex,this),this.setStream=e(this.setStream,this),this.getStreamIndex=e(this.getStreamIndex,this),this.getStream=e(this.getStream,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._stream=null,s.prototype._streamIndex=0,s.prototype.getStream=function(){return this._stream},s.prototype.getStreamIndex=function(){return this._streamIndex},s.prototype.setStream=function(){var e;return e=arguments[0],this._stream=e},s.prototype.setStreamIndex=function(){var e;return e=arguments[0],this._streamIndex=e},s}(fm.icelink.linkInitArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.linkUpArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setNegotiatedStreams=e(this.setNegotiatedStreams,this),this.getNegotiatedStreams=e(this.getNegotiatedStreams,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._negotiatedStreams=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeLinkUpArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeLinkUpArgs(e)},s.prototype.getNegotiatedStreams=function(){return this._negotiatedStreams},s.prototype.setNegotiatedStreams=function(){var e;return e=arguments[0],this._negotiatedStreams=e},s.prototype.toJson=function(){return fm.icelink.linkUpArgs.toJson(this)},s}(fm.icelink.baseLinkArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.streamLinkUpArgs=function(n){function s(){this.setStreamIndex=e(this.setStreamIndex,this),this.setStream=e(this.setStream,this),this.setNegotiatedStream=e(this.setNegotiatedStream,this),this.getStreamIndex=e(this.getStreamIndex,this),this.getStream=e(this.getStream,this),this.getNegotiatedStream=e(this.getNegotiatedStream,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._negotiatedStream=null,s.prototype._stream=null,s.prototype._streamIndex=0,s.prototype.getNegotiatedStream=function(){return this._negotiatedStream},s.prototype.getStream=function(){return this._stream},s.prototype.getStreamIndex=function(){return this._streamIndex},s.prototype.setNegotiatedStream=function(){var e;return e=arguments[0],this._negotiatedStream=e},s.prototype.setStream=function(){var e;return e=arguments[0],this._stream=e},s.prototype.setStreamIndex=function(){var e;return e=arguments[0],this._streamIndex=e},s}(fm.icelink.linkUpArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.linkOfferAnswerArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setOfferAnswer=e(this.setOfferAnswer,this),this.getOfferAnswer=e(this.getOfferAnswer,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._offerAnswer=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeLinkOfferAnswerArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeLinkOfferAnswerArgs(e)},s.prototype.getOfferAnswer=function(){return this._offerAnswer},s.prototype.setOfferAnswer=function(){var e;return e=arguments[0],this._offerAnswer=e},s.prototype.toJson=function(){return fm.icelink.linkOfferAnswerArgs.toJson(this)},s}(fm.icelink.baseLinkArgs);var t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,
e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.streamLinkReceiveRTCPArgs=function(e){function n(){var e;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(e=n.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),e):e=n.__super__.constructor.call(this)}return t(n,e),n}(fm.icelink.linkReceiveRTCPArgs);var t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.streamLinkReceiveRTPArgs=function(e){function n(){var e;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(e=n.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),e):e=n.__super__.constructor.call(this)}return t(n,e),n}(fm.icelink.linkReceiveRTPArgs);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.conference=function(n){function s(){this.unlinkAll=e(this.unlinkAll,this),this.unlink=e(this.unlink,this),this.timerTimeoutCallback=e(this.timerTimeoutCallback,this),this.setTimeout=e(this.setTimeout,this),this.setSignalProvider=e(this.setSignalProvider,this),this.setRandomizeServers=e(this.setRandomizeServers,this),this.setMaxLinks=e(this.setMaxLinks,this),this.removeTimeoutTimer=e(this.removeTimeoutTimer,this),this.removeOnUnhandledException=e(this.removeOnUnhandledException,this),this.removeOnLinkUp=e(this.removeOnLinkUp,this),this.removeOnLinkReceiveSCTP=e(this.removeOnLinkReceiveSCTP,this),this.removeOnLinkReceiveRTP=e(this.removeOnLinkReceiveRTP,this),this.removeOnLinkReceiveRTCP=e(this.removeOnLinkReceiveRTCP,this),this.removeOnLinkOfferAnswer=e(this.removeOnLinkOfferAnswer,this),this.removeOnLinkLocalAddresses=e(this.removeOnLinkLocalAddresses,this),this.removeOnLinkInit=e(this.removeOnLinkInit,this),this.removeOnLinkDown=e(this.removeOnLinkDown,this),this.removeOnLinkCandidate=e(this.removeOnLinkCandidate,this),this.receiveOfferAnswerCacheLinkCallback=e(this.receiveOfferAnswerCacheLinkCallback,this),this.receiveOfferAnswerCacheLinkAcceptCallback=e(this.receiveOfferAnswerCacheLinkAcceptCallback,this),this.receiveOfferAnswer=e(this.receiveOfferAnswer,this),this.receiveCandidate=e(this.receiveCandidate,this),this.raiseUnhandledException=e(this.raiseUnhandledException,this),this.raiseLinkUp=e(this.raiseLinkUp,this),this.raiseLinkReceiveSCTP=e(this.raiseLinkReceiveSCTP,this),this.raiseLinkReceiveRTP=e(this.raiseLinkReceiveRTP,this),this.raiseLinkReceiveRTCP=e(this.raiseLinkReceiveRTCP,this),this.raiseLinkOfferAnswer=e(this.raiseLinkOfferAnswer,this),this.raiseLinkLocalAddresses=e(this.raiseLinkLocalAddresses,this),this.raiseLinkInit=e(this.raiseLinkInit,this),this.raiseLinkDown=e(this.raiseLinkDown,this),this.raiseLinkCandidate=e(this.raiseLinkCandidate,this),this.processReceivedOfferAnswer=e(this.processReceivedOfferAnswer,this),this.processReceivedCandidate=e(this.processReceivedCandidate,this),this.processOnLinkUp=e(this.processOnLinkUp,this),this.processOnLinkReceiveSCTP=e(this.processOnLinkReceiveSCTP,this),this.processOnLinkReceiveRTP=e(this.processOnLinkReceiveRTP,this),this.processOnLinkReceiveRTCP=e(this.processOnLinkReceiveRTCP,this),this.processOnLinkLocalAddresses=e(this.processOnLinkLocalAddresses,this),this.processOnLinkInit=e(this.processOnLinkInit,this),this.processOnLinkDown=e(this.processOnLinkDown,this),this.processOnLinkCandidate=e(this.processOnLinkCandidate,this),this.performDropLink=e(this.performDropLink,this),this.onlyPrivateCandidateTypes=e(this.onlyPrivateCandidateTypes,this),this.onlyPrivateCandidates=e(this.onlyPrivateCandidates,this),this.onLinkInitialize=e(this.onLinkInitialize,this),this.onCreateSuccess=e(this.onCreateSuccess,this),this.onCreateFailure=e(this.onCreateFailure,this),this.onAcceptFailure=e(this.onAcceptFailure,this),this.linkCacheLinkCallback=e(this.linkCacheLinkCallback,this),this.link=e(this.link,this),this.isPrivate=e(this.isPrivate,this),this.isLinked=e(this.isLinked,this),this.getTimeoutTimer=e(this.getTimeoutTimer,this),this.getTimeout=e(this.getTimeout,this),this.getSignalProvider=e(this.getSignalProvider,this),this.getRandomizeServers=e(this.getRandomizeServers,this),this.getPeerStates=e(this.getPeerStates,this),this.getPeerState=e(this.getPeerState,this),this.getPeerIds=e(this.getPeerIds,this),this.getMaxLinks=e(this.getMaxLinks,this),this.getLinks=e(this.getLinks,this),this.getLink=e(this.getLink,this),this.dropLink=e(this.dropLink,this),this.detachSignalEvents=e(this.detachSignalEvents,this),this.detachEvents=e(this.detachEvents,this),this.createAndSendOffer=e(this.createAndSendOffer,this),this.createAndSendAnswer=e(this.createAndSendAnswer,this),this.createAndSend=e(this.createAndSend,this),this.cacheLink=e(this.cacheLink,this),this.attachSignalEvents=e(this.attachSignalEvents,this),this.attachEvents=e(this.attachEvents,this),this.addTimeoutTimer=e(this.addTimeoutTimer,this),this.addOnUnhandledException=e(this.addOnUnhandledException,this),this.addOnLinkUp=e(this.addOnLinkUp,this),this.addOnLinkReceiveSCTP=e(this.addOnLinkReceiveSCTP,this),this.addOnLinkReceiveRTP=e(this.addOnLinkReceiveRTP,this),this.addOnLinkReceiveRTCP=e(this.addOnLinkReceiveRTCP,this),this.addOnLinkOfferAnswer=e(this.addOnLinkOfferAnswer,this),this.addOnLinkLocalAddresses=e(this.addOnLinkLocalAddresses,this),this.addOnLinkInit=e(this.addOnLinkInit,this),this.addOnLinkDown=e(this.addOnLinkDown,this),this.addOnLinkCandidate=e(this.addOnLinkCandidate,this),this.accept=e(this.accept,this);var t,n,r,i,o;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),this._links={},this._linksLock=new fm.object,this._earlyCandidates={},this._earlyCandidatesLock=new fm.object,this._timeoutTimers={},this._timeoutTimersLock=new fm.object,this._privatePrefixes=["127.","10.","172.16","172.17","172.18","172.19","172.20","172.21","172.22","172.23","172.24","172.25","172.26","172.27","172.28","172.29","172.30","172.31","192.168.","::1","fc","fd"],this.setTimeout(3e4),this._onLinkCandidateEvent=this.processOnLinkCandidate,this._onLinkLocalAddressesEvent=this.processOnLinkLocalAddresses,this._onLinkInitEvent=this.processOnLinkInit,this._onLinkUpEvent=this.processOnLinkUp,this._onLinkDownEvent=this.processOnLinkDown,this._onLinkReceiveRTPEvent=this.processOnLinkReceiveRTP,this._onLinkReceiveRTCPEvent=this.processOnLinkReceiveRTCP,this._onLinkReceiveSCTPEvent=this.processOnLinkReceiveSCTP,this._receivedOfferAnswerEvent=this.processReceivedOfferAnswer,this._receivedCandidateEvent=this.processReceivedCandidate,fm.util.attachProperties(this,arguments[0]),t):1===arguments.length?(o=arguments[0],s.call(this,new Array(0),o),t):2===arguments.length?(r=arguments[0],o=arguments[1],s.call(this),this.setServerAddresses(r),this.setStreams(o),t):3===arguments.length?(n=arguments[0],i=arguments[1],o=arguments[2],s.call(this,[fm.stringExtensions.format("{0}:{1}",n,fm.intExtensions.toString(i))],o),t):0===arguments.length?(t=s.__super__.constructor.call(this),this._links={},this._linksLock=new fm.object,this._earlyCandidates={},this._earlyCandidatesLock=new fm.object,this._timeoutTimers={},this._timeoutTimersLock=new fm.object,this._privatePrefixes=["127.","10.","172.16","172.17","172.18","172.19","172.20","172.21","172.22","172.23","172.24","172.25","172.26","172.27","172.28","172.29","172.30","172.31","192.168.","::1","fc","fd"],this.setTimeout(3e4),this._onLinkCandidateEvent=this.processOnLinkCandidate,this._onLinkLocalAddressesEvent=this.processOnLinkLocalAddresses,this._onLinkInitEvent=this.processOnLinkInit,this._onLinkUpEvent=this.processOnLinkUp,this._onLinkDownEvent=this.processOnLinkDown,this._onLinkReceiveRTPEvent=this.processOnLinkReceiveRTP,this._onLinkReceiveRTCPEvent=this.processOnLinkReceiveRTCP,this._onLinkReceiveSCTPEvent=this.processOnLinkReceiveSCTP,this._receivedOfferAnswerEvent=this.processReceivedOfferAnswer,this._receivedCandidateEvent=this.processReceivedCandidate,t):void 0}return t(s,n),s.prototype.__signalProvider=null,s._callbackKey=null,s.prototype._earlyCandidates=null,s.prototype._earlyCandidatesLock=null,s.prototype._links=null,s.prototype._linksLock=null,s.prototype._maxLinks=0,s.prototype._onLinkCandidate=null,s.prototype._onLinkCandidateEvent=null,s.prototype._onLinkDown=null,s.prototype._onLinkDownEvent=null,s.prototype._onLinkInit=null,s.prototype._onLinkInitEvent=null,s.prototype._onLinkLocalAddresses=null,s.prototype._onLinkLocalAddressesEvent=null,s.prototype._onLinkOfferAnswer=null,s.prototype._onLinkReceiveRTCP=null,s.prototype._onLinkReceiveRTCPEvent=null,s.prototype._onLinkReceiveRTP=null,s.prototype._onLinkReceiveRTPEvent=null,s.prototype._onLinkReceiveSCTP=null,s.prototype._onLinkReceiveSCTPEvent=null,s.prototype._onLinkUp=null,s.prototype._onLinkUpEvent=null,s.prototype._onUnhandledException=null,s._peerIdKey=null,s._peerStateKey=null,s.prototype._privatePrefixes=null,s.prototype._randomizeServers=!1,s.prototype._receivedCandidateEvent=null,s.prototype._receivedOfferAnswerEvent=null,s._stateKey=null,s.prototype._timeout=0,s.prototype._timeoutTimers=null,s.prototype._timeoutTimersLock=null,s.prototype.accept=function(){var e,t,n,s;return t=arguments[0],n=arguments[1],s=arguments[2],e=new fm.icelink.acceptArgs(n),e.setOnSuccess(s),e.setOnFailure(this.onAcceptFailure),t.accept(e)},s.prototype.addOnLinkCandidate=function(){var e;return e=arguments[0],this._onLinkCandidate=fm.delegate.combine(this._onLinkCandidate,e)},s.prototype.addOnLinkDown=function(){var e;return e=arguments[0],this._onLinkDown=fm.delegate.combine(this._onLinkDown,e)},s.prototype.addOnLinkInit=function(){var e;return e=arguments[0],this._onLinkInit=fm.delegate.combine(this._onLinkInit,e)},s.prototype.addOnLinkLocalAddresses=function(){var e;return e=arguments[0],this._onLinkLocalAddresses=fm.delegate.combine(this._onLinkLocalAddresses,e)},s.prototype.addOnLinkOfferAnswer=function(){var e;return e=arguments[0],this._onLinkOfferAnswer=fm.delegate.combine(this._onLinkOfferAnswer,e)},s.prototype.addOnLinkReceiveRTCP=function(){var e;return e=arguments[0],this._onLinkReceiveRTCP=fm.delegate.combine(this._onLinkReceiveRTCP,e)},s.prototype.addOnLinkReceiveRTP=function(){var e;return e=arguments[0],this._onLinkReceiveRTP=fm.delegate.combine(this._onLinkReceiveRTP,e)},s.prototype.addOnLinkReceiveSCTP=function(){var e;return e=arguments[0],this._onLinkReceiveSCTP=fm.delegate.combine(this._onLinkReceiveSCTP,e)},s.prototype.addOnLinkUp=function(){var e;return e=arguments[0],this._onLinkUp=fm.delegate.combine(this._onLinkUp,e)},s.prototype.addOnUnhandledException=function(){var e;return e=arguments[0],this._onUnhandledException=fm.delegate.combine(this._onUnhandledException,e)},s.prototype.addTimeoutTimer=function(){var e,t;return e=arguments[0],t=new fm.timeoutTimer(this.timerTimeoutCallback,e),fm.hashExtensions.containsKey(this._timeoutTimers,e.getPeerId())&&(this._timeoutTimers[e.getPeerId()].stop(),fm.hashExtensions.remove(this._timeoutTimers,e.getPeerId())),this._timeoutTimers[e.getPeerId()]=t,t},s.prototype.attachEvents=function(){var e;return e=arguments[0],e.removeOnCandidate(this._onLinkCandidateEvent),e.removeOnLocalAddresses(this._onLinkLocalAddressesEvent),e.removeOnInit(this._onLinkInitEvent),e.removeOnUp(this._onLinkUpEvent),e.removeOnReceiveRTP(this._onLinkReceiveRTPEvent),e.removeOnReceiveSCTP(this._onLinkReceiveSCTPEvent),e.removeOnReceiveRTCP(this._onLinkReceiveRTCPEvent),e.removeOnDown(this._onLinkDownEvent),e.addOnCandidate(this._onLinkCandidateEvent),e.addOnLocalAddresses(this._onLinkLocalAddressesEvent),e.addOnInit(this._onLinkInitEvent),e.addOnUp(this._onLinkUpEvent),e.addOnReceiveRTP(this._onLinkReceiveRTPEvent),e.addOnReceiveSCTP(this._onLinkReceiveSCTPEvent),e.addOnReceiveRTCP(this._onLinkReceiveRTCPEvent),e.addOnDown(this._onLinkDownEvent)},s.prototype.attachSignalEvents=function(){var e;return e=this.__signalProvider,fm.global.equals(e,null)?void 0:(e.removeReceivedOfferAnswer(this._receivedOfferAnswerEvent),e.removeReceivedCandidate(this._receivedCandidateEvent),e.addReceivedOfferAnswer(this._receivedOfferAnswerEvent),e.addReceivedCandidate(this._receivedCandidateEvent))},s.prototype.cacheLink=function(){var e,t,n,s,r,i,o,a,u,l,c,h,p,g,m;if(r=arguments[0],i=arguments[1],e=arguments[2],c=arguments[3],n=null,this.getMaxLinks()<=0||fm.hashExtensions.getCount(this._links)<this.getMaxLinks()){if(n=new fm.icelink.link,fm.global.equals(r,null)||n.setDynamicValue(fm.icelink.conference._peerIdKey,r),fm.global.equals(i,null)||n.setDynamicValue(fm.icelink.conference._peerStateKey,i),n.setDynamicValue(fm.icelink.conference._callbackKey,e),fm.global.equals(c,null)||n.setDynamicValue(fm.icelink.conference._stateKey,c),l=null,u=null,o=null,a=null,!fm.global.equals(this.getServerAddresses(),null)){for(l=new Array(this.getServerAddresses().length),u=new Array(this.getServerAddresses().length),o=new Array(this.getServerAddresses().length),a=new Array(this.getServerAddresses().length),s=0;s<l.length;)try{l[s]=this.getServerAddresses()[s],u[s]=!fm.global.equals(this.getRelayUsernames(),null)&&s<this.getRelayUsernames().length?this.getRelayUsernames()[s]:"",o[s]=!fm.global.equals(this.getRelayPasswords(),null)&&s<this.getRelayPasswords().length?this.getRelayPasswords()[s]:"",a[s]=!fm.global.equals(this.getRelayRealms(),null)&&s<this.getRelayRealms().length?this.getRelayRealms()[s]:""}finally{s++}if(this.getRandomizeServers()&&l.length>1)for(s=l.length-1;s>0;)try{t=fm.lockedRandomizer.next(s+1),h=l[s],l[s]=l[t],l[t]=h,p=u[s],u[s]=u[t],u[t]=p,g=o[s],o[s]=o[t],o[t]=g,m=a[s],a[s]=a[t],a[t]=m}finally{s--}}n.initialize(l,u,o,a,this.getStreams(),this.onLinkInitialize)}return fm.global.equals(n,null)?e(n,c):void 0},s.prototype.createAndSend=function(){var e,t,n,s,r;return s=arguments[0],n=arguments[1],r=this.addTimeoutTimer(s),this.getTimeout()<0&&fm.log.info("Conference timeout disabled. Link will not time out."),r.start(this.getTimeout()),e=new fm.icelink.createArgs,e.setOnFailure(this.onCreateFailure),e.setOnSuccess(this.onCreateSuccess),t=e,n?s.createOffer(t):s.createAnswer(t)},s.prototype.createAndSendAnswer=function(){var e;return e=arguments[0],this.createAndSend(e,!1)},s.prototype.createAndSendOffer=function(){var e;return e=arguments[0],this.createAndSend(e,!0)},s.prototype.detachEvents=function(){var e;return e=arguments[0],e.removeOnCandidate(this._onLinkCandidateEvent),e.removeOnLocalAddresses(this._onLinkLocalAddressesEvent),e.removeOnInit(this._onLinkInitEvent),e.removeOnUp(this._onLinkUpEvent),e.removeOnReceiveRTP(this._onLinkReceiveRTPEvent),e.removeOnReceiveSCTP(this._onLinkReceiveSCTPEvent),e.removeOnReceiveRTCP(this._onLinkReceiveRTCPEvent),e.removeOnDown(this._onLinkDownEvent)},s.prototype.detachSignalEvents=function(){var e;return e=this.__signalProvider,fm.global.equals(e,null)?void 0:(e.removeReceivedOfferAnswer(this._receivedOfferAnswerEvent),e.removeReceivedCandidate(this._receivedCandidateEvent))},s.prototype.dropLink=function(){var e,t,n,s,r,i,o,a,u,l;return r=arguments[0],n=arguments[1],i=arguments[2],u=arguments[3],e=arguments[4],a=arguments[5],t=arguments[6],o=arguments[7],s=arguments[8],l=this.getTimeoutTimer(r),fm.global.equals(l,null)?this.performDropLink(r,n,i,u,e,a,t,o,s):(this.removeTimeoutTimer(r),u||l.stop()?this.performDropLink(r,n,i,u,e,a,t,o,s):!0)},s.prototype.getLink=function(){var e,t,n,s;return s=arguments[0],n=null,e=new fm.holder(n),t=fm.hashExtensions.tryGetValue(this._links,s,e),n=e.getValue(),t||(n=null),n},s.prototype.getLinks=function(){var e,t,n,s,r;for(r=[],e=fm.hashExtensions.getValues(this._links),t=0,n=e.length;n>t;t++)s=e[t],fm.arrayExtensions.add(r,s);return fm.arrayExtensions.toArray(r)},s.prototype.getMaxLinks=function(){return this._maxLinks},s.prototype.getPeerIds=function(){var e,t,n,s,r,i;for(i=[],r=this.getLinks(),e=r,t=0,n=e.length;n>t;t++)s=e[t],fm.arrayExtensions.add(i,s.getPeerId());return fm.arrayExtensions.toArray(i)},s.prototype.getPeerState=function(){var e,t;return t=arguments[0],e=this.getLink(t),fm.global.equals(e,null)?null:e.getPeerState()},s.prototype.getPeerStates=function(){var e,t,n,s,r,i;for(t={},i=this.getLinks(),e=i,n=0,s=e.length;s>n;n++)r=e[n],t[r.getPeerId()]=r.getPeerState();return t},s.prototype.getRandomizeServers=function(){return this._randomizeServers},s.prototype.getSignalProvider=function(){return this.__signalProvider},s.prototype.getTimeout=function(){return this._timeout},s.prototype.getTimeoutTimer=function(){var e,t,n,s;return n=arguments[0],s=null,e=new fm.holder(s),t=fm.hashExtensions.tryGetValue(this._timeoutTimers,n,e),s=e.getValue(),t||(s=null),s},s.prototype.isLinked=function(){var e;return e=arguments[0],!fm.global.equals(this.getLink(e),null)},s.prototype.isPrivate=function(){var e,t,n,s,r;for(n=arguments[0],e=this._privatePrefixes,t=0,s=e.length;s>t;t++)if(r=e[t],fm.stringExtensions.startsWith(n,r))return!0;return!1},s.prototype.link=function(){var e,t,n;if(3===arguments.length){if(e=arguments[0],t=arguments[1],n=arguments[2],fm.hashExtensions.containsKey(this._links,e)){if(!n)return!1;this.unlink(e,"New link requested.")}return this.cacheLink(e,t,this.linkCacheLinkCallback,null),!0}return 2===arguments.length?(e=arguments[0],t=arguments[1],this.link(e,t,!0)):1===arguments.length?(e=arguments[0],this.link(e,null)):void 0},s.prototype.linkCacheLinkCallback=function(){var e,t;return e=arguments[0],t=arguments[1],fm.global.equals(e,null)?void 0:this.createAndSendOffer(e)},s.prototype.onAcceptFailure=function(){var e;return e=arguments[0],this.dropLink(e.getLink().getPeerId(),e.getException(),null,!1,!1,!1,!1,!1,!1)},s.prototype.onCreateFailure=function(){var e;return e=arguments[0],this.dropLink(e.getLink().getPeerId(),e.getException(),null,!1,!1,!1,!1,!1,!1)},s.prototype.onCreateSuccess=function(){var e,t,n;e=arguments[0];try{return this.raiseLinkOfferAnswer(e.getLink(),e.getOfferAnswer())}catch(t){return n=t,fm.log.error("Could not raise created offer/answer.",n)}finally{}},s.prototype.onLinkInitialize=function(){var e,t,n,s,r,i,o,a,u,l,c,h;if(u=arguments[0],i=fm.global.tryCastString(u.getDynamicValue(fm.icelink.conference._peerIdKey)),c=u.getDynamicValue(fm.icelink.conference._peerStateKey),s=u.getDynamicValue(fm.icelink.conference._callbackKey),u.unsetDynamicValue(fm.icelink.conference._callbackKey),h=u.getDynamicValue(fm.icelink.conference._stateKey),u.setPeerId(i),u.setPeerState(c),u.setConference(this),u.copyFrom(this),this.attachEvents(u),this._links[u.getPeerId()]=u,l=null,e=new fm.holder(l),t=fm.hashExtensions.tryGetValue(this._earlyCandidates,u.getPeerId(),e),l=e.getValue(),t||(l=null),!fm.global.equals(l,null)){for(n=l,o=0,a=n.length;a>o;o++)r=n[o],this.receiveCandidate(r,u.getPeerId());fm.hashExtensions.remove(this._earlyCandidates,u.getPeerId())}return s(u,h)},s.prototype.onlyPrivateCandidates=function(){var e,t,n,s,r,i;for(n=arguments[0],e=n,s=0,r=e.length;r>s;s++){if(t=e[s],!fm.global.equals(t.getType(),fm.icelink.candidateType.Private))return!1;if(i=fm.stringExtensions.split(t.getSdpCandidateAttribute().substring(fm.stringExtensions.indexOf(t.getSdpCandidateAttribute(),"candidate:")+"candidate:".length),[" "])[4],!this.isPrivate(fm.stringExtensions.toLower(i)))return!1}return!0},s.prototype.onlyPrivateCandidateTypes=function(){var e,t,n,s,r;for(t=arguments[0],e=t,n=0,s=e.length;s>n;n++)if(r=e[n],!fm.global.equals(r,fm.icelink.candidateType.Private))return!1;return!0},s.prototype.performDropLink=function(){var e,t,n,s,r,i,o,a,u,l;return i=arguments[0],n=arguments[1],o=arguments[2],l=arguments[3],e=arguments[4],u=arguments[5],t=arguments[6],a=arguments[7],r=arguments[8],s=this.getLink(i),fm.global.equals(s,null)?!1:(fm.hashExtensions.remove(this._links,i),e||s.raiseDown(n,o,l,u,t,a,r),this.detachEvents(s),e||s.close(new fm.icelink.closeArgs(o)),!0)},s.prototype.processOnLinkCandidate=function(){var e,t,n;e=arguments[0];try{return this.raiseLinkCandidate(e)}catch(t){return n=t,fm.log.error("Could not raise link candidate.",n)}finally{}},s.prototype.processOnLinkDown=function(){var e;return e=arguments[0],this.raiseLinkDown(e),this.dropLink(e.getLink().getPeerId(),e.getException(),e.getReason(),!1,!0,e.getIsSwitchingRoles(),e.getDeadStreamDetected(),e.getRelayFailureDetected(),e.getNewOfferReceived())},s.prototype.processOnLinkInit=function(){var e;return e=arguments[0],this.raiseLinkInit(e)},s.prototype.processOnLinkLocalAddresses=function(){var e,t,n;e=arguments[0];try{return this.raiseLinkLocalAddresses(e)}catch(t){return n=t,fm.log.error("Could not raise link local addresses.",n)}finally{}},s.prototype.processOnLinkReceiveRTCP=function(){var e,t,n;e=arguments[0];try{return this.raiseLinkReceiveRTCP(e)}catch(t){return n=t,fm.log.error("Could not raise link-received RTCP packets.",n)}finally{}},s.prototype.processOnLinkReceiveRTP=function(){var e,t,n;e=arguments[0];try{return this.raiseLinkReceiveRTP(e)}catch(t){return n=t,fm.log.error("Could not raise link-received RTP packets.",n)}finally{}},s.prototype.processOnLinkReceiveSCTP=function(){var e,t,n;e=arguments[0];try{return this.raiseLinkReceiveSCTP(e)}catch(t){return n=t,fm.log.error("Could not raise link-received SCTP packets.",n)}finally{}},s.prototype.processOnLinkUp=function(){var e,t;return e=arguments[0],t=this.getTimeoutTimer(e.getLink().getPeerId()),fm.global.equals(t,null)?void 0:(this.removeTimeoutTimer(e.getLink().getPeerId()),t.stop()?this.raiseLinkUp(e):e.getLink().close())},s.prototype.processReceivedCandidate=function(){var e;return e=arguments[0],this.receiveCandidate(e.getCandidate(),e.getPeerId())},s.prototype.processReceivedOfferAnswer=function(){var e;return e=arguments[0],this.receiveOfferAnswer(e.getOfferAnswer(),e.getPeerId(),e.getPeerState())},s.prototype.raiseLinkCandidate=function(){var e,t,n,s,r,i,o,a;if(e=arguments[0],!fm.global.equals(this.getSignalProvider(),null))try{a=new fm.icelink.sendCandidateArgs,a.setCandidate(e.getCandidate()),a.setPeerId(e.getLink().getPeerId()),a.setPeerState(e.getLink().getPeerState()),this.getSignalProvider().sendCandidate(a)}catch(t){r=t,s=r,this.raiseUnhandledException(s)||fm.asyncException.asyncThrow(s,"SignalProvider -> SendOfferAnswer")}finally{}if(e.setConference(this),e.setDynamicProperties(this.getDynamicProperties()),o=this._onLinkCandidate,!fm.global.equals(o,null))try{return o(e)}catch(n){if(i=n,s=i,!this.raiseUnhandledException(s))return fm.asyncException.asyncThrow(s,"Conference -> OnLinkCandidate")}finally{}},s.prototype.raiseLinkDown=function(){var e,t,n,s;if(e=arguments[0],e.setConference(this),e.setDynamicProperties(this.getDynamicProperties()),s=this._onLinkDown,!fm.global.equals(s,null))try{return s(e)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Conference -> OnLinkDown")}finally{}},s.prototype.raiseLinkInit=function(){var e,t,n,s;if(e=arguments[0],e.setConference(this),e.setDynamicProperties(this.getDynamicProperties()),s=this._onLinkInit,!fm.global.equals(s,null))try{return s(e)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Conference -> OnLinkInit")}finally{}},s.prototype.raiseLinkLocalAddresses=function(){var e,t,n,s;if(e=arguments[0],e.setConference(this),e.setDynamicProperties(this.getDynamicProperties()),s=this._onLinkLocalAddresses,!fm.global.equals(s,null))try{return s(e)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Conference -> OnLinkLocalAddresses")}finally{}},s.prototype.raiseLinkOfferAnswer=function(){var e,t,n,s,r,i,o,a,u,l;if(i=arguments[0],o=arguments[1],!fm.global.equals(this.getSignalProvider(),null))try{l=new fm.icelink.sendOfferAnswerArgs,l.setOfferAnswer(o),l.setPeerId(i.getPeerId()),l.setPeerState(i.getPeerState()),this.getSignalProvider().sendOfferAnswer(l)}catch(e){s=e,n=s,this.raiseUnhandledException(n)||fm.asyncException.asyncThrow(n,"SignalProvider -> SendOfferAnswer")}finally{}if(a=this._onLinkOfferAnswer,!fm.global.equals(a,null))try{return u=new fm.icelink.linkOfferAnswerArgs,u.setConference(this),u.setLink(i),u.setOfferAnswer(o),u.setDynamicProperties(this.getDynamicProperties()),a(u)}catch(t){if(r=t,n=r,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Conference -> OnLinkOfferAnswer")}finally{}},s.prototype.raiseLinkReceiveRTCP=function(){var e,t,n,s;if(e=arguments[0],e.setConference(this),e.setDynamicProperties(this.getDynamicProperties()),s=this._onLinkReceiveRTCP,!fm.global.equals(s,null))try{return s(e)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Conference -> OnLinkReceiveRTCP")}finally{}},s.prototype.raiseLinkReceiveRTP=function(){var e,t,n,s;if(e=arguments[0],e.setConference(this),e.setDynamicProperties(this.getDynamicProperties()),s=this._onLinkReceiveRTP,!fm.global.equals(s,null))try{return s(e)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Conference -> OnLinkReceiveRTP")}finally{}},s.prototype.raiseLinkReceiveSCTP=function(){var e,t,n,s;if(e=arguments[0],e.setConference(this),e.setDynamicProperties(this.getDynamicProperties()),s=this._onLinkReceiveSCTP,!fm.global.equals(s,null))try{return s(e)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Conference -> OnLinkReceiveSCTP")}finally{}},s.prototype.raiseLinkUp=function(){var e,t,n,s;if(e=arguments[0],e.setConference(this),e.setDynamicProperties(this.getDynamicProperties()),s=this._onLinkUp,!fm.global.equals(s,null))try{return s(e)}catch(t){if(n=t,!this.raiseUnhandledException(n))return fm.asyncException.asyncThrow(n,"Conference -> OnLinkUp")}finally{}},s.prototype.raiseUnhandledException=function(){var e,t,n,s,r,i;if(n=arguments[0],r=this._onUnhandledException,!fm.global.equals(r,null)){e=new fm.icelink.unhandledExceptionArgs,e.setException(n),i=e;try{r(i)}catch(t){s=t,fm.asyncException.asyncThrow(s,"Conference -> OnUnhandledException")}finally{}return i.getHandled()}return!1},s.prototype.receiveCandidate=function(){var e,t,n,s,r,i;return n=arguments[0],i=arguments[1],s=this.getLink(i),fm.global.equals(s,null)?(r=null,e=new fm.holder(r),t=fm.hashExtensions.tryGetValue(this._earlyCandidates,i,e),r=e.getValue(),t||(r=[],this._earlyCandidates[i]=r),fm.arrayExtensions.add(r,n),fm.log.debug("Candidate cached for future link that does not yet exist.")):s.addRemoteCandidate(n)},s.prototype.receiveOfferAnswer=function(){var e,t,n,s,r;if(3===arguments.length){if(t=arguments[0],n=arguments[1],s=arguments[2],e=this.getLink(n),t.getIsOffer()){if(!fm.global.equals(e,null))if(e.getIsOpened())r="Peer is offering new link.",this.dropLink(n,new Error(r),null,!1,!1,!1,!1,!1,!0);else{if(!fm.global.equals(t.getTieBreaker(),null)&&fm.stringExtensions.compareTo(e.getTieBreaker(),t.getTieBreaker())>0)return fm.log.debug("Competing offer detected/ignored. Other side will switch to answering role."),!1;r="Competing offer detected. Switching to answering role.",this.dropLink(n,new Error(r),r,!1,!1,!0,!1,!1,!1)}this.cacheLink(n,s,this.receiveOfferAnswerCacheLinkCallback,t)}else{if(fm.global.equals(e,null))return fm.log.warn("Answer received, but no link exists!"),!1;this.accept(e,t,null)}return!0}2===arguments.length&&(t=arguments[0],n=arguments[1],this.receiveOfferAnswer(t,n,null))},s.prototype.receiveOfferAnswerCacheLinkAcceptCallback=function(){var e;return e=arguments[0],this.createAndSendAnswer(e.getLink())},s.prototype.receiveOfferAnswerCacheLinkCallback=function(){var e,t,n;return e=arguments[0],n=arguments[1],fm.global.equals(e,null)?void 0:(t=n,this.accept(e,t,this.receiveOfferAnswerCacheLinkAcceptCallback))},s.prototype.removeOnLinkCandidate=function(){var e;return e=arguments[0],this._onLinkCandidate=fm.delegate.remove(this._onLinkCandidate,e)},s.prototype.removeOnLinkDown=function(){var e;return e=arguments[0],this._onLinkDown=fm.delegate.remove(this._onLinkDown,e)},s.prototype.removeOnLinkInit=function(){var e;return e=arguments[0],this._onLinkInit=fm.delegate.remove(this._onLinkInit,e)},s.prototype.removeOnLinkLocalAddresses=function(){var e;return e=arguments[0],this._onLinkLocalAddresses=fm.delegate.remove(this._onLinkLocalAddresses,e)},s.prototype.removeOnLinkOfferAnswer=function(){var e;return e=arguments[0],this._onLinkOfferAnswer=fm.delegate.remove(this._onLinkOfferAnswer,e)},s.prototype.removeOnLinkReceiveRTCP=function(){var e;return e=arguments[0],this._onLinkReceiveRTCP=fm.delegate.remove(this._onLinkReceiveRTCP,e)},s.prototype.removeOnLinkReceiveRTP=function(){var e;return e=arguments[0],this._onLinkReceiveRTP=fm.delegate.remove(this._onLinkReceiveRTP,e)},s.prototype.removeOnLinkReceiveSCTP=function(){var e;return e=arguments[0],this._onLinkReceiveSCTP=fm.delegate.remove(this._onLinkReceiveSCTP,e)},s.prototype.removeOnLinkUp=function(){var e;return e=arguments[0],this._onLinkUp=fm.delegate.remove(this._onLinkUp,e)},s.prototype.removeOnUnhandledException=function(){var e;return e=arguments[0],this._onUnhandledException=fm.delegate.remove(this._onUnhandledException,e)},s.prototype.removeTimeoutTimer=function(){var e;return e=arguments[0],fm.hashExtensions.remove(this._timeoutTimers,e)},s.prototype.setMaxLinks=function(){var e;return e=arguments[0],this._maxLinks=e},s.prototype.setRandomizeServers=function(){var e;return e=arguments[0],this._randomizeServers=e},s.prototype.setSignalProvider=function(){var e;return e=arguments[0],this.detachSignalEvents(),this.__signalProvider=e,this.attachSignalEvents()},s.prototype.setTimeout=function(){var e;return e=arguments[0],this._timeout=e},s.prototype.timerTimeoutCallback=function(){var e,t,n,s,r;return n=arguments[0],t=n,s="Link timed out before a connection could be made.",e=!fm.global.equals(this.getServerAddresses(),null)&&this.getServerAddresses().length>0,t.getReachedPeer()||(r="No SDP messages were received from the signalling server (the peer could not be reached).",fm.log.warn(r),s=fm.stringExtensions.format("{0} {1}",s,r)),t.getReachedServer()||(e?(r="No responses were received from the STUN/TURN server (the server could not be reached).",fm.log.warn(r),s=fm.stringExtensions.format("{0} {1}",s,r)):(r="A STUN/TURN server was not provided - make sure this device has a publicly-accessible IP address.",fm.log.warn(r),s=fm.stringExtensions.format("{0} {1}",s,r))),fm.global.equals(t.getLocalOfferAnswer(),null)&&fm.log.error("A local offer/answer was not created!"),fm.global.equals(t.getRemoteOfferAnswer(),null)&&fm.log.error("A remote offer/answer was not received!"),fm.global.equals(t.getAllLocalCandidates().length,0)?fm.log.error("No local candidates were created!"):this.onlyPrivateCandidateTypes(t.getAllLocalCandidateTypes())&&(this.onlyPrivateCandidates(t.getAllLocalCandidates())?fm.log.error("All local candidates were in the private IP range."):fm.log.warn("All local candidates were private.")),fm.global.equals(t.getAllRemoteCandidates().length,0)?fm.log.error("No remote candidates were received!"):this.onlyPrivateCandidateTypes(t.getAllRemoteCandidateTypes())&&(this.onlyPrivateCandidates(t.getAllRemoteCandidates())?fm.log.error("All remote candidates were in the private IP range."):fm.log.warn("All remote candidates were private.")),this.dropLink(t.getPeerId(),new Error(s),null,!0,!1,!1,!1,!1,!1)},s.prototype.unlink=function(){var e,t,n;return 2===arguments.length?(t=arguments[0],n=arguments[1],e="Unlink invoked.",fm.stringExtensions.isNullOrEmpty(n)||(e=fm.stringExtensions.concat(e," (",n,")")),this.dropLink(t,new Error(e),n,!1,!1,!1,!1,!1,!1)):1===arguments.length?(t=arguments[0],this.unlink(t,null)):void 0},s.prototype.unlinkAll=function(){var e,t,n,s,r,i,o,a,u;if(0===arguments.length)return void this.unlinkAll(null);if(1===arguments.length){for(a=arguments[0],o=[],e=fm.hashExtensions.getKeys(this._links),n=0,r=e.length;r>n;n++)u=e[n],fm.arrayExtensions.add(o,u);for(t=o,s=0,i=t.length;i>s;s++)u=t[s],
this.unlink(u,a)}},s._peerIdKey="fm.icelink.conference.peerId",s._peerStateKey="fm.icelink.conference.peerState",s._callbackKey="fm.icelink.conference.callback",s._stateKey="fm.icelink.conference.state",s}(fm.icelink.baseConference);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.acceptArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setOnSuccess=e(this.setOnSuccess,this),this.setOnFailure=e(this.setOnFailure,this),this.setOnComplete=e(this.setOnComplete,this),this.setOfferAnswer=e(this.setOfferAnswer,this),this.getOnSuccess=e(this.getOnSuccess,this),this.getOnFailure=e(this.getOnFailure,this),this.getOnComplete=e(this.getOnComplete,this),this.getOfferAnswer=e(this.getOfferAnswer,this);var t,n;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):(n=arguments[0],t=s.__super__.constructor.call(this),this.setOfferAnswer(n),t)}return t(s,n),s.prototype.__offerAnswer=null,s.prototype._onComplete=null,s.prototype._onFailure=null,s.prototype._onSuccess=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeAcceptArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeAcceptArgs(e)},s.prototype.getOfferAnswer=function(){return this.__offerAnswer},s.prototype.getOnComplete=function(){return this._onComplete},s.prototype.getOnFailure=function(){return this._onFailure},s.prototype.getOnSuccess=function(){return this._onSuccess},s.prototype.setOfferAnswer=function(){var e;if(e=arguments[0],fm.global.equals(e,null))throw new Error("Offer/answer cannot be null.");return this.__offerAnswer=e},s.prototype.setOnComplete=function(){var e;return e=arguments[0],this._onComplete=e},s.prototype.setOnFailure=function(){var e;return e=arguments[0],this._onFailure=e},s.prototype.setOnSuccess=function(){var e;return e=arguments[0],this._onSuccess=e},s.prototype.toJson=function(){return fm.icelink.acceptArgs.toJson(this)},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.acceptCompleteArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setOfferAnswer=e(this.setOfferAnswer,this),this.setLink=e(this.setLink,this),this.getOfferAnswer=e(this.getOfferAnswer,this),this.getLink=e(this.getLink,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._link=null,s.prototype._offerAnswer=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeAcceptCompleteArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeAcceptCompleteArgs(e)},s.prototype.getLink=function(){return this._link},s.prototype.getOfferAnswer=function(){return this._offerAnswer},s.prototype.setLink=function(){var e;return e=arguments[0],this._link=e},s.prototype.setOfferAnswer=function(){var e;return e=arguments[0],this._offerAnswer=e},s.prototype.toJson=function(){return fm.icelink.acceptCompleteArgs.toJson(this)},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.acceptFailureArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setOfferAnswer=e(this.setOfferAnswer,this),this.setLink=e(this.setLink,this),this.setException=e(this.setException,this),this.getOfferAnswer=e(this.getOfferAnswer,this),this.getLink=e(this.getLink,this),this.getException=e(this.getException,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._exception=null,s.prototype._link=null,s.prototype._offerAnswer=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeAcceptFailureArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeAcceptFailureArgs(e)},s.prototype.getException=function(){return this._exception},s.prototype.getLink=function(){return this._link},s.prototype.getOfferAnswer=function(){return this._offerAnswer},s.prototype.setException=function(){var e;return e=arguments[0],this._exception=e},s.prototype.setLink=function(){var e;return e=arguments[0],this._link=e},s.prototype.setOfferAnswer=function(){var e;return e=arguments[0],this._offerAnswer=e},s.prototype.toJson=function(){return fm.icelink.acceptFailureArgs.toJson(this)},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.acceptSuccessArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setOfferAnswer=e(this.setOfferAnswer,this),this.setLink=e(this.setLink,this),this.getOfferAnswer=e(this.getOfferAnswer,this),this.getLink=e(this.getLink,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._link=null,s.prototype._offerAnswer=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeAcceptSuccessArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeAcceptSuccessArgs(e)},s.prototype.getLink=function(){return this._link},s.prototype.getOfferAnswer=function(){return this._offerAnswer},s.prototype.setLink=function(){var e;return e=arguments[0],this._link=e},s.prototype.setOfferAnswer=function(){var e;return e=arguments[0],this._offerAnswer=e},s.prototype.toJson=function(){return fm.icelink.acceptSuccessArgs.toJson(this)},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.createCompleteArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setLink=e(this.setLink,this),this.getLink=e(this.getLink,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._link=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeCreateCompleteArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeCreateCompleteArgs(e)},s.prototype.getLink=function(){return this._link},s.prototype.setLink=function(){var e;return e=arguments[0],this._link=e},s.prototype.toJson=function(){return fm.icelink.createCompleteArgs.toJson(this)},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.createFailureArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setLink=e(this.setLink,this),this.setException=e(this.setException,this),this.getLink=e(this.getLink,this),this.getException=e(this.getException,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._exception=null,s.prototype._link=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeCreateFailureArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeCreateFailureArgs(e)},s.prototype.getException=function(){return this._exception},s.prototype.getLink=function(){return this._link},s.prototype.setException=function(){var e;return e=arguments[0],this._exception=e},s.prototype.setLink=function(){var e;return e=arguments[0],this._link=e},s.prototype.toJson=function(){return fm.icelink.createFailureArgs.toJson(this)},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.createSuccessArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setOfferAnswer=e(this.setOfferAnswer,this),this.setLink=e(this.setLink,this),this.getOfferAnswer=e(this.getOfferAnswer,this),this.getLink=e(this.getLink,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._link=null,s.prototype._offerAnswer=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeCreateSuccessArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeCreateSuccessArgs(e)},s.prototype.getLink=function(){return this._link},s.prototype.getOfferAnswer=function(){return this._offerAnswer},s.prototype.setLink=function(){var e;return e=arguments[0],this._link=e},s.prototype.setOfferAnswer=function(){var e;return e=arguments[0],this._offerAnswer=e},s.prototype.toJson=function(){return fm.icelink.createSuccessArgs.toJson(this)},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.candidate=function(n){function s(){this.toJson=e(this.toJson,this),this.setSdpMediaIndex=e(this.setSdpMediaIndex,this),this.setSdpCandidateAttribute=e(this.setSdpCandidateAttribute,this),this.getType=e(this.getType,this),this.getSdpMediaIndex=e(this.getSdpMediaIndex,this),this.getSdpCandidateAttribute=e(this.getSdpCandidateAttribute,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.__hostTypePreference=0,s.__peerReflexiveTypePreference=0,s.__relayTypePreference=0,s.prototype.__sdpCandidateAttribute=null,s.__serverReflexiveTypePreference=0,s.prototype._sdpMediaIndex=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeCandidate(e)},s.fromJsonMultiple=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeCandidateArray(e)},s.getHostTypePreference=function(){return fm.icelink.candidate.__hostTypePreference},s.getPeerReflexiveTypePreference=function(){return fm.icelink.candidate.__peerReflexiveTypePreference},s.getRelayTypePreference=function(){return fm.icelink.candidate.__relayTypePreference},s.getServerReflexiveTypePreference=function(){return fm.icelink.candidate.__serverReflexiveTypePreference},s.modeFromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeCandidateMode(e)},s.modesFromJsonMultiple=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeCandidateModeArray(e)},s.modesToJsonMultiple=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeCandidateModeArray(e)},s.modeToJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeCandidateMode(e)},s.setHostTypePreference=function(){var e;return e=arguments[0],s.__hostTypePreference=e},s.setPeerReflexiveTypePreference=function(){var e;return e=arguments[0],s.__peerReflexiveTypePreference=e},s.setRelayTypePreference=function(){var e;return e=arguments[0],s.__relayTypePreference=e},s.setServerReflexiveTypePreference=function(){var e;return e=arguments[0],s.__serverReflexiveTypePreference=e},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeCandidate(e)},s.toJsonMultiple=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeCandidateArray(e)},s.typeFromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeCandidateType(e)},s.typesFromJsonMultiple=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeCandidateTypeArray(e)},s.typesToJsonMultiple=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeCandidateTypeArray(e)},s.typeToJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeCandidateType(e)},s.prototype.getSdpCandidateAttribute=function(){return this.__sdpCandidateAttribute},s.prototype.getSdpMediaIndex=function(){return this._sdpMediaIndex},s.prototype.getType=function(){var e;if(e=this.getSdpCandidateAttribute(),!fm.global.equals(e,null)){if(fm.stringExtensions.indexOf(e,"typ host")>=0)return fm.icelink.candidateType.Private;if(fm.stringExtensions.indexOf(e,"typ srflx")>=0||fm.stringExtensions.indexOf(e,"typ prflx")>=0)return fm.icelink.candidateType.Public;if(fm.stringExtensions.indexOf(e,"typ relay")>=0)return fm.icelink.candidateType.Relay}return fm.icelink.candidateType.Private},s.prototype.setSdpCandidateAttribute=function(){var e;return e=arguments[0],fm.stringExtensions.startsWith(e,"a=")||(e=fm.stringExtensions.concat("a=",e)),this.__sdpCandidateAttribute=e},s.prototype.setSdpMediaIndex=function(){var e;return e=arguments[0],this._sdpMediaIndex=e},s.prototype.toJson=function(){return fm.icelink.candidate.toJson(this)},s.__hostTypePreference=126,s.__serverReflexiveTypePreference=100,s.__peerReflexiveTypePreference=110,s.__relayTypePreference=0,s}(fm.object);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.offerAnswer=function(n){function s(){this.toJson=e(this.toJson,this),this.setTieBreaker=e(this.setTieBreaker,this),this.setSdpMessage=e(this.setSdpMessage,this),this.setIsOffer=e(this.setIsOffer,this),this.getTieBreaker=e(this.getTieBreaker,this),this.getSdpMessage=e(this.getSdpMessage,this),this.getIsOffer=e(this.getIsOffer,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._isOffer=!1,s.prototype._sdpMessage=null,s.prototype._tieBreaker=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeOfferAnswer(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeOfferAnswer(e)},s.prototype.getIsOffer=function(){return this._isOffer},s.prototype.getSdpMessage=function(){return this._sdpMessage},s.prototype.getTieBreaker=function(){return this._tieBreaker},s.prototype.setIsOffer=function(){var e;return e=arguments[0],this._isOffer=e},s.prototype.setSdpMessage=function(){var e;return e=arguments[0],this._sdpMessage=e},s.prototype.setTieBreaker=function(){var e;return e=arguments[0],this._tieBreaker=e},s.prototype.toJson=function(){return fm.icelink.offerAnswer.toJson(this)},s}(fm.object);var t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.serializer=function(e){function n(){var e;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(e=n.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),e):e=n.__super__.constructor.call(this)}return t(n,e),n.acceptAcceptArgs=function(){return new fm.icelink.acceptArgs(new fm.icelink.offerAnswer)},n.acceptAcceptCompleteArgs=function(){return new fm.icelink.acceptCompleteArgs},n.acceptAcceptFailureArgs=function(){return new fm.icelink.acceptFailureArgs},n.acceptAcceptSuccessArgs=function(){return new fm.icelink.acceptSuccessArgs},n.closeCloseArgs=function(){return new fm.icelink.closeArgs},n.closeCloseCompleteArgs=function(){return new fm.icelink.closeCompleteArgs},n.createCandidate=function(){return new fm.icelink.candidate},n.createCompleteCreateCompleteArgs=function(){return new fm.icelink.createCompleteArgs},n.createCreateArgs=function(){return new fm.icelink.createArgs},n.createCreateFailureArgs=function(){return new fm.icelink.createFailureArgs},n.createCreateSuccessArgs=function(){return new fm.icelink.createSuccessArgs},n.createLinkCandidateArgs=function(){return new fm.icelink.linkCandidateArgs},n.createLinkDownArgs=function(){return new fm.icelink.linkDownArgs},n.createLinkInitArgs=function(){return new fm.icelink.linkInitArgs},n.createLinkOfferAnswerArgs=function(){return new fm.icelink.linkOfferAnswerArgs},n.createLinkUpArgs=function(){return new fm.icelink.linkUpArgs},n.createOfferAnswer=function(){return new fm.icelink.offerAnswer},n.createStream=function(){return new fm.icelink.stream},n.createStreamFormat=function(){return new fm.icelink.streamFormat},n.deserializeAcceptArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.acceptAcceptArgs,n.deserializeAcceptArgsCallback)},n.deserializeAcceptArgsCallback=function(){var e,t,n,s;return e=arguments[0],t=arguments[1],s=arguments[2],n=t,!fm.global.equals(n,null)&&fm.global.equals(n,"offerAnswer")?e.setOfferAnswer(fm.icelink.offerAnswer.fromJson(s)):void 0},n.deserializeAcceptCompleteArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.acceptAcceptCompleteArgs,n.deserializeAcceptCompleteArgsCallback)},n.deserializeAcceptCompleteArgsCallback=function(){var e,t,n,s;return e=arguments[0],t=arguments[1],s=arguments[2],n=t,!fm.global.equals(n,null)&&fm.global.equals(n,"offerAnswer")?e.setOfferAnswer(fm.icelink.offerAnswer.fromJson(s)):void 0},n.deserializeAcceptFailureArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.acceptAcceptFailureArgs,n.deserializeAcceptFailureArgsCallback)},n.deserializeAcceptFailureArgsCallback=function(){var e,t,n,s;if(e=arguments[0],t=arguments[1],s=arguments[2],n=t,!fm.global.equals(n,null)){if(fm.global.equals(n,"offerAnswer"))return e.setOfferAnswer(fm.icelink.offerAnswer.fromJson(s));if(fm.global.equals(n,"exceptionMessage"))return e.setException(new Error(fm.serializer.deserializeString(s)))}},n.deserializeAcceptSuccessArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.acceptAcceptSuccessArgs,n.deserializeAcceptSuccessArgsCallback)},n.deserializeAcceptSuccessArgsCallback=function(){var e,t,n,s;return e=arguments[0],t=arguments[1],s=arguments[2],n=t,!fm.global.equals(n,null)&&fm.global.equals(n,"offerAnswer")?e.setOfferAnswer(fm.icelink.offerAnswer.fromJson(s)):void 0},n.deserializeCandidate=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createCandidate,n.deserializeCandidateCallback)},n.deserializeCandidateArray=function(){var e,t;return e=arguments[0],t=fm.serializer.deserializeObjectArray(e,n.createCandidate,n.deserializeCandidateCallback),fm.global.equals(t,null)?null:fm.arrayExtensions.toArray(t)},n.deserializeCandidateCallback=function(){var e,t,n,s,r;if(e=arguments[0],t=arguments[1],r=arguments[2],s=t,!fm.global.equals(s,null))if(fm.global.equals(s,"sdpCandidateAttribute")){if(n=fm.serializer.deserializeString(r),!fm.global.equals(n,null))return fm.stringExtensions.startsWith(n,"a=")||(n=fm.stringExtensions.concat("a=",n)),e.setSdpCandidateAttribute(n)}else if(fm.global.equals(s,"sdpMediaIndex"))return e.setSdpMediaIndex(fm.serializer.deserializeInteger(r))},n.deserializeCandidateMode=function(){var e;switch(e=arguments[0],fm.serializer.deserializeString(e)){case"early":return fm.icelink.candidateMode.Early;case"late":return fm.icelink.candidateMode.Late}throw new Error("Unknown candidate mode.")},n.deserializeCandidateModeArray=function(){var e,t,n,s;if(e=arguments[0],fm.stringExtensions.isNullOrEmpty(e)||fm.global.equals(e,"null")||e.length<2||!fm.global.equals(e.charAt(0),"[")||!fm.global.equals(e.charAt(e.length-1),"]"))return null;for(e=fm.stringExtensions.substring(e,1,e.length-2),s=fm.stringExtensions.split(e,[","]),n=new Array(s.length),t=0;t<s.length;)try{n[t]=fm.icelink.serializer.deserializeCandidateMode(s[t])}finally{t++}return n},n.deserializeCandidateType=function(){var e;switch(e=arguments[0],fm.serializer.deserializeString(e)){case"private":return fm.icelink.candidateType.Private;case"public":return fm.icelink.candidateType.Public;case"relay":return fm.icelink.candidateType.Relay}throw new Error("Unknown candidate type.")},n.deserializeCandidateTypeArray=function(){var e,t,n,s;if(e=arguments[0],fm.stringExtensions.isNullOrEmpty(e)||fm.global.equals(e,"null")||e.length<2||!fm.global.equals(e.charAt(0),"[")||!fm.global.equals(e.charAt(e.length-1),"]"))return null;for(e=fm.stringExtensions.substring(e,1,e.length-2),n=fm.stringExtensions.split(e,[","]),s=new Array(n.length),t=0;t<n.length;)try{s[t]=fm.icelink.serializer.deserializeCandidateType(n[t])}finally{t++}return s},n.deserializeCloseArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.closeCloseArgs,n.deserializeCloseArgsCallback)},n.deserializeCloseArgsCallback=function(){var e,t,n,s;return e=arguments[0],t=arguments[1],s=arguments[2],n=t,!fm.global.equals(n,null)&&fm.global.equals(n,"reason")?e.setReason(fm.serializer.deserializeString(s)):void 0},n.deserializeCloseCompleteArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.closeCloseCompleteArgs,n.deserializeCloseCompleteArgsCallback)},n.deserializeCloseCompleteArgsCallback=function(){var e,t,n,s;if(e=arguments[0],t=arguments[1],s=arguments[2],n=t,!fm.global.equals(n,null)){if(fm.global.equals(n,"reason"))return e.setReason(fm.serializer.deserializeString(s));if(fm.global.equals(n,"exceptionMessage"))return e.setException(new Error(fm.serializer.deserializeString(s)))}},n.deserializeCreateArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createCreateArgs,n.deserializeCreateArgsCallback)},n.deserializeCreateArgsCallback=function(){var e,t,n;return e=arguments[0],t=arguments[1],n=arguments[2]},n.deserializeCreateCompleteArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createCompleteCreateCompleteArgs,n.deserializeCreateCompleteArgsCallback)},n.deserializeCreateCompleteArgsCallback=function(){var e,t,n;return e=arguments[0],t=arguments[1],n=arguments[2]},n.deserializeCreateFailureArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createCreateFailureArgs,n.deserializeCreateFailureArgsCallback)},n.deserializeCreateFailureArgsCallback=function(){var e,t,n,s;return e=arguments[0],t=arguments[1],s=arguments[2],n=t,!fm.global.equals(n,null)&&fm.global.equals(n,"exceptionMessage")?e.setException(new Error(fm.serializer.deserializeString(s))):void 0},n.deserializeCreateSuccessArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createCreateSuccessArgs,n.deserializeCreateSuccessArgsCallback)},n.deserializeCreateSuccessArgsCallback=function(){var e,t,n,s;return e=arguments[0],t=arguments[1],s=arguments[2],n=t,!fm.global.equals(n,null)&&fm.global.equals(n,"offerAnswer")?e.setOfferAnswer(fm.icelink.offerAnswer.fromJson(s)):void 0},n.deserializeEncryptionMode=function(){var e;switch(e=arguments[0],fm.serializer.deserializeString(e)){case"aes128Strong":return fm.icelink.encryptionMode.Default;case"aes128Weak":return fm.icelink.encryptionMode.Aes128Weak;case"null":return fm.icelink.encryptionMode.Null;case"nullStrong":return fm.icelink.encryptionMode.NullStrong;case"nullWeak":return fm.icelink.encryptionMode.NullWeak}throw new Error("Unknown encryption mode.")},n.deserializeEncryptionModeArray=function(){var e,t,n,s;if(e=arguments[0],fm.stringExtensions.isNullOrEmpty(e)||fm.global.equals(e,"null")||e.length<2||!fm.global.equals(e.charAt(0),"[")||!fm.global.equals(e.charAt(e.length-1),"]"))return null;for(e=fm.stringExtensions.substring(e,1,e.length-2),s=fm.stringExtensions.split(e,[","]),n=new Array(s.length),t=0;t<s.length;)try{n[t]=fm.icelink.serializer.deserializeEncryptionMode(s[t])}finally{t++}return n},n.deserializeEncryptionRole=function(){var e;switch(e=arguments[0],fm.serializer.deserializeString(e)){case"active":return fm.icelink.encryptionRole.Active;case"actpass":return fm.icelink.encryptionRole.Default;case"passive":return fm.icelink.encryptionRole.Passive}throw new Error("Unknown encryption role.")},n.deserializeEncryptionRoleArray=function(){var e,t,n,s;if(e=arguments[0],fm.stringExtensions.isNullOrEmpty(e)||fm.global.equals(e,"null")||e.length<2||!fm.global.equals(e.charAt(0),"[")||!fm.global.equals(e.charAt(e.length-1),"]"))return null;for(e=fm.stringExtensions.substring(e,1,e.length-2),s=fm.stringExtensions.split(e,[","]),n=new Array(s.length),t=0;t<s.length;)try{n[t]=fm.icelink.serializer.deserializeEncryptionRole(s[t])}finally{t++}return n},n.deserializeLinkCandidateArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createLinkCandidateArgs,n.deserializeLinkCandidateArgsCallback)},n.deserializeLinkCandidateArgsCallback=function(){var e,t,n,s;return e=arguments[0],t=arguments[1],s=arguments[2],n=t,!fm.global.equals(n,null)&&fm.global.equals(n,"candidate")?e.setCandidate(fm.icelink.candidate.fromJson(s)):void 0},n.deserializeLinkDownArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createLinkDownArgs,n.deserializeLinkDownArgsCallback)},n.deserializeLinkDownArgsCallback=function(){var e,t,n,s,r,i,o,a,u;if(e=arguments[0],t=arguments[1],u=arguments[2],a=t,!fm.global.equals(a,null)){if(fm.global.equals(a,"exceptionMessage"))return e.setException(new Error(fm.serializer.deserializeString(u)));if(fm.global.equals(a,"timedOut")){if(n=fm.serializer.deserializeBoolean(u),null!==n)return e.setTimedOut(n)}else if(fm.global.equals(a,"isSwitchingRoles")){if(s=fm.serializer.deserializeBoolean(u),null!==s)return e.setIsSwitchingRoles(s)}else if(fm.global.equals(a,"deadStreamDetected")){if(r=fm.serializer.deserializeBoolean(u),null!==r)return e.setDeadStreamDetected(r)}else if(fm.global.equals(a,"relayFailureDetected")){if(i=fm.serializer.deserializeBoolean(u),null!==i)return e.setRelayFailureDetected(i)}else if(fm.global.equals(a,"newOfferReceived")&&(o=fm.serializer.deserializeBoolean(u),null!==o))return e.setNewOfferReceived(o)}},n.deserializeLinkInitArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createLinkInitArgs,n.deserializeLinkInitArgsCallback)},n.deserializeLinkInitArgsCallback=function(){var e,t,n,s,r;return e=arguments[0],t=arguments[1],r=arguments[2],s=t,!fm.global.equals(s,null)&&fm.global.equals(s,"initiator")&&(n=fm.serializer.deserializeBoolean(r),null!==n)?e.setInitiator(n):void 0},n.deserializeLinkOfferAnswerArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createLinkOfferAnswerArgs,n.deserializeLinkOfferAnswerArgsCallback)},n.deserializeLinkOfferAnswerArgsCallback=function(){var e,t,n,s;return e=arguments[0],t=arguments[1],s=arguments[2],n=t,!fm.global.equals(n,null)&&fm.global.equals(n,"offerAnswer")?e.setOfferAnswer(fm.icelink.offerAnswer.fromJson(s)):void 0},n.deserializeLinkUpArgs=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createLinkUpArgs,n.deserializeLinkUpArgsCallback)},n.deserializeLinkUpArgsCallback=function(){var e,t,n;return e=arguments[0],t=arguments[1],n=arguments[2]},n.deserializeOfferAnswer=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createOfferAnswer,n.deserializeOfferAnswerCallback)},n.deserializeOfferAnswerCallback=function(){var e,t,n,s;if(t=arguments[0],e=arguments[1],s=arguments[2],n=e,!fm.global.equals(n,null)){if(fm.global.equals(n,"sdpMessage"))return t.setSdpMessage(fm.serializer.deserializeString(s));if(fm.global.equals(n,"tieBreaker"))return t.setTieBreaker(fm.serializer.deserializeString(s));if(fm.global.equals(n,"isOffer"))return t.setIsOffer(fm.global.equals(fm.serializer.deserializeBoolean(s),!0))}},n.deserializeProtocol=function(){var e;switch(e=arguments[0],fm.serializer.deserializeString(e)){case"rtp":return fm.icelink.streamProtocol.Rtp;case"sctp":return fm.icelink.streamProtocol.Sctp}throw new Error("Unknown stream protocol.")},n.deserializeRtpMode=function(){var e;switch(e=arguments[0],fm.serializer.deserializeString(e)){case"basic":return fm.icelink.rtpMode.Basic;case"extended":return fm.icelink.rtpMode.Extended}throw new Error("Unknown RTP mode.")},n.deserializeStream=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createStream,n.deserializeStreamCallback)},n.deserializeStreamArray=function(){var e,t;return t=arguments[0],e=fm.serializer.deserializeObjectArrayFast(t,n.createStream,n.deserializeStreamCallback),fm.global.equals(e,null)?null:fm.arrayExtensions.toArray(e)},n.deserializeStreamCallback=function(){var e,t,n;switch(t=arguments[0],e=arguments[1],n=arguments[2],e){case"type":t.setType(fm.icelink.serializer.deserializeStreamType(n));break;case"protocol":t.setProtocol(fm.icelink.serializer.deserializeProtocol(n));break;case"rtpMode":t.setRtpMode(fm.icelink.serializer.deserializeRtpMode(n));break;case"offerDtls":t.setOfferDtls(fm.serializer.deserializeBoolean(n));break;case"multiplexRtpRtcp":t.setMultiplexRtpRtcp(fm.serializer.deserializeBoolean(n));break;case"encryptionModes":t.setEncryptionModes(fm.icelink.serializer.deserializeEncryptionModeArray(n));break;case"formats":t.setFormats(fm.icelink.serializer.deserializeStreamFormatArray(n));break;case"maxQueuedPackets":t.setMaxQueuedPackets(fm.serializer.deserializeInteger(n));break;case"encryptionRole":t.setEncryptionRole(fm.icelink.serializer.deserializeEncryptionRole(n))}},n.deserializeStreamFormat=function(){var e;return e=arguments[0],fm.serializer.deserializeObject(e,n.createStreamFormat,n.deserializeStreamFormatCallback)},n.deserializeStreamFormatArray=function(){var e,t;return t=arguments[0],e=fm.serializer.deserializeObjectArrayFast(t,n.createStreamFormat,n.deserializeStreamFormatCallback),fm.global.equals(e,null)?null:fm.arrayExtensions.toArray(e)},n.deserializeStreamFormatCallback=function(){var e,t,n,s;if(n=arguments[0],e=arguments[1],s=arguments[2],t=e,!fm.global.equals(t,null)){if(fm.global.equals(t,"payloadType"))return n.setPayloadType(fm.serializer.deserializeInteger(s));if(fm.global.equals(t,"encodingName"))return n.setEncodingName(fm.serializer.deserializeString(s));if(fm.global.equals(t,"clockRate"))return n.setClockRate(fm.serializer.deserializeInteger(s));if(fm.global.equals(t,"encodingParameters"))return n.setEncodingParameters(fm.serializer.deserializeString(s))}},n.deserializeStreamType=function(){var e;switch(e=arguments[0],fm.serializer.deserializeString(e)){case"application":return fm.icelink.streamType.Application;case"audio":return fm.icelink.streamType.Audio;case"message":return fm.icelink.streamType.Message;case"text":return fm.icelink.streamType.Text;case"video":return fm.icelink.streamType.Video}throw new Error("Unknown stream type.")},n.deserializeStreamTypeArray=function(){var e,t,n,s;if(n=arguments[0],fm.stringExtensions.isNullOrEmpty(n)||fm.global.equals(n,"null")||n.length<2||!fm.global.equals(n.charAt(0),"[")||!fm.global.equals(n.charAt(n.length-1),"]"))return null;
for(n=fm.stringExtensions.substring(n,1,n.length-2),t=fm.stringExtensions.split(n,[","]),s=new Array(t.length),e=0;e<t.length;)try{s[e]=fm.icelink.serializer.deserializeStreamType(t[e])}finally{e++}return s},n.serializeAcceptArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeAcceptArgsCallback)},n.serializeAcceptArgsCallback=function(){var e,t;return e=arguments[0],t=arguments[1],fm.global.equals(e.getOfferAnswer(),null)?void 0:t.offerAnswer=fm.icelink.offerAnswer.toJson(e.getOfferAnswer())},n.serializeAcceptCompleteArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeAcceptCompleteArgsCallback)},n.serializeAcceptCompleteArgsCallback=function(){var e,t;return e=arguments[0],t=arguments[1],fm.global.equals(e.getOfferAnswer(),null)?void 0:t.offerAnswer=fm.icelink.offerAnswer.toJson(e.getOfferAnswer())},n.serializeAcceptFailureArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeAcceptFailureArgsCallback)},n.serializeAcceptFailureArgsCallback=function(){var e,t;return e=arguments[0],t=arguments[1],fm.global.equals(e.getOfferAnswer(),null)||(t.offerAnswer=fm.icelink.offerAnswer.toJson(e.getOfferAnswer())),fm.global.equals(e.getException(),null)?void 0:t.exceptionMessage=fm.serializer.serializeString(e.getException().message)},n.serializeAcceptSuccessArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeAcceptSuccessArgsCallback)},n.serializeAcceptSuccessArgsCallback=function(){var e,t;return e=arguments[0],t=arguments[1],fm.global.equals(e.getOfferAnswer(),null)?void 0:t.offerAnswer=fm.icelink.offerAnswer.toJson(e.getOfferAnswer())},n.serializeCandidate=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeCandidateCallback)},n.serializeCandidateArray=function(){var e;return e=arguments[0],fm.serializer.serializeObjectArray(e,n.serializeCandidateCallback)},n.serializeCandidateCallback=function(){var e,t,n;return e=arguments[0],t=arguments[1],n=e.getSdpCandidateAttribute(),fm.global.equals(n,null)||(fm.stringExtensions.startsWith(n,"a=")||(n=fm.stringExtensions.concat("a=",n)),t.sdpCandidateAttribute=fm.serializer.serializeString(n)),t.sdpMediaIndex=fm.serializer.serializeInteger(e.getSdpMediaIndex())},n.serializeCandidateMode=function(){var e,t;switch(e=arguments[0],t=null,e){case fm.icelink.candidateMode.Early:t="early";break;case fm.icelink.candidateMode.Late:t="late"}return fm.serializer.serializeString(t)},n.serializeCandidateModeArray=function(){var e,t,n;for(e=arguments[0],n=new Array(e.length),t=0;t<e.length;)try{n[t]=fm.icelink.serializer.serializeCandidateMode(e[t])}finally{t++}return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",n),"]")},n.serializeCandidateType=function(){var e,t;switch(e=arguments[0],t=null,e){case fm.icelink.candidateType.Private:t="private";break;case fm.icelink.candidateType.Public:t="public";break;case fm.icelink.candidateType.Relay:t="relay"}return fm.serializer.serializeString(t)},n.serializeCandidateTypeArray=function(){var e,t,n;for(e=arguments[0],n=new Array(e.length),t=0;t<e.length;)try{n[t]=fm.icelink.serializer.serializeCandidateType(e[t])}finally{t++}return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",n),"]")},n.serializeCloseArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeCloseArgsCallback)},n.serializeCloseArgsCallback=function(){var e,t;return e=arguments[0],t=arguments[1],fm.global.equals(e.getReason(),null)?void 0:t.reason=fm.serializer.serializeString(e.getReason())},n.serializeCloseCompleteArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeCloseCompleteArgsCallback)},n.serializeCloseCompleteArgsCallback=function(){var e,t;return e=arguments[0],t=arguments[1],fm.global.equals(e.getReason(),null)||(t.reason=fm.serializer.serializeString(e.getReason())),fm.global.equals(e.getException(),null)?void 0:t.exceptionMessage=fm.serializer.serializeString(e.getException().message)},n.serializeCreateArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeCreateArgsCallback)},n.serializeCreateArgsCallback=function(){var e,t;return e=arguments[0],t=arguments[1]},n.serializeCreateCompleteArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeCreateCompleteArgsCallback)},n.serializeCreateCompleteArgsCallback=function(){var e,t;return e=arguments[0],t=arguments[1]},n.serializeCreateFailureArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeCreateFailureArgsCallback)},n.serializeCreateFailureArgsCallback=function(){var e,t;return e=arguments[0],t=arguments[1],fm.global.equals(e.getException(),null)?void 0:t.exceptionMessage=fm.serializer.serializeString(e.getException().message)},n.serializeCreateSuccessArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeCreateSuccessArgsCallback)},n.serializeCreateSuccessArgsCallback=function(){var e,t;return e=arguments[0],t=arguments[1],fm.global.equals(e.getOfferAnswer(),null)?void 0:t.offerAnswer=fm.icelink.offerAnswer.toJson(e.getOfferAnswer())},n.serializeEncryptionMode=function(){var e,t;switch(e=arguments[0],t=null,e){case fm.icelink.encryptionMode.Null:t="null";break;case fm.icelink.encryptionMode.Default:t="aes128Strong";break;case fm.icelink.encryptionMode.Aes128Weak:t="aes128Weak";break;case fm.icelink.encryptionMode.NullStrong:t="nullStrong";break;case fm.icelink.encryptionMode.NullWeak:t="nullWeak"}return fm.serializer.serializeString(t)},n.serializeEncryptionModeArray=function(){var e,t,n;for(e=arguments[0],n=new Array(e.length),t=0;t<e.length;)try{n[t]=fm.icelink.serializer.serializeEncryptionMode(e[t])}finally{t++}return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",n),"]")},n.serializeEncryptionRole=function(){var e,t;switch(e=arguments[0],t=null,e){case fm.icelink.encryptionRole.Active:t="active";break;case fm.icelink.encryptionRole.Passive:t="passive";break;case fm.icelink.encryptionRole.Default:t="actpass"}return fm.serializer.serializeString(t)},n.serializeEncryptionRoleArray=function(){var e,t,n;for(e=arguments[0],n=new Array(e.length),t=0;t<e.length;)try{n[t]=fm.icelink.serializer.serializeEncryptionRole(e[t])}finally{t++}return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",n),"]")},n.serializeLinkCandidateArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeLinkCandidateArgsCallback)},n.serializeLinkCandidateArgsCallback=function(){var e,t;return t=arguments[0],e=arguments[1],fm.global.equals(t.getCandidate(),null)?void 0:e.candidate=fm.icelink.candidate.toJson(t.getCandidate())},n.serializeLinkDownArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeLinkDownArgsCallback)},n.serializeLinkDownArgsCallback=function(){var e,t;return t=arguments[0],e=arguments[1],fm.global.equals(t.getException(),null)||(e.exceptionMessage=fm.serializer.serializeString(t.getException().message)),e.timedOut=fm.serializer.serializeBoolean(t.getTimedOut()),e.isSwitchingRoles=fm.serializer.serializeBoolean(t.getIsSwitchingRoles()),e.deadStreamDetected=fm.serializer.serializeBoolean(t.getDeadStreamDetected()),e.relayFailureDetected=fm.serializer.serializeBoolean(t.getRelayFailureDetected()),e.newOfferReceived=fm.serializer.serializeBoolean(t.getNewOfferReceived())},n.serializeLinkInitArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeLinkInitArgsCallback)},n.serializeLinkInitArgsCallback=function(){var e,t;return t=arguments[0],e=arguments[1],e.initiator=fm.serializer.serializeBoolean(t.getInitiator())},n.serializeLinkOfferAnswerArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeLinkOfferAnswerArgsCallback)},n.serializeLinkOfferAnswerArgsCallback=function(){var e,t;return t=arguments[0],e=arguments[1],fm.global.equals(t.getOfferAnswer(),null)?void 0:e.offerAnswer=fm.icelink.offerAnswer.toJson(t.getOfferAnswer())},n.serializeLinkUpArgs=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeLinkUpArgsCallback)},n.serializeLinkUpArgsCallback=function(){var e,t;return t=arguments[0],e=arguments[1]},n.serializeOfferAnswer=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeOfferAnswerCallback)},n.serializeOfferAnswerCallback=function(){var e,t;return t=arguments[0],e=arguments[1],fm.global.equals(t.getSdpMessage(),null)||(e.sdpMessage=fm.serializer.serializeString(t.getSdpMessage())),fm.global.equals(t.getTieBreaker(),null)||(e.tieBreaker=fm.serializer.serializeString(t.getTieBreaker())),e.isOffer=fm.serializer.serializeBoolean(t.getIsOffer())},n.serializeProtocol=function(){var e,t;switch(e=arguments[0],t=null,e){case fm.icelink.streamProtocol.Rtp:t="rtp";break;case fm.icelink.streamProtocol.Sctp:t="sctp"}return fm.serializer.serializeString(t)},n.serializeRtpMode=function(){var e,t;switch(e=arguments[0],t=null,e){case fm.icelink.rtpMode.Basic:t="basic";break;case fm.icelink.rtpMode.Extended:t="extended"}return fm.serializer.serializeString(t)},n.serializeStream=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeStreamCallback)},n.serializeStreamArray=function(){var e;return e=arguments[0],fm.serializer.serializeObjectArrayFast(e,n.serializeStreamCallback)},n.serializeStreamCallback=function(){var e,t;return t=arguments[0],e=arguments[1],e.type=fm.icelink.serializer.serializeStreamType(t.getType()),e.protocol=fm.icelink.serializer.serializeProtocol(t.getProtocol()),e.rtpMode=fm.icelink.serializer.serializeRtpMode(t.getRtpMode()),e.offerDtls=fm.serializer.serializeBoolean(t.getOfferDtls()),e.multiplexRtpRtcp=fm.serializer.serializeBoolean(t.getMultiplexRtpRtcp()),fm.global.equals(t.getEncryptionModes(),null)||(e.encryptionModes=fm.icelink.serializer.serializeEncryptionModeArray(t.getEncryptionModes())),fm.global.equals(t.getFormats(),null)||(e.formats=fm.icelink.serializer.serializeStreamFormatArray(t.getFormats())),e.maxQueuedPackets=fm.serializer.serializeInteger(t.getMaxQueuedPackets()),e.encryptionRole=fm.icelink.serializer.serializeEncryptionRole(t.getEncryptionRole())},n.serializeStreamFormat=function(){var e;return e=arguments[0],fm.serializer.serializeObject(e,n.serializeStreamFormatCallback)},n.serializeStreamFormatArray=function(){var e;return e=arguments[0],fm.serializer.serializeObjectArrayFast(e,n.serializeStreamFormatCallback)},n.serializeStreamFormatCallback=function(){var e,t;return t=arguments[0],e=arguments[1],e.payloadType=fm.serializer.serializeInteger(t.getPayloadType()),fm.global.equals(t.getEncodingName(),null)||(e.encodingName=fm.serializer.serializeString(t.getEncodingName())),e.clockRate=fm.serializer.serializeInteger(t.getClockRate()),fm.global.equals(t.getEncodingParameters(),null)?void 0:e.encodingParameters=fm.serializer.serializeString(t.getEncodingParameters())},n.serializeStreamType=function(){var e,t;switch(t=arguments[0],e=null,t){case fm.icelink.streamType.Audio:e="audio";break;case fm.icelink.streamType.Video:e="video";break;case fm.icelink.streamType.Text:e="text";break;case fm.icelink.streamType.Application:e="application";break;case fm.icelink.streamType.Message:e="message"}return fm.serializer.serializeString(e)},n.serializeStreamTypeArray=function(){var e,t,n;for(n=arguments[0],t=new Array(n.length),e=0;e<n.length;)try{t[e]=fm.icelink.serializer.serializeStreamType(n[e])}finally{e++}return fm.stringExtensions.concat("[",fm.stringExtensions.join(",",t),"]")},n}(fm.object);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.createArgs=function(n){function s(){this.toJson=e(this.toJson,this),this.setOnSuccess=e(this.setOnSuccess,this),this.setOnFailure=e(this.setOnFailure,this),this.setOnComplete=e(this.setOnComplete,this),this.getOnSuccess=e(this.getOnSuccess,this),this.getOnFailure=e(this.getOnFailure,this),this.getOnComplete=e(this.getOnComplete,this);var t;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(t=s.__super__.constructor.call(this),fm.util.attachProperties(this,arguments[0]),t):t=s.__super__.constructor.call(this)}return t(s,n),s.prototype._onComplete=null,s.prototype._onFailure=null,s.prototype._onSuccess=null,s.fromJson=function(){var e;return e=arguments[0],fm.icelink.serializer.deserializeCreateArgs(e)},s.toJson=function(){var e;return e=arguments[0],fm.icelink.serializer.serializeCreateArgs(e)},s.prototype.getOnComplete=function(){return this._onComplete},s.prototype.getOnFailure=function(){return this._onFailure},s.prototype.getOnSuccess=function(){return this._onSuccess},s.prototype.setOnComplete=function(){var e;return e=arguments[0],this._onComplete=e},s.prototype.setOnFailure=function(){var e;return e=arguments[0],this._onFailure=e},s.prototype.setOnSuccess=function(){var e;return e=arguments[0],this._onSuccess=e},s.prototype.toJson=function(){return fm.icelink.createArgs.toJson(this)},s}(fm.dynamic);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.googleDataPacket=function(n){function s(){return this.getString=e(this.getString,this),this.setPayload=e(this.setPayload,this),this.getPayload=e(this.getPayload,this),this.setEndOfPartition=e(this.setEndOfPartition,this),this.getEndOfPartition=e(this.getEndOfPartition,this),this.setStartOfPartition=e(this.setStartOfPartition,this),this.getStartOfPartition=e(this.getStartOfPartition,this),s.__super__.constructor.apply(this,arguments)}return t(s,n),s.prototype._startOfPartition=!1,s.prototype._endOfPartition=!1,s.prototype._payload=null,s._maxPacketSize=1050,s.prototype.getStartOfPartition=function(){return this._startOfPartition},s.prototype.setStartOfPartition=function(e){return this._startOfPartition=e},s.prototype.getEndOfPartition=function(){return this._endOfPartition},s.prototype.setEndOfPartition=function(e){return this._endOfPartition=e},s.prototype.getPayload=function(){return this._payload},s.prototype.setPayload=function(e){return this._payload=e},s.parseString=function(e){var t,n,s;return e.length<1?null:(n=0,s=new fm.icelink.googleDataPacket,t=e.substr(n++,1),"#"===t?(s.setStartOfPartition(!0),s.setEndOfPartition(!0)):"!"===t?s.setStartOfPartition(!0):'"'===t&&s.setEndOfPartition(!0),s.setPayload(e.substr(n)),s)},s.prototype.getString=function(){return fm.icelink.googleDataPacket.getString(this)},s.getString=function(e){var t,n,s;return n="",s=e.getStartOfPartition(),t=e.getEndOfPartition(),n+=s&&t?"#":s?"!":t?'"':" ",n+=e.getPayload()},s.packetize=function(e){var t,n,r,i,o,a,u,l,c,h,p;for(o=0,r=s._maxPacketSize-1,u=Math.ceil(e.length/r),0===u&&(u=1),c=new Array(u),i=Math.floor(e.length/u),p=e.length-u*i,t=n=0,h=u-1;h>=0?h>=n:n>=h;t=h>=0?++n:--n)l=i,p>t&&l++,a=new fm.icelink.googleDataPacket,a.setStartOfPartition(0===t),a.setEndOfPartition(t===u-1),a.setPayload(e.substr(o,l)),c[t]=a,o+=l;return c},s.depacketize=function(e){var t,n,s,r;for(r="",t=0,n=e.length;n>t;t++)s=e[t],r+=s.getPayload();return r},s}(fm.object);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.googleDataAccumulator=function(n){function s(){this.reset=e(this.reset,this),this.add=e(this.add,this),this.getPackets=e(this.getPackets,this),s.__super__.constructor.call(this),this._packets=[]}return t(s,n),s.prototype._packets=null,s.prototype.getPackets=function(){return this._packets.slice()},s.prototype.add=function(e){return e.getStartOfPartition()||this._packets.length>0?this._packets.push(e):void 0},s.prototype.reset=function(){return this._packets=[]},s}(fm.object);var t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.rtpPacket=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(fm.object);var t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.rtcpPacket=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(fm.object);var t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.certificate=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(fm.object);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;fm.icelink.stream=function(n){function s(t,n,r,i){this.isEquivalent=e(this.isEquivalent,this),this.getLocalStream=e(this.getLocalStream,this),s.__super__.constructor.call(this,t,i),this._localStream=n,this.setOfferDtls(r?!0:!1)}return t(s,n),s.prototype._localStream=null,s.prototype.getLocalStream=function(){return this._localStream},s.prototype.isEquivalent=function(e){return e.getType()===this.getType()},s}(fm.icelink.baseStream);var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;return fm.icelink.link=function(n){function s(){this.closeInternal=e(this.closeInternal,this),this.sendReliableBytes=e(this.sendReliableBytes,this),this.sendReliableString=e(this.sendReliableString,this),this.sendData=e(this.sendData,this),this.addRemoteCandidateInternal=e(this.addRemoteCandidateInternal,this),this.selectRtcp=e(this.selectRtcp,this),this.selectEncodings=e(this.selectEncodings,this),this.selectCodecs=e(this.selectCodecs,this),this.startOrtcTrack=e(this.startOrtcTrack,this),this.startOrtc=e(this.startOrtc,this),this.acceptInternal=e(this.acceptInternal,this),this.createInternal=e(this.createInternal,this),this.paramsFromSdp=e(this.paramsFromSdp,this),this.paramsToSdp=e(this.paramsToSdp,this),this._attachSctpChannelEvents=e(this._attachSctpChannelEvents,this),this._attachRtpChannelEvents=e(this._attachRtpChannelEvents,this),this._createIceGatherer=e(this._createIceGatherer,this),this._initializeTrack=e(this._initializeTrack,this),this._createConnection=e(this._createConnection,this),this.initializeInternal=e(this.initializeInternal,this),this.setRemoteStreamInternal=e(this.setRemoteStreamInternal,this),this.getRemoteStreamInternal=e(this.getRemoteStreamInternal,this),this.setLocalStreamInternal=e(this.setLocalStreamInternal,this),this.getLocalStreamInternal=e(this.getLocalStreamInternal,this),this.getConnectionInternal=e(this.getConnectionInternal,this),s.__super__.constructor.call(this),this._rtpDataChannels={},this._sctpDataChannels={},this._discoveredCandidates=[]}var r;return t(s,n),s.prototype._connection=null,s.prototype._iceGatherers=null,s.prototype._iceTransports=null,s.prototype._dtlsTransports=null,s.prototype._rtpSenders=null,s.prototype._rtpReceivers=null,s.prototype._rtpKinds=null,s.prototype._localParams=null,s.prototype._remoteParams=null,s.prototype._offerer=!1,s.prototype._remoteCandidatesTimer=null,s.prototype._remoteCandidatesDone=!1,s.prototype._localStream=null,s.prototype._remoteStream=null,s.prototype._discoveredCandidates=null,s.prototype._offerDtls=!1,s.prototype._rtpDataChannels=null,s.prototype._sctpDataChannels=null,s.prototype._useReliableDataChannels=!1,s.prototype._useUnreliableDataChannels=!1,s.prototype.getConnectionInternal=function(){return this._connection},s.prototype.getLocalStreamInternal=function(){return this._localStream},s.prototype.setLocalStreamInternal=function(e){return this._localStream=e},s.prototype.getRemoteStreamInternal=function(){return this._remoteStream},s.prototype.setRemoteStreamInternal=function(e){return this._remoteStream=e},s.prototype.initializeInternal=function(e){var t,n,s,r,i,o,a,u,l,c,h,p,g,m,f;for(l=!1,f=!1,c=this.getStreams(),n=0,i=c.length;i>n;n++){if(g=c[n],m=g.getType(),m===fm.icelink.streamType.Audio||m===fm.icelink.streamType.Video){if(u=g.getLocalStream(),!u)throw new Error("Stream definition is missing local stream.");if(this._localStream){if(this._localStream!==u)throw new Error("Stream definitions do not point to the same local stream.")}else this._localStream=u}else if(f=!0,g.getProtocol()===fm.icelink.streamProtocol.Sctp)for(this._useReliableDataChannels=!0,h=g.getChannelInfos(),s=0,o=h.length;o>s;s++)t=h[s],this._sctpDataChannels[t.getLabel()]={info:t};else for(this._useUnreliableDataChannels=!0,p=g.getChannelInfos(),r=0,a=p.length;a>r;r++)t=p[r],this._rtpDataChannels[t.getLabel()]={info:t,accumulator:new fm.icelink.googleDataAccumulator};g.getOfferDtls()&&(l=!0)}if(this._offerDtls=l,this._useReliableDataChannels&&this._useUnreliableDataChannels)throw new Error("Reliable and unreliable channels cannot be used in the same connection. Use either only reliable channels or only unreliable channels.");return e?e(this):void 0},s.prototype._createConnection=function(){var e,t,n,s,r,i,o,a,u,l,c,h,p,g,m,f,d,y,_,b,v,C,w,R,S,O,A,P,x,k,E,T,q,z,I,D,U,F,L,M,B,J,j,V,N,H,K,W;for(h=[],J=-1,L=this.getRelayUsernames(),U=this.getRelayPasswords(),q=this.getServerAddresses(),p=0,d=q.length;d>p;p++)for(T=q[p],J++,j=[],fm.stringExtensions.endsWith(T,"?transport=udp")?j.push(T):fm.stringExtensions.endsWith(T,"?transport=tcp")?j.push(T):(j.push(T+"?transport=udp"),j.push(T+"?transport=tcp")),g=0,y=j.length;y>g;g++)B=j[g],fm.log.info("Using "+B+" for STUN/TURN."),h.push({urls:["stun:"+B]}),F=null===L?null:J<L.length?L[J]:L[L.length-1],D=null===U?null:J<U.length?U[J]:U[U.length-1],null!==F&&null!==D&&""!==F&&""!==D&&(navigator.mozGetUserMedia?h.push({urls:["turn:"+B],credential:D,username:F}):navigator.webkitGetUserMedia?(r=parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2]),28>r?h.push({url:"turn:"+F+"@"+B,credential:D}):h.push({urls:["turn:"+B],credential:D,username:F})):h.push({urls:["turn:"+B],credential:D,username:F}));if(this._remoteStream=new fm.icelink.webrtc.mediaStream,fm.icelink.util.hasWebRTC()){x=[],this._useReliableDataChannels||this._offerDtls&&(fm.log.debug("Offering DTLS-SRTP key agreement."),x.push({DtlsSrtpKeyAgreement:!0})),this._useUnreliableDataChannels&&(fm.log.debug("Including rtp data channels in offer."),x.push({RtpDataChannels:!0}));try{this._connection=new RTCPeerConnection({iceServers:h},{optional:x})}catch(u){a=u;try{for(m=0,_=h.length;_>m;m++)c=h[m],c.urls&&(c.urls=c.urls[0]);this._connection=new RTCPeerConnection({iceServers:h},{optional:x})}catch(l){for(a=l,S=0,b=h.length;b>S;S++)c=h[S],c.urls&&(c.url=c.urls,delete c.urls);this._connection=new RTCPeerConnection({iceServers:h},{optional:x})}}if(this._connection.onicecandidate=function(e){return function(t){var n;return t.candidate?(n=new fm.icelink.candidate,n.setSdpMediaIndex(t.candidate.sdpMLineIndex),n.setSdpCandidateAttribute(t.candidate.candidate),e.getCandidateMode()===fm.icelink.candidateMode.Early?e._discoveredCandidates.push(n):e.raiseCandidate(n)):void 0}}(this),this._useUnreliableDataChannels&&this._rtpDataChannels)if(this.getControlling()){z=this._rtpDataChannels;for(f in z)i=z[f],s=i.info,n=this._connection.createDataChannel(f,{reliable:!1}),this._attachRtpChannelEvents(n),i.channel=n}else this._connection.ondatachannel=function(e){return function(t){return n=t.channel,i=e._rtpDataChannels[n.label],i?(e._attachRtpChannelEvents(n),i.channel=n):void 0}}(this);if(this._useReliableDataChannels&&this._sctpDataChannels)if(this.getControlling()){I=this._sctpDataChannels;for(f in I)i=I[f],s=i.info,f=s.getLabel(),k=!s.getUnordered(),V=s.getSubprotocol(),o={reliable:!0,ordered:k,negotiated:!1},n=this._connection.createDataChannel(f,o),this._attachSctpChannelEvents(n),i.channel=n}else this._connection.ondatachannel=function(e){return function(t){return n=t.channel,i=e._sctpDataChannels[n.label],i?(e._attachSctpChannelEvents(n),i.channel=n):void 0}}(this);return this._deadStreamTimeout=null,this._streamsReady=this._localStream?!1:!0,this._channelsReady=this._useUnreliableDataChannels||this._useReliableDataChannels?!1:!0,this._connection.oniceconnectionstatechange=function(e){return function(t){var n,s;return("connected"===e._connection.iceConnectionState||"completed"===e._connection.iceConnectionState)&&(e._deadStreamTimeout&&(fm.log.debug("Connectivity checks have restored."),window.clearTimeout(e._deadStreamTimeout),e._deadStreamTimeout=null),n=(new Date).getTime()+1e3,(s=function(){return e._streamsReady&&e._channelsReady?e.raiseUp():(new Date).getTime()>n?e.raiseUp():window.setTimeout(s,1)})()),"disconnected"===e._connection.iceConnectionState&&e.getHasOpened()&&(fm.log.debug("Some connectivity checks have failed. Monitoring for dead stream."),!e._deadStreamTimeout)?e._deadStreamTimeout=window.setTimeout(function(){var t,n;e._deadStreamTimeout=null;try{e._connection.close()}catch(t){a=t}return n="Dead stream detected.",e.raiseDown(new Error("Link closed. ("+n+")"),n,!1,!1,!0,!1,!1)},15e3):void 0}}(this),this._localStream&&(this._connection.onaddstream=function(e){return function(t){return e._streamsReady?void 0:(e._remoteStream.setBackingStream(t.stream),e._streamsReady=!0)}}(this),this._connection.onremovestream=function(e){return function(t){var n,s;try{e._connection.close()}catch(n){a=n}return s="Stream removed.",e.raiseDown(new Error("Link closed. ("+s+")"),s,!1,!1,!1,!1,!1)}}(this),R=this._localStream.getBackingStream(),R&&this._connection.addStream(R)),this._connectionReady=!0}if(fm.icelink.util.hasORTC()){if(this._useUnreliableDataChannels||this._useReliableDataChannels)throw new Error("ORTC does not currently support data channels.");if(M=new MediaStream,this._localStream){for(H=[],O=0,t=this._localStream.getBackingStream().getAudioTracks(),W=this._localStream.getBackingStream().getVideoTracks(),A=0,v=t.length;v>A;A++)e=t[A],H.push({track:e,kind:"audio",mediaIndex:O++});for(P=0,C=W.length;C>P;P++)K=W[P],H.push({track:K,kind:"video",mediaIndex:O++});for(this._iceGatherers=[],this._iceTransports=[],this._dtlsTransports=[],this._rtpSenders=[],this._rtpReceivers=[],this._rtpKinds=[],this._localParams=null,this._remoteParams=null,E=0,w=H.length;w>E;E++)N=H[E],M.addTrack(this._initializeTrack(N,h));this._remoteStream.setBackingStream(M)}return this._connectionReady=!0}throw new Error("Native browser support for WebRTC/ORTC could not be found.")},s.prototype._initializeTrack=function(e,t){var n,s,r,i,o;return s=this._createIceGatherer(t),this._iceGatherers.push(s),s.onlocalcandidate=function(t){return function(n){var s,r,i,o,a;return r=n.candidate,o=[r.foundation,1,r.protocol,r.priority,r.ip,r.port,"typ",r.type],r.relatedAddress&&(o=o.concat(["raddr",r.relatedAddress,"rport",r.relatedPort])),a=e.mediaIndex,i="a=candidate:"+o.join(" "),s=new fm.icelink.candidate,s.setSdpMediaIndex(a),s.setSdpCandidateAttribute(i),t.getCandidateMode()===fm.icelink.candidateMode.Early?t._discoveredCandidates.push(s):t.raiseCandidate(s)}}(this),r=new RTCIceTransport,this._iceTransports.push(r),n=new RTCDtlsTransport(r),this._dtlsTransports.push(n),"ended"!==e.track.readyState?(o=new RTCRtpSender(e.track,n),this._rtpSenders.push(o)):this._rtpSenders.push(null),i=new RTCRtpReceiver(n,e.kind),this._rtpReceivers.push(i),this._rtpKinds.push(e.kind),i.track},s.prototype._createIceGatherer=function(e){var t,n,s,r,i,o,a,u,l,c,h;e=e.slice(0);try{for(u=0,c=e.length;c>u;u++)a=e[u],fm.util.isArray(a.urls)&&(a.urls=a.urls[0]);o=new RTCIceGatherer({gatherPolicy:"all",iceServers:e})}catch(n){t=n;try{for(i=e.length;i--;)e[i].urls.startsWith("stun:")&&e.splice(i,1);o=new RTCIceGatherer({gatherPolicy:"all",iceServers:e})}catch(s){t=s;try{for(l=0,h=e.length;h>l;l++)a=e[l],""===a.username&&(a.username="unspecified"),""===a.credential&&(a.credential="unspecified");o=new RTCIceGatherer({gatherPolicy:"all",iceServers:e})}catch(r){throw t=r,fm.log.error("Could not create ORTC IceGatherer.",t),t}}}return o},s.prototype._attachRtpChannelEvents=function(e){return e.onopen=function(e){return function(t){return e._channelsReady?void 0:e._channelsReady=!0}}(this),e.onclose=function(e){return function(t){var n,s,r;if(!e._localStream){try{e._connection.close()}catch(s){n=s}return r="Channel closed.",e.raiseDown(new Error("Link closed. ("+r+")"),r,!1,!1,!1,!1,!1)}}}(this),e.onmessage=function(t){return function(n){var s,r,i,o;return i=t._rtpDataChannels[e.label],i&&(o=fm.icelink.googleDataPacket.parseString(n.data),o&&(s=i.accumulator,s.add(o),o.getEndOfPartition()))?(r=fm.icelink.googleDataPacket.depacketize(s.getPackets()),s.reset(),i.info.raiseOnReceive(t,r)):void 0}}(this)},s.prototype._attachSctpChannelEvents=function(e){return e.onopen=function(t){return function(n){return e.binaryType="arraybuffer",t._channelsReady?void 0:t._channelsReady=!0}}(this),e.onerror=function(e){return function(t){return e.raiseDown(new Error("Data channel error:"+t,t,!1,!1,!1,!1,!1))}}(this),e.onclose=function(e){return function(t){var n,s,r;if(!e._localStream){try{e._connection.close()}catch(s){n=s}return r="Channel closed.",e.raiseDown(new Error("Link closed. ("+r+")"),r,!1,!1,!1,!1,!1)}}}(this),e.onmessage=function(t){return function(n){var s;return s=t._sctpDataChannels[e.label],s?"string"==typeof n.data?s.info.raiseOnReceiveString(t,n.data):s.info.raiseOnReceiveBytes(t,n.data):void 0}}(this)},r=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},s.prototype.paramsToSdp=function(e){var t,n,s,r,i,o,a,u,l,c,h,p,g,m,f,d,y;for(f=[],f.push("v=0"),f.push("o="+["-",e.sessionId,e.sessionVersion,"IN IP4 127.0.0.1"].join(" ")),f.push("s=IceLink ORTC"),f.push("t=0 0"),p=e.medias,i=0,u=p.length;u>i;i++){for(h=p[i],s=h.dtls.fingerprints[0],"auto"===h.dtls.role?d="actpass":"client"===h.dtls.role?d="active":"server"===h.dtls.role&&(d="passive"),n=[],g=h.codecs,o=0,l=g.length;l>o;o++)t=g[o],n.push(t.preferredPayloadType);for(y=9,f.push("m="+[h.kind,y,"RTP/SAVPF",n.join(" ")].join(" ")),f.push("c=IN IP4 0.0.0.0"),f.push("a=rtcp:"+[y,"IN IP4 0.0.0.0"].join(" ")),f.push("a=ice-ufrag:"+h.ice.usernameFragment),f.push("a=ice-pwd:"+h.ice.password),f.push("a=fingerprint:"+[s.algorithm,s.value].join(" ")),f.push("a=setup:"+d),f.push("a=sendrecv"),f.push("a=rtcp-mux"),m=h.codecs,a=0,c=m.length;c>a;a++)t=m[a],r=t.numChannels>1?[t.name,t.clockRate,t.numChannels].join("/"):[t.name,t.clockRate].join("/"),f.push("a=rtpmap:"+[t.preferredPayloadType,r].join(" "));f.push("a="+["ssrc:"+h.ssrc,"cname:"+h.cname].join(" "))}return f.join("\n")+"\n"},s.prototype.paramsFromSdp=function(e){var t,n,s,r,i,o,a,u,l,c,h,p,g,m,f,d,y;for(y=e.split("\n"),g={sessionId:null,sessionVersion:null,medias:[]},p=null,a=null,o=null,n=null,s=null,u=0,c=y.length;c>u;u++)if(h=y[u],h=h.trim(),""!==h)if(h.startsWith("o="))f=h.substr("o=".length).split(" "),g.sessionId=f[1],g.sessionVersion=1*f[2];else if(h.startsWith("m="))f=h.substr("m=".length).split(" "),p={kind:f[0],ice:{},dtls:{fingerprints:[{}]},codecs:[],ssrc:null,cname:null},g.medias.push(p),a&&(p.ice.usernameFragment=a),o&&(p.ice.password=o),n&&(p.dtls.fingerprints[0].algorithm=n),s&&(p.dtls.fingerprints[0].value=s);else if(h.startsWith("a=ice-ufrag:"))f=h.substr("a=ice-ufrag:".length).split(" "),p?p.ice.usernameFragment=f[0]:a=f[0];else if(h.startsWith("a=ice-pwd:"))f=h.substr("a=ice-pwd:".length).split(" "),
p?p.ice.password=f[0]:o=f[0];else if(h.startsWith("a=fingerprint:"))f=h.substr("a=fingerprint:".length).split(" "),p?(p.dtls.fingerprints[0].algorithm=f[0],p.dtls.fingerprints[0].value=f[1]):(n=f[0],s=f[1]);else if(h.startsWith("a=setup:"))f=h.substr("a=setup:".length).split(" "),"actpass"===f[0]?p.dtls.role="auto":"active"===f[0]?p.dtls.role="client":"passive"===f[0]&&(p.dtls.role="server");else if(h.startsWith("a=rtpmap:"))f=h.substr("a=rtpmap:".length).split(" "),r=f[1].split("/"),t={preferredPayloadType:1*f[0],name:r[0],clockRate:1*r[1],numChannels:r.length>2?1*r[2]:1},p.codecs.push(t);else if(h.startsWith("a=ssrc:")&&(f=h.substr("a=ssrc:".length).split(" "),p.ssrc=1*f[0],f.length>1))for(i=l=1,d=f.length-1;d>=1?d>=l:l>=d;i=d>=1?++l:--l)m=f[i],m.startsWith("cname:")&&(p.cname=m.split(":")[1]);return g},s.prototype.createInternal=function(e,t,n){var s,r,i,o,a,u,l,c,h,p,g,m,f,d,y,_,b,v,C,w,R,S,O,A,P,x,k,E,T,q,z,I,D,U,F,L,M;if(M=this.getControlling()?"answer":"offer",this._connectionReady||(this._createConnection(),this.raiseInit(this.getControlling())),S=function(e){return function(e){return e&&e.hasOwnProperty("message")&&(e=e.message),e||(e="Could not create "+M+"."),n(new Error(e))}}(this),O=function(e){return function(e){var n;return n=new fm.icelink.offerAnswer,n.setSdpMessage(e),t(n),n.getSdpMessage()}}(this),fm.icelink.util.hasWebRTC()){for(R=function(e){return function(t){var n;return n=function(){var n;return n=function(){var n,s,r;r=O(t.sdp);try{if(t.sdp!==r)return t.sdp=r,e._connection.setLocalDescription(t,function(){return fm.log.debug("Local session description updated.")},function(e){return fm.log.error("Local session description could not be updated.",new Error(e))})}catch(s){n=s}},e.getCandidateMode()===fm.icelink.candidateMode.Early?window.setTimeout(function(){var s,r,i,o,a,u,l,c,h,p,g,m,f,d,y,_,b,v,C,w,R,S,O,A,P,x,k,E,T,q,z,I,D,U,F;for(D=t.sdp,U=D.split("\nm="),F=U[0].trim(),_=[],z=[],E=[],a=l=1,R=U.length;R>=1?R>l:l>R;a=R>=1?++l:--l)_.push("m="+U[a].trim()),z.push([]),E.push([]);for(S=e._discoveredCandidates,c=0,p=S.length;p>c;c++)s=S[c],y=s.getSdpMediaIndex(),r=s.getSdpCandidateAttribute(),i=r.split(" "),o=i[1],_[y]+="\n"+r,"1"===o?z[y].push(r):"2"===o&&E[y].push(r);for(a=h=0,O=_.length;O>=0?O>h:h>O;a=O>=0?++h:--h)if(!e.getStreams()[a].getMultiplexRtpRtcp()&&(I=z[a],T=E[a],0===T.length))for(d=0,g=I.length;g>d;d++)q=I[d],k=q.replace(/candidate:([^ ]+) 1/,"candidate:$1 2"),_[a]+="\n"+k,T.push(k);for(a=b=0,A=_.length;A>=0?A>b:b>A;a=A>=0?++b:--b){for(I=z[a],T=E[a],0===T.length&&(T=I),P=I.slice(0).reverse(),v=0,m=P.length;m>v;v++)if(q=P[v],i=q.split(" "),u=i[4],w=i[5],w>0){_[a]=_[a].replace(/m=(audio|video) [0-9]+/,"m=$1 "+w),_[a]=_[a].replace(/c=IN IP(4|6) [0-9.:]+/,"c=IN IP$1 "+u);break}for(x=T.slice(0).reverse(),C=0,f=x.length;f>C;C++)if(k=x[C],i=k.split(" "),u=i[4],w=i[5],w>0){_[a]=_[a].replace(/a=rtcp:[0-9]+ IN IP(4|6) [0-9.:]+/,"a=rtcp:"+w+" IN IP$1 "+u);break}}return D=F+"\n"+_.join("\n")+"\n",t.sdp=D,n()},e.getEarlyCandidatesTimeout()):n()},e._connection.setLocalDescription(t,n,S)}}(this),o={offerToReceiveAudio:!1,offerToReceiveVideo:!1},x=this.getStreams(),h=0,m=x.length;m>h;h++)F=x[h],L=F.getType(),L===fm.icelink.streamType.Audio&&(o.offerToReceiveAudio=!0),L===fm.icelink.streamType.Video&&(o.offerToReceiveVideo=!0);try{return this.getControlling()?this._connection.createOffer(R,S,o):this._connection.createAnswer(R,S)}catch(l){return u=l,o={optional:[],mandatory:{OfferToReceiveAudio:o.offerToReceiveAudio,OfferToReceiveVideo:o.offerToReceiveVideo}},this.getControlling()?this._connection.createOffer(R,S,o):this._connection.createAnswer(R,S)}}else if(fm.icelink.util.hasORTC()){for(this._localParams={sessionId:Math.floor(0x8000000000000000*Math.random()).toString(),sessionVersion:Math.floor(2147483647*Math.random()),medias:[]},s=fm.guid.newGuid().toString().replace("-","").substr(0,8),c=p=0,k=this._iceGatherers.length-1;k>=0?k>=p:p>=k;c=k>=0?++p:--p){for(v={kind:this._rtpKinds[c],ice:this._iceGatherers[c].getLocalParameters(),dtls:this._dtlsTransports[c].getLocalParameters(),codecs:[],ssrc:Math.floor(4294967296*Math.random()),cname:s},U=RTCRtpSender.getCapabilities(this._rtpKinds[c]),A=RTCRtpReceiver.getCapabilities(this._rtpKinds[c]),P={},E=A.codecs,g=0,f=E.length;f>g;g++)r=E[g],a=[r.name,r.clockRate,r.numChannels].join("/").toLowerCase(),P[a]=r;for(T=U.codecs,b=0,d=T.length;d>b;b++)r=T[b],a=[r.name,r.clockRate,r.numChannels].join("/").toLowerCase(),P[a]&&v.codecs.push(r);if(v.codecs.sort(function(e){return function(e,t){return e.clockRate===t.clockRate?t.numChannels-e.numChannels:t.clockRate-e.clockRate}}(this)),this._remoteParams){for(D=this._remoteParams.medias[c],"auto"===D.dtls.role||"server"===D.dtls.role?v.dtls.role="client":v.dtls.role="server",i=[],q=D.codecs,C=0,y=q.length;y>C;C++)for(I=q[C],z=v.codecs,w=0,_=z.length;_>w;w++)if(r=z[w],r.name.toLowerCase()===I.name.toLowerCase()&&r.clockRate===I.clockRate&&r.numChannels===I.numChannels){r.name=I.name,r.preferredPayloadType=I.preferredPayloadType,i.push(r);break}v.codecs=i}this._localParams.medias.push(v)}return this._remoteParams&&this.startOrtc(),O(this.paramsToSdp(this._localParams))}},s.prototype.acceptInternal=function(e,t,n){var s,r,i;return i=this.getControlling()?"answer":"offer",this._connectionReady||(this._createConnection(),this.raiseInit(this.getControlling())),s=function(e){return function(e){return e&&e.hasOwnProperty("message")&&(e=e.message),e||(e="Could not accept "+i+"."),n(new Error(e))}}(this),r=function(e){return function(){return t()}}(this),fm.icelink.util.hasWebRTC()?this._connection.setRemoteDescription(new RTCSessionDescription({type:i,sdp:e.getOfferAnswer().getSdpMessage()}),r,s):fm.icelink.util.hasORTC()?(this._remoteParams=this.paramsFromSdp(e.getOfferAnswer().getSdpMessage()),this._localParams&&this.startOrtc(),t()):void 0},s.prototype._dtlsTransportsRemaining=0,s.prototype.startOrtc=function(e){var t,n,s,r,i,o,a,u;for(this._dtlsTransportsRemaining=this._iceGatherers.length,t=n=0,i=this._iceGatherers.length-1;i>=0?i>=n:n>=i;t=i>=0?++n:--n)this.startOrtcTrack(this._iceGatherers[t],this._iceTransports[t],this._dtlsTransports[t],this._localParams.medias[t],this._remoteParams.medias[t]);for(t=s=0,o=this._rtpReceivers.length-1;o>=0?o>=s:s>=o;t=o>=0?++s:--s)this._rtpReceivers[t].receive({muxId:"",codecs:this.selectCodecs(t,!1),headerExtensions:[],encodings:this.selectEncodings(t,!1),rtcp:this.selectRtcp(t,!1)});for(u=[],t=r=0,a=this._rtpSenders.length-1;a>=0?a>=r:r>=a;t=a>=0?++r:--r)this._rtpSenders[t]?u.push(this._rtpSenders[t].send({muxId:"",codecs:this.selectCodecs(t,!0),headerExtensions:[],encodings:this.selectEncodings(t,!0),rtcp:this.selectRtcp(t,!0)})):u.push(void 0);return u},s.prototype.startOrtcTrack=function(e,t,n,s,r){var i;return i="controlling",("client"===s.dtls.role||"server"===r.dtls.role)&&(i="controlled"),e.onerror=function(e){return function(e){return fm.log.error("ORTC ICE gatherer error.",e)}}(this),t.onerror=function(e){return function(e){return fm.log.error("ORTC ICE transport error.",error)}}(this),n.onerror=function(e){return function(e){return fm.log.error("ORTC DTLS transport error.",error)}}(this),t.onicestatechange=function(e){return function(e){return fm.log.debug("ORTC ICE transport state has changed to "+t.state)}}(this),n.ondtlsstatechange=function(e){return function(t){return fm.log.debug("ORTC DTLS transport state has changed to "+n.state),"connected"===n.state&&(e._dtlsTransportsRemaining--,0===e._dtlsTransportsRemaining)?e.raiseUp():void 0}}(this),t.start(e,r.ice,i),n.start(r.dtls)},s.prototype.selectCodecs=function(e,t){var n,s,r,i,o,a,u,l,c,h,p;for(a=this._localParams.medias[e],h=this._remoteParams.medias[e],p=[],u=a.codecs,s=0,i=u.length;i>s;s++)for(n=u[s],l=h.codecs,r=0,o=l.length;o>r;r++)if(c=l[r],n.name.toLowerCase()===c.name.toLowerCase()&&n.clockRate===c.clockRate&&n.numChannels===c.numChannels&&n.preferredPayloadType===c.preferredPayloadType){p.push({name:n.name,payloadType:n.preferredPayloadType,clockRate:n.clockRate,numChannels:n.numChannels,rtcpFeedback:n.rtcpFeedback,parameters:n.parameters});break}return p},s.prototype.selectEncodings=function(e,t){var n,s;return n=this._localParams.medias[e],s=this._remoteParams.medias[e],[{ssrc:t?n.ssrc:s.ssrc,codecPayloadType:0,fec:0,rtx:0,priority:1,maxBitrate:2e6,minQuality:0,framerateBias:.5,resolutionScale:1,framerateScale:1,active:!0}]},s.prototype.selectRtcp=function(e,t){var n,s;return n=this._localParams.medias[e],s=this._remoteParams.medias[e],{ssrc:t?n.ssrc:s.ssrc,cname:t?n.cname:s.ssrc,reducedSize:!1,mux:!0}},s.prototype.addRemoteCandidateInternal=function(e){var t,n,s,r,i,o;if(n=function(e){return function(e){return e&&e.hasOwnProperty("message")&&(e=e.message),e||(e="Could not add remote candidate."),fm.log.error(e)}}(this),s=function(e){return function(){return!0}}(this),fm.icelink.util.hasWebRTC())return this._connection.addIceCandidate(new RTCIceCandidate({sdpMLineIndex:e.getSdpMediaIndex(),candidate:e.getSdpCandidateAttribute()}),s,n);if(fm.icelink.util.hasORTC()){if(this._remoteCandidatesDone)return;if(o=e.getSdpMediaIndex(),r=e.getSdpCandidateAttribute(),i=r.slice(r.indexOf("candidate:")+"candidate:".length).replace(/ +/g," ").split(" "),t={foundation:i[0],protocol:i[2],priority:parseInt(i[3]),ip:i[4],port:parseInt(i[5]),type:i[7],relatedAddress:null,relatedPort:0,tcpType:"active"},"host"!==t.type&&(t.relatedAddress=i[9],t.relatedPort=parseInt(i[11])),this._iceTransports[o].addRemoteCandidate(t),!this._remoteCandidatesTimer)return this._remoteCandidatesTimer=setTimeout(function(e){return function(){return e._iceTransports[o].addRemoteCandidate({}),e._remoteCandidatesDone=!0}}(this),this.getEarlyCandidatesTimeout())}},s.prototype.sendData=function(e,t){var n,s,r,i,o,a,u;if(s=this._rtpDataChannels[e.getLabel()],!s)throw new Error("Data channel not found.");if(n=s.channel){for(a=fm.icelink.googleDataPacket.packetize(t),u=[],r=0,i=a.length;i>r;r++)o=a[r],u.push(n.send(o.getString()));return u}},s.prototype.sendReliableString=function(e,t){var n,s;if(s=this._sctpDataChannels[e.getLabel()],!s)throw new Error("Data channel not found.");return n=s.channel,n?n.send(t):void 0},s.prototype.sendReliableBytes=function(e,t){var n,s,r,i;if(s=this._sctpDataChannels[e.getLabel()],!s)throw new Error("Data channel not found.");if(n=s.channel)try{return n.send(t)}catch(i){return r=i,console.log("ERROR:\nType: "+r.type+"\nArgs: "+r.arguments+"\nMessage: "+r.message),console.log("\nSTACKTRACE:\n",r.stack)}},s.prototype.closeInternal=function(e,t){var n,s,r,i,o,a,u,l,c,h,p,g,m,f,d,y,_,b;if(fm.icelink.util.hasWebRTC()){u=null;try{this._connection.close()}catch(s){n=s,u=n}return f=e.getReason(),m="Link closed.",f&&(m+=" ("+f+")"),this.raiseDown(new Error(m),f,!1,!1,!1,!1,!1),t(e,u)}if(fm.icelink.util.hasORTC()){if(u=null,this._rtpSenders)for(l=c=0,d=this._rtpSenders.length-1;d>=0?d>=c:c>=d;l=d>=0?++c:--c)try{this._rtpSenders[l]&&this._rtpSenders[l].stop()}catch(r){n=r,u=n}if(this._rtpReceivers)for(l=h=0,y=this._rtpReceivers.length-1;y>=0?y>=h:h>=y;l=y>=0?++h:--h)try{this._rtpReceivers[l].stop()}catch(i){n=i,u=n}for(l=p=0,_=this._iceTransports.length-1;_>=0?_>=p:p>=_;l=_>=0?++p:--p)try{this._iceTransports[l].stop()}catch(o){n=o,u=n}if(this._dtlsTransports)for(l=g=0,b=this._dtlsTransports.length-1;b>=0?b>=g:g>=b;l=b>=0?++g:--g)try{this._dtlsTransports[l].stop()}catch(a){n=a,u=n}return this._iceGatherers=null,this._iceTransports=null,this._dtlsTransports=null,this._rtpSenders=null,this._rtpReceivers=null,this._rtpKinds=null,this._localParams=null,this._remoteParams=null,this._offerer=!1,this._remoteCandidatesTimer=null,this._remoteCandidatesDone=!1,f=e.getReason(),m="Link closed.",f&&(m+=" ("+f+")"),this.raiseDown(new Error(m),f,!1,!1,!1,!1,!1),t(e,u)}return t(null)},s}(fm.icelink.baseLink),function(){var e,t,n,s,r,i,o,a,u,l,c;for(window.RTCPeerConnection=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection,window.RTCDataChannel=window.RTCDataChannel||window.webkitRTCDataChannel||window.mozRTCDataChannel||window.msRTCDataChannel,window.RTCSessionDescription=window.RTCSessionDescription||window.webkitRTCSessionDescription||window.mozRTCSessionDescription||window.msRTCPeerConnection,window.RTCIceCandidate=window.RTCIceCandidate||window.webkitRTCIceCandidate||window.mozRTCIceCandidate||window.msRTCIceCandidate,r=fm.icelink.link,e=fm.icelink.conference,c=["createOffer","createAnswer","accept","close"],t=function(e){var t;return t=r.prototype[e],r.prototype[e]=function(){var n;return 1===arguments.length&&fm.util.isPlainObject(arguments[0])?(n=arguments[0],t.call(this,new fm.icelink[e+"Args"](n))):t.apply(this,arguments)}},n=0,s=c.length;s>n;n++)i=c[n],t(i);a=e.prototype.constructor,u=e.prototype,o=e,fm.icelink.conference=function(){return arguments&&(1!==arguments.length||fm.util.isArray(arguments[0])||(arguments[0]=[arguments[0]]),2!==arguments.length||fm.util.isArray(arguments[0])||(arguments[0]=[arguments[0]]),2!==arguments.length||fm.util.isArray(arguments[1])||(arguments[1]=[arguments[1]]),3!==arguments.length||fm.util.isArray(arguments[2])||(arguments[2]=[arguments[2]])),a.apply(this,arguments),this},fm.icelink.conference.prototype=u;for(l in o)fm.icelink.conference[l]=o[l];return fm.icelink.createOfferArgs=fm.icelink.createArgs,fm.icelink.createAnswerArgs=fm.icelink.createArgs}(),fm.icelink});